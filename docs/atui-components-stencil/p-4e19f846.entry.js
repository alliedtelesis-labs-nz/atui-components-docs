import{r as t,c as e,h as i,H as s,g as a}from"./p-Cd7WF2gX.js";import{f as n}from"./p-DuLooPsr.js";import{c as r}from"./p-CVoOBWGd.js";const o=r("min-h-36 placeholder-text-light relative flex min-h-[36px] w-full flex-shrink flex-grow basis-0 gap-4 rounded-md border border-solid py-4 pl-8 pr-24 outline-none transition-colors duration-300 ease-in-out focus-within:outline-0 focus-within:ring-2",{variants:{disabled:{false:"bg-white focus-within:ring-active-foreground/30",true:"pointer-events-none border-none bg-surface-1 !text-disabled"},readonly:{false:"focus-within:ring-active-foreground/30",true:"cursor-text border-none !bg-surface-1 !text-dark"},invalid:{false:"border-med focus-within:border-active-dark focus-within:ring-active-foreground/30",true:"border-error-base focus-within:border-error-base focus-within:ring-destructive-foreground/30"},typeahead:{false:"cursor-pointer caret-transparent",true:null}},defaultVariants:{disabled:false,readonly:false,invalid:false,typeahead:false}});const h=r("transition[background-color,color] h-24 flex-shrink flex-grow basis-0 rounded-md p-8 outline-0 duration-300 ease-in-out",{variants:{typeahead:{true:"focus:bg-surface-1",false:"cursor-pointer bg-transparent caret-transparent"},disabled:{true:"pointer-events-none bg-transparent",false:"bg-surface-base"}},defaultVariants:{disabled:false,typeahead:false}});const l=r("transition[background-color,color,box-shadow] flex w-full cursor-pointer items-center truncate p-8 text-body font-normal duration-300 ease-in-out focus:outline-0 focus:ring-2 focus:ring-inset focus:ring-active-foreground/40",{variants:{active:{true:"bg-active-light text-active",false:"bg-white hover:bg-disabled-light"}}});const c=class{constructor(i){t(this,i);this.atuiChange=e(this,"atuiChange",7);this.label="";this.hint_text="";this.error_text="";this.info_text="";this.placeholder="";this.value=[];this.searchText="";this.isOpen=false;this.hasMatchingOptions=false;this.parentWidth="";this.menuId=`dropdown-${Math.random().toString(36).substring(2,11)}`;this.optionEls=[]}async componentWillLoad(){this.translations=await n(this.el)}componentDidLoad(){this.el.querySelectorAll('li[data-name="select-option"]').forEach((t=>{this.optionEls.push(t)}));const t=this.el.getBoundingClientRect();this.parentWidth=`${t.width}px`}updateIsOpenState(t){this.isOpen=t.detail}handleChange(t){this.value=this.value.includes(t)?this.value.filter((e=>e!==t)):[...this.value,t];this.inputEl.value="";this.searchText="";this.atuiChange.emit(this.value)}handleClear(){this.searchText="";this.value=[];this.inputEl.value="";this.inputEl.focus();this.atuiChange.emit(this.value)}focusOption(t){const e=this.optionEls.indexOf(this.el.ownerDocument.activeElement);const i=this.optionEls[(e+t+this.optionEls.length)%this.optionEls.length];i.focus()}handleSearchChange(t){var e;this.searchText=t.target.value.toLowerCase();const i=this.searchText.trim().toLowerCase();this.hasMatchingOptions=i?(e=this.options)===null||e===void 0?void 0:e.some((t=>t.value.toLowerCase().includes(i))):false}async handleKeyDownInput(t){switch(t.key){case"Enter":case"Space":await this.menuRef.toggleMenu();break;case"Escape":await this.menuRef.closeMenu();break;default:this.handleSearchChange(t);await this.menuRef.openMenu();break}}async handleKeyDownMenu(t){switch(t.key){case"Escape":await this.menuRef.closeMenu;break;case"Enter":case" ":if(t.target instanceof HTMLLIElement){t.target.click()}break;case"ArrowUp":case"ArrowLeft":t.preventDefault();this.focusOption(-1);break;case"ArrowDown":case"ArrowRight":t.preventDefault();this.focusOption(1);break}}render(){return i(s,{key:"0c4532cb6b8da829e7543ac729ae9ebac6eb7b84",class:"relative",onFocusout:async t=>{var e;if(!this.el.contains(t.relatedTarget)){await((e=this.menuRef)===null||e===void 0?void 0:e.closeMenu())}}},this.renderLabel(),i("atui-menu",{key:"9b1f2a9fce7873361ecaf5f86758f6ec71f143ea",ref:t=>this.menuRef=t,trigger:"click",align:"start",role:"listbox",width:this.parentWidth,autoclose:false,disabled:this.disabled||this.readonly,onAtuiMenuStateChange:t=>this.updateIsOpenState(t)},this.renderInput(),!this.disabled||!this.readonly?this.renderOptions():null),i("div",{key:"fd97c87c22c58fb5197c018527544f876278b2b6"},this.error_text&&this.invalid&&i("span",{key:"e672b18d4406533119b18ea3a25f58b777b2ee3f","data-name":"multi-select-error",class:"text-error"},this.error_text),this.chip_list&&i("atui-chip-list",{key:"75114137fb37ca27f2db8737be523b6f00b6efe8",onAtuiRemoveChip:t=>this.value=this.value.filter((e=>!t.detail.includes(e))),chips:this.value,"data-name":"multi-select-chips-outside"})))}renderLabel(){return i("div",{class:"mb-4 flex flex-col"},i("slot",{name:"label"}),(this.label||this.required||this.info_text)&&i("atui-form-label",{for:this.menuId,label:this.label,required:this.required&&!this.readonly,info_text:this.info_text}),this.hint_text&&i("span",{class:"text-xs leading-tight text-med","data-name":"multi-select-hint"},this.hint_text))}renderInput(){const t=o({invalid:this.invalid,disabled:this.disabled,readonly:this.readonly,typeahead:this.typeahead});const e=h({typeahead:this.typeahead});return i("div",{class:t,tabIndex:-1,slot:"menu-trigger"},i("atui-chip-list",{size:"sm",class:"w-full",readonly:this.readonly,disabled:this.disabled,show_clear_all:false,onAtuiRemoveChip:t=>{if(!this.disabled&&!this.readonly&&this.typeahead){this.inputEl.focus()}this.value=this.value.filter((e=>!t.detail.includes(e)))},chips:this.chip_list?[]:this.value,tabIndex:-1,"data-name":"multi-select-chips-inside"},this.typeahead&&i("input",{id:`input-${this.menuId}`,role:"combobox","aria-autocomplete":this.typeahead?"list":undefined,"aria-haspopup":!this.chip_list?true:undefined,"aria-controls":this.menuId,class:e,type:"text",readOnly:this.readonly,placeholder:this.placeholder,onKeyDown:async t=>{await this.handleKeyDownInput(t)},"data-name":"multi-select-search-input",ref:t=>this.inputEl=t})),!this.readonly&&!this.disabled&&i("div",{class:"absolute right-4 flex items-center"},this.clearable&&i("atui-button",{class:`transition-all duration-300 ease-in-out ${!!this.value.length||this.searchText?"scale-100 opacity-100":"pointer-events-none scale-90 opacity-0"}`,size:"sm",icon:"cancel",type:"secondaryText",onClick:t=>{t.stopPropagation();this.handleClear()},"data-name":"multi-select-clear"}),i("atui-button",{size:"sm",class:"!i>text-light h-[18pz] w-[18px]",icon:this.isOpen?"arrow_drop_up":"arrow_drop_down",type:"secondaryText",onClick:async()=>{await this.menuRef.toggleMenu}})))}renderOptions(){var t;return i("ul",{id:this.menuId,role:"listbox",class:"contents",slot:"menu-content",onKeyDown:async t=>{await this.handleKeyDownMenu(t)}},(t=this.options)===null||t===void 0?void 0:t.filter((t=>t.value.toLowerCase().includes(this.searchText))).map((t=>this.renderOption(t))),this.typeahead&&!this.hasMatchingOptions&&i("div",{class:"w-full bg-white px-16 py-8 text-body text-light"},this.translations.ATUI.NO_RESULTS_FOUND))}renderOption(t){const e=l({active:this.value.includes(t.value)});return i("li",{role:"option","data-name":"multi-select-option","aria-selected":this.value.includes(t.value),tabIndex:0,class:e,onClick:()=>this.handleChange(t.value)},i("i",{role:"presentation",class:`material-icons h-16 w-16 text-sm ease-in-out ${this.value.includes(t.value)?"visible":"hidden"}`},"check"),t.value)}get el(){return a(this)}};export{c as atui_multi_select};
//# sourceMappingURL=p-4e19f846.entry.js.map