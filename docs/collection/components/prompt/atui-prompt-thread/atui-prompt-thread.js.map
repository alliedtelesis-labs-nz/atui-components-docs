{"version":3,"file":"atui-prompt-thread.js","sourceRoot":"","sources":["../../../../src/components/prompt/atui-prompt-thread/atui-prompt-thread.tsx"],"names":[],"mappings":"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","sourcesContent":["import {\n    Component,\n    Host,\n    h,\n    Prop,\n    Event,\n    EventEmitter,\n    Listen,\n} from '@stencil/core';\nimport { PromptMessage } from '../../../types/prompt';\n\n/**\n * @category Prompt\n * @description A message thread component for displaying user and chatbot messages in a conversation format. Supports auto-scrolling, empty states, loading indicators, and message interaction events.\n */\n@Component({\n    tag: 'atui-prompt-thread',\n    shadow: false,\n})\nexport class AtuiPromptThread {\n    /**\n     * Array of messages to display in the conversation thread\n     */\n    @Prop() messages: PromptMessage[] = [];\n\n    /**\n     * Shows a loading indicator for incoming messages\n     */\n    @Prop() loading: boolean = false;\n\n    /**\n     * Title text displayed when no messages are present\n     */\n    @Prop() empty_state_title: string = 'No messages yet';\n\n    /**\n     * Description text displayed when no messages are present\n     */\n    @Prop() empty_state_description: string =\n        'Start a conversation by sending a message';\n\n    /**\n     * Automatically scroll to the bottom when new messages are added\n     */\n    @Prop() auto_scroll: boolean = true;\n\n    /**\n     * Display name for chatbot/assistant messages\n     */\n    @Prop() chatbot_title: string = 'Assistant';\n\n    /**\n     * Emitted when a message copy action is requested\n     */\n    @Event() atuiMessageCopy: EventEmitter<{\n        messageId: string;\n        content: string;\n    }>;\n\n    /**\n     * Emitted when a message retry action is requested\n     */\n    @Event() atuiMessageRetry: EventEmitter<{ messageId: string }>;\n\n    /**\n     * Emitted when a message edit action is requested\n     */\n    @Event() atuiMessageEdit: EventEmitter<{\n        messageId: string;\n        content: string;\n    }>;\n\n    /**\n     * @slot messages - Custom message content (alternative to using the messages prop)\n     */\n\n    private threadContainer: HTMLElement;\n\n    componentDidUpdate() {\n        if (this.auto_scroll && this.threadContainer) {\n            this.scrollToBottom();\n        }\n    }\n\n    private scrollToBottom(): void {\n        if (this.threadContainer) {\n            this.threadContainer.scrollTop = this.threadContainer.scrollHeight;\n        }\n    }\n\n    @Listen('atuiCopy')\n    handleMessageCopy(event: CustomEvent<string>) {\n        const messageIndex = this.getMessageIndexFromEvent(event);\n        if (messageIndex !== -1) {\n            this.atuiMessageCopy.emit({\n                messageId: `msg-${messageIndex}`,\n                content: event.detail,\n            });\n        }\n    }\n\n    @Listen('atuiRetry')\n    handleMessageRetry(event: CustomEvent<void>) {\n        const messageIndex = this.getMessageIndexFromEvent(event);\n        if (messageIndex !== -1) {\n            this.atuiMessageRetry.emit({\n                messageId: `msg-${messageIndex}`,\n            });\n        }\n    }\n\n    @Listen('atuiEdit')\n    handleMessageEdit(event: CustomEvent<string>) {\n        const messageIndex = this.getMessageIndexFromEvent(event);\n        if (messageIndex !== -1) {\n            this.atuiMessageEdit.emit({\n                messageId: `msg-${messageIndex}`,\n                content: event.detail,\n            });\n        }\n    }\n\n    private getMessageIndexFromEvent(event: CustomEvent): number {\n        const target = event.target as HTMLElement;\n        const messageContainer = target.closest(\n            '[data-message-index]',\n        ) as HTMLElement;\n        return messageContainer\n            ? parseInt(messageContainer.dataset.messageIndex || '-1', 10)\n            : -1;\n    }\n\n    private renderLoadingIndicator() {\n        if (!this.loading) return null;\n\n        return (\n            <div\n                class=\"flex flex-col gap-16\"\n                data-name=\"loading-container\"\n            >\n                <atui-prompt-message\n                    role=\"assistant\"\n                    content=\"Typing...\"\n                    name={this.chatbot_title}\n                    loading={true}\n                    data-name=\"loading-message\"\n                />\n            </div>\n        );\n    }\n\n    private renderEmptyState() {\n        return (\n            <div\n                class=\"flex h-full flex-col items-center justify-center p-8 text-center\"\n                data-name=\"empty-state\"\n            >\n                <div class=\"text-muted-foreground text-4xl mb-4\">ðŸ’¬</div>\n                <h3\n                    class=\"text-lg mb-2 font-semibold\"\n                    data-name=\"empty-state-title\"\n                >\n                    {this.empty_state_title}\n                </h3>\n                <p\n                    class=\"text-muted-foreground text-sm\"\n                    data-name=\"empty-state-description\"\n                >\n                    {this.empty_state_description}\n                </p>\n            </div>\n        );\n    }\n\n    private renderMessage(message: PromptMessage, index: number) {\n        const role = message.role === 'system' ? 'assistant' : message.role;\n        const name =\n            message.role === 'user'\n                ? message.name\n                : message.name || this.chatbot_title;\n\n        return (\n            <div data-message-index={index}>\n                <atui-prompt-message\n                    role={role}\n                    content={message.content}\n                    name={name}\n                    avatar={message.avatar}\n                    loading={message.loading}\n                    error={message.error}\n                    error_message={message.error_message}\n                    data-name={`message-${index}`}\n                />\n            </div>\n        );\n    }\n\n    private renderMessages() {\n        return this.messages.map((message, index) => (\n            <div\n                key={index}\n                class=\"flex flex-col gap-16 p-16 pb-0\"\n                data-name=\"message-container\"\n            >\n                {this.renderMessage(message, index)}\n            </div>\n        ));\n    }\n\n    render() {\n        const hasMessages = this.messages && this.messages.length > 0;\n\n        return (\n            <Host\n                class=\"block h-full overflow-y-auto scroll-smooth pb-32\"\n                ref={(el) => (this.threadContainer = el)}\n                data-name=\"thread-container\"\n            >\n                {!hasMessages ? (\n                    this.renderEmptyState()\n                ) : (\n                    <div data-name=\"messages-container\">\n                        {this.renderMessages()}\n                        {this.renderLoadingIndicator()}\n                    </div>\n                )}\n                <slot name=\"messages\" />\n            </Host>\n        );\n    }\n}\n"]}