{"version":3,"file":"atui-prompt-message.entry.js","sources":["src/components/prompt/atui-prompt-message/atui-prompt-message.tsx"],"sourcesContent":["import {\n    Component,\n    Host,\n    h,\n    Prop,\n    Event,\n    EventEmitter,\n    Fragment,\n    State,\n    Element,\n} from '@stencil/core';\nimport { cva } from 'class-variance-authority';\nimport { MessageRole } from '../../../types/prompt';\nimport { fetchTranslations } from '../../../utils/translation';\n\nconst messageVariants = cva('text-base max-w-4xl rounded-lg px-8 py-4', {\n    variants: {\n        role: {\n            user: 'ml-auto bg-surface-2 text-dark',\n            assistant: 'mr-auto text-dark',\n        },\n        loading: {\n            true: 'animate-pulse',\n            false: '',\n        },\n    },\n    defaultVariants: {\n        role: 'user',\n        loading: false,\n    },\n});\n\n/**\n * @category Prompt\n * @description A message component for displaying individual chat messages with different roles (user, assistant). Supports optional avatars, loading states, error states, and interactive actions like copy, edit, and retry.\n */\n@Component({\n    tag: 'atui-prompt-message',\n    shadow: false,\n})\nexport class AtuiPromptMessage {\n    /**\n     * The role/type of the message sender (only 'user' and 'assistant' are supported)\n     */\n    @Prop() role: Exclude<MessageRole, 'system'> = 'user';\n\n    /**\n     * The message content text\n     */\n    @Prop() content: string = '';\n\n    /**\n     * URL for a custom avatar image\n     */\n    @Prop() avatar: string;\n\n    /**\n     * Display name for the message sender\n     */\n    @Prop() name: string;\n\n    /**\n     * Shows loading state with animated placeholder content\n     */\n    @Prop() loading: boolean = false;\n\n    /**\n     * Shows error state styling and enables retry action\n     */\n    @Prop() error: boolean = false;\n\n    /**\n     * Custom error message text (defaults to generic error message)\n     */\n    @Prop() error_message: string;\n\n    /**\n     * Emitted when the copy action is triggered\n     */\n    @Event() atuiCopy: EventEmitter<string>;\n\n    /**\n     * Emitted when positive feedback action is triggered\n     */\n    @Event() atuiPositiveFeedback: EventEmitter<void>;\n\n    /**\n     * Emitted when negative feedback action is triggered\n     */\n    @Event() atuiNegativeFeedback: EventEmitter<void>;\n\n    /**\n     * Emitted when the retry action is triggered (for assistant messages with errors)\n     */\n    @Event() atuiRetry: EventEmitter<void>;\n\n    /**\n     * Emitted when the edit action is triggered (for user messages)\n     */\n    @Event() atuiEdit: EventEmitter<string>;\n\n    /**\n     * @slot - Custom message content (alternative to using the content prop)\n     */\n    @State() translations: any;\n\n    errorEl: HTMLDivElement;\n    @Element() el: HTMLAtuiInputElement;\n\n    async componentWillLoad(): Promise<void> {\n        this.translations = await fetchTranslations(this.errorEl);\n    }\n\n    private handleCopy = () => {\n        this.atuiCopy.emit(this.content);\n    };\n\n    private handleRetry = () => {\n        this.atuiRetry.emit();\n    };\n\n    private handleEdit = () => {\n        this.atuiEdit.emit(this.content);\n    };\n\n    private handleFeedbackPositive = () => {\n        this.atuiPositiveFeedback.emit();\n    };\n\n    private handleFeedbackNegative = () => {\n        this.atuiNegativeFeedback.emit();\n    };\n\n    private renderAvatar() {\n        const variant = this.role === 'user' ? 'primary' : 'secondary';\n\n        const initials = this.name\n            ? this.name.charAt(0).toUpperCase()\n            : this.role === 'user'\n              ? 'U'\n              : 'A';\n\n        return (\n            <atui-avatar\n                src={this.avatar}\n                alt={this.name || this.role}\n                initials={initials}\n                variant={variant}\n                size=\"sm\"\n                data-name=\"message-avatar\"\n            />\n        );\n    }\n\n    private renderActions() {\n        if (this.loading) return null;\n\n        return (\n            <div\n                class=\"mt-2 flex items-center justify-end gap-2\"\n                data-name=\"message-actions\"\n            >\n                {this.role === 'user' && (\n                    <atui-tooltip position=\"top\">\n                        <atui-button\n                            slot=\"tooltip-trigger\"\n                            size=\"sm\"\n                            type=\"secondaryText\"\n                            icon=\"edit\"\n                            class=\"text-xs\"\n                            onClick={this.handleEdit}\n                            data-name=\"edit-button\"\n                        />\n                        <span slot=\"tooltip-content\">Edit</span>\n                    </atui-tooltip>\n                )}\n\n                {this.role === 'assistant' && (\n                    <Fragment>\n                        <atui-tooltip position=\"top\">\n                            <atui-button\n                                slot=\"tooltip-trigger\"\n                                size=\"sm\"\n                                type=\"secondaryText\"\n                                icon=\"thumb_up\"\n                                onClick={this.handleFeedbackPositive}\n                                data-name=\"feedback-positive-button\"\n                            />\n                            <span slot=\"tooltip-content\">Helpful</span>\n                        </atui-tooltip>\n                        <atui-tooltip position=\"top\">\n                            <atui-button\n                                slot=\"tooltip-trigger\"\n                                size=\"sm\"\n                                type=\"secondaryText\"\n                                icon=\"thumb_down\"\n                                onClick={this.handleFeedbackNegative}\n                                data-name=\"feedback-negative-button\"\n                            />\n                            <span slot=\"tooltip-content\">Not helpful</span>\n                        </atui-tooltip>\n\n                        <atui-tooltip position=\"top\">\n                            <atui-button\n                                slot=\"tooltip-trigger\"\n                                size=\"sm\"\n                                icon=\"content_copy\"\n                                type=\"secondaryText\"\n                                onClick={this.handleCopy}\n                                data-name=\"copy-button\"\n                            />\n                            <span slot=\"tooltip-content\">Copy</span>\n                        </atui-tooltip>\n                    </Fragment>\n                )}\n                {this.role === 'assistant' && this.error && (\n                    <atui-tooltip position=\"top\">\n                        <atui-button\n                            slot=\"tooltip-trigger\"\n                            size=\"sm\"\n                            type=\"secondaryText\"\n                            icon=\"refresh\"\n                            onClick={this.handleRetry}\n                            data-name=\"retry-button\"\n                        />\n                        <span slot=\"tooltip-content\">Retry</span>\n                    </atui-tooltip>\n                )}\n            </div>\n        );\n    }\n\n    private renderContent() {\n        if (this.loading) {\n            return (\n                <div\n                    class=\"py-8\"\n                    data-name=\"loading-content\"\n                >\n                    <atui-loading\n                        variant=\"typing\"\n                        size=\"sm\"\n                    />\n                </div>\n            );\n        }\n\n        if (this.error) {\n            return (\n                <div\n                    class=\"space-y-2\"\n                    ref={(el) => (this.errorEl = el)}\n                    data-name=\"error-content\"\n                >\n                    <p class=\"text-destructive\">\n                        {this.error_message ||\n                            this.translations.ATUI.PROMPT\n                                .ERROR_GENERATING_RESPONSE}\n                    </p>\n                </div>\n            );\n        }\n\n        return (\n            <div\n                class=\"prose prose-sm preserve-newlines max-w-none\"\n                data-name=\"message-content\"\n            >\n                <slot></slot>\n                {this.content}\n            </div>\n        );\n    }\n\n    render() {\n        const messageClasses = messageVariants({\n            role: this.role,\n            loading: this.loading,\n        });\n\n        return (\n            <Host\n                class=\"flex w-full gap-8\"\n                data-name=\"message-container\"\n            >\n                {this.avatar && this.renderAvatar()}\n\n                <div class=\"space-y-1 flex-1\">\n                    <div class=\"flex items-center gap-8\">\n                        {this.name && (\n                            <span\n                                class=\"text-sm text-light\"\n                                data-name=\"message-name\"\n                            >\n                                {this.name}\n                            </span>\n                        )}\n                    </div>\n\n                    <div class={messageClasses}>{this.renderContent()}</div>\n\n                    {this.renderActions()}\n                </div>\n            </Host>\n        );\n    }\n}\n"],"names":[],"mappings":"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"}