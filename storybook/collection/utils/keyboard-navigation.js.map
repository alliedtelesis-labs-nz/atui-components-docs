{"version":3,"file":"keyboard-navigation.js","sourceRoot":"","sources":["../../src/utils/keyboard-navigation.ts"],"names":[],"mappings":"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","sourcesContent":["export const FOCUSABLE_SELECTOR =\n    'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n\nexport interface KeyboardNavigationOptions {\n    container: HTMLElement;\n    onEscape?: () => void;\n    onEnter?: (target: HTMLElement) => void;\n    onSpace?: (target: HTMLElement) => void;\n    focusOnOpen?: boolean;\n}\n\nexport function getFocusableElements(container: HTMLElement): HTMLElement[] {\n    return Array.from(\n        container.querySelectorAll(FOCUSABLE_SELECTOR),\n    ) as HTMLElement[];\n}\n\nexport function focusElementAtIndex(\n    elements: HTMLElement[],\n    index: number,\n): void {\n    if (elements.length === 0) return;\n\n    const clampedIndex = Math.max(0, Math.min(index, elements.length - 1));\n    elements[clampedIndex].focus();\n}\n\nexport function getCurrentFocusIndex(elements: HTMLElement[]): number {\n    return elements.indexOf(document.activeElement as HTMLElement);\n}\n\nexport function handleArrowNavigation(\n    event: KeyboardEvent,\n    container: HTMLElement,\n): void {\n    if (\n        event.key !== 'ArrowDown' &&\n        event.key !== 'ArrowUp' &&\n        event.key !== 'ArrowLeft' &&\n        event.key !== 'ArrowRight'\n    ) {\n        return;\n    }\n\n    event.preventDefault();\n\n    const focusableElements = getFocusableElements(container);\n    if (focusableElements.length === 0) return;\n\n    const currentIndex = getCurrentFocusIndex(focusableElements);\n    let nextIndex = 0;\n\n    if (event.key === 'ArrowDown' || event.key === 'ArrowRight') {\n        nextIndex =\n            currentIndex < 0 || currentIndex >= focusableElements.length - 1\n                ? 0\n                : currentIndex + 1;\n    } else if (event.key === 'ArrowUp' || event.key === 'ArrowLeft') {\n        nextIndex =\n            currentIndex <= 0 ? focusableElements.length - 1 : currentIndex - 1;\n    }\n\n    focusElementAtIndex(focusableElements, nextIndex);\n}\n\nexport function handleHomeEndNavigation(\n    event: KeyboardEvent,\n    container: HTMLElement,\n): void {\n    if (event.key !== 'Home' && event.key !== 'End') {\n        return;\n    }\n\n    event.preventDefault();\n\n    const focusableElements = getFocusableElements(container);\n    if (focusableElements.length === 0) return;\n\n    if (event.key === 'Home') {\n        focusElementAtIndex(focusableElements, 0);\n    } else {\n        focusElementAtIndex(focusableElements, focusableElements.length - 1);\n    }\n}\n\nexport function handleTabFocusTrap(\n    event: KeyboardEvent,\n    container: HTMLElement,\n): void {\n    if (event.key !== 'Tab') {\n        return;\n    }\n\n    const focusableElements = getFocusableElements(container);\n    if (focusableElements.length === 0) return;\n\n    const firstElement = focusableElements[0];\n    const lastElement = focusableElements[focusableElements.length - 1];\n\n    event.preventDefault();\n\n    if (event.shiftKey) {\n        if (document.activeElement === firstElement) {\n            lastElement.focus();\n        } else {\n            const currentIndex = getCurrentFocusIndex(focusableElements);\n            const nextIndex =\n                currentIndex > 0\n                    ? currentIndex - 1\n                    : focusableElements.length - 1;\n            focusElementAtIndex(focusableElements, nextIndex);\n        }\n    } else {\n        if (document.activeElement === lastElement) {\n            firstElement.focus();\n        } else {\n            const currentIndex = getCurrentFocusIndex(focusableElements);\n            const nextIndex =\n                currentIndex < focusableElements.length - 1\n                    ? currentIndex + 1\n                    : 0;\n            focusElementAtIndex(focusableElements, nextIndex);\n        }\n    }\n}\n\nexport function createMenuKeydownHandler(options: KeyboardNavigationOptions) {\n    return (event: KeyboardEvent) => {\n        const { container, onEscape, onEnter, onSpace } = options;\n\n        if (event.key === 'Escape' && onEscape) {\n            event.preventDefault();\n            onEscape();\n            return;\n        }\n\n        if (event.key === 'Enter' && onEnter) {\n            event.preventDefault();\n            onEnter(event.target as HTMLElement);\n            return;\n        }\n\n        if (event.key === ' ' && onSpace) {\n            event.preventDefault();\n            onSpace(event.target as HTMLElement);\n            return;\n        }\n\n        if (event.key === 'Tab') {\n            handleTabFocusTrap(event, container);\n            return;\n        }\n\n        handleArrowNavigation(event, container);\n        handleHomeEndNavigation(event, container);\n    };\n}\n\nexport function focusFirstElement(\n    container: HTMLElement,\n    delay: number = 50,\n): void {\n    setTimeout(() => {\n        const focusableElements = getFocusableElements(container);\n        if (focusableElements.length > 0) {\n            focusableElements[0].focus();\n        }\n    }, delay);\n}\n"]}