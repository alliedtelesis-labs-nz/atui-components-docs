import{r as t,c as e,g as i,h as s,H as a}from"./p-EP34iaAr.js";import{a as n,T as o,D as r}from"./p-DK-HoBk1.js";import h from"moment";import{f as l}from"./p-DuLooPsr.js";import{M as c,T as u}from"./p-C3LwY5aR.js";var m;(function(t){t["SECONDS"]="s";t["MINUTES"]="min";t["HOURS"]="hr";t["DAYS"]="d";t["WEEKS"]="w";t["MONTHS"]="m";t["YEARS"]="yr"})(m||(m={}));var d;(function(t){t["SECONDS"]="SECONDS";t["MINUTES"]="MINUTES";t["HOURS"]="HOURS";t["DAYS"]="DAYS";t["WEEKS"]="WEEKS";t["MONTHS"]="MONTHS";t["YEARS"]="YEARS"})(d||(d={}));const f=class{constructor(i){t(this,i);this.atuiChange=e(this,"atuiChange",7)}selected_time_range={selected:{unit:n.HOURS,value:1}};range_limit=7;presets;enable_relative_time=true;custom_error_message=null;show_all_time=false;enable_range_limit=true;today;lowerLimit;defaultFromDate;translations;relativeTimeMenuEl;absoluteTimeMenuEl;get el(){return i(this)}units=[n.MINUTES,n.HOURS,n.DAYS,n.WEEKS,n.MONTHS,n.YEARS];minSeconds=300;async componentWillLoad(){this.translations=await l(this.el);this.today=new Date}componentWillRender(){this.lowerLimit=this.enable_range_limit?h().subtract(this.range_limit,"day").toDate():o.floorDateByTimeUnit(c,r.HOURS);this.defaultFromDate=h(this.today).subtract(1,"hours").toDate()}getLongUnitDisplay(t){if(t.custom||!t.selected){return}return d[t.selected["unit"]]}getRelativeDate(t){if(t.custom||!t.selected){return}return o.getRelativeDateRange(t.selected)}getCustomStartAndEndDate(t){if(!t.custom){return}const{from:e,to:i}=t.custom;const s=h(e).toDate();const a=h(i).toDate();return{fromDate:s,toDate:a}}getShortUnitDisplay(t){return m[t.unit]}atuiChange;onChangeCustomTime(t){this.selected_time_range={selected:u.CUSTOM,custom:t};this.atuiChange.emit({...this.selected_time_range})}onChangeRelativeTime(t){this.selected_time_range={selected:t};this.atuiChange.emit({...this.selected_time_range})}get buttonGroupOptions(){const t=[];if(this.selected_time_range.selected===u.ALL){t.push({value:s("div",{class:"text-dark flex items-center gap-4 font-normal"},s("span",{class:"font-medium"},this.translations.ATUI.TIME.ALL_TIME_LABEL))})}else if(this.selected_time_range.custom){t.push({value:[s("div",{class:"text-dark flex items-center gap-4 font-normal"},s("span",null,this.getCustomStartAndEndDate(this.selected_time_range)?.fromDate.toLocaleString()),s("span",{class:"icon-md material-icons text-light"},"arrow_forward"),s("span",null,this.selected_time_range.custom.lockEndDateToNow?"NOW":this.getCustomStartAndEndDate(this.selected_time_range)?.toDate.toLocaleString()))]})}else{t.push({value:s("div",{class:"text-dark flex items-center gap-4 font-normal"},s("span",{class:"font-medium"},this.translations.ATUI.TIME.LAST,` `,this.selected_time_range.selected["value"],` `,this.translations.ATUI.TIME[this.getLongUnitDisplay(this.selected_time_range)]," ",":"),s("span",null,this.getRelativeDate(this.selected_time_range).startDate.toLocaleString()),s("span",{class:"icon-md material-icons text-light"},"arrow_forward"),s("span",null,"NOW"))})}t.push({value:s("div",{class:"flex items-center"},s("span",{class:"icon-md material-icons text-light"},"date_range"))});return t}get predefinedTimeRanges(){const t=[];this.presets.forEach((e=>{t.push({value:s("span",null,e.value,this.getShortUnitDisplay(e))})}));t.push({value:s("div",{class:"flex items-center"},s("span",{class:"material-icons text-body text-light"},"date_range"))});return t}render(){return s(a,{key:"60366fcaca599804b630152d4acd43b010c696ad",class:"relative flex justify-center gap-8"},this.enable_relative_time&&s("at-button-group",{key:"aa8e37016433c11407b03e5be24f00b3ee209bc0",options:this.buttonGroupOptions,onAtuiIndexChange:t=>t.detail===0&&this.relativeTimeMenuEl.focus()||t.detail===1&&this.absoluteTimeMenuEl.focus()}),!this.enable_relative_time&&s("at-button-group",{key:"0bfca16b8bad51674bea913110d357ee7a250056",options:this.predefinedTimeRanges,onAtuiIndexChange:t=>{if(t.detail<this.presets.length){this.onChangeRelativeTime(this.presets[t.detail])}else if(t.detail===this.predefinedTimeRanges.length-1){this.absoluteTimeMenuEl.focus()}}}),s("div",{key:"0406c81b116c7027bf284659003cda50707d952b",ref:t=>this.relativeTimeMenuEl=t,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:t=>t.stopPropagation()},s("at-time-with-unit",{key:"717e7f3bdede477e7633db77ca5be5b6b1bf0c93",units:this.units,common_options:this.presets,min_date:this.lowerLimit,min_seconds:this.minSeconds,initial_selected_time:this.selected_time_range.selected===u.CUSTOM?u.ALL:this.selected_time_range.selected,custom_error_message:this.custom_error_message,show_all_time:this.show_all_time,onAtuiSubmit:t=>this.onChangeRelativeTime(t.detail),onAtuiCancel:()=>{this.relativeTimeMenuEl.focus();this.relativeTimeMenuEl.blur()}})),s("div",{key:"d5c1966930e9ce8f37059c238a924259bbea2723",ref:t=>this.absoluteTimeMenuEl=t,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:t=>t.stopPropagation()},s("at-custom-time-range",{key:"e2c3a58ebce59f4af43775f697b2a5336c45a5e2",min_date:this.lowerLimit,default_to_date:this.today,default_from_date:this.defaultFromDate,from_date_value:this.getCustomStartAndEndDate(this.selected_time_range)?.fromDate,to_date_value:this.getCustomStartAndEndDate(this.selected_time_range)?.toDate,lock_end_date_to_now:this.selected_time_range.custom?.lockEndDateToNow,onAtuiSubmit:t=>this.onChangeCustomTime(t.detail),onAtuiCancel:()=>{this.absoluteTimeMenuEl.focus();this.absoluteTimeMenuEl.blur()}})))}};export{f as at_time_range};
//# sourceMappingURL=p-33b8cfd8.entry.js.map