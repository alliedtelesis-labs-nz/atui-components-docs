import{r as t,c as s,h as i,F as e,H as o,g as a}from"./p-C8uvvL0O.js";import{c as n}from"./p-Bfa-pAao.js";import{f as l}from"./p-DuLooPsr.js";import{PromptResponseScore as h}from"./index.esm.js";const r="@keyframes atPromptFadeIn{from{opacity:0}to{opacity:1}}@keyframes atPromptTypingCursorBlink{0%,50%{opacity:1}51%,100%{opacity:0}}.at-prompt-fade-in{animation:atPromptFadeIn 0.6s ease-out}";const d={variants:{role:{user:"bg-surface-2 text-dark ml-auto inline-block p-8",assistant:"text-dark mr-auto",system:"text-dark mr-auto"},loading:{true:"animate-pulse",false:""}},defaultVariants:{role:"user",loading:false}};const p=n("rounded-lg py-4 text-base",d);const c=class{constructor(i){t(this,i);this.atCopy=s(this,"atCopy",7);this.atVote=s(this,"atVote",7);this.atRetry=s(this,"atRetry",7);this.atEdit=s(this,"atEdit",7);this.role="user";this.content="";this.loading=false;this.error=false;this.score=h.NONE;this.enable_vote=false;this.enable_copy=false;this.enable_edit=false;this.response_animation="words";this.copyFeedbackVisible=false;this.animatedContent="";this.isAnimating=false;this.handleCopy=async()=>{try{await navigator.clipboard.writeText(this.content);this.copyFeedbackVisible=true;this.atCopy.emit(this.content);setTimeout((()=>{this.copyFeedbackVisible=false}),2e3)}catch(t){console.error("Failed to copy text:",t)}};this.handleRetry=()=>{this.atRetry.emit()};this.handleEdit=()=>{this.atEdit.emit(this.content)};this.handleVote=t=>{const s=this.score===t?h.NONE:t;this.atVote.emit({messageId:this.message_id,score:s})}}async componentWillLoad(){this.translations=await l(this.el);this.initializeContent()}watchContentChange(t){if(t&&this.response_animation==="words"&&this.role==="assistant"){this.startWordAnimation(t)}else{this.animatedContent=t}}initializeContent(){if(this.content&&this.response_animation==="words"&&this.role==="assistant"){this.startWordAnimation(this.content)}else{this.animatedContent=this.content}}startWordAnimation(t){if(this.isAnimating)return;this.isAnimating=true;this.animatedContent="";const s=t.split(" ");let i=0;const e=()=>{if(i<s.length){if(i===0){this.animatedContent=s[i]}else{this.animatedContent+=" "+s[i]}i++;const t=Math.random()*30+30;setTimeout(e,t)}else{this.isAnimating=false}};setTimeout(e,30)}renderActions(){var t,s,o,a,n,l,r,d,p,c,v,u,m,f,g,x,w,y;if(this.loading)return null;return i("div",{class:"mt-2 flex items-center justify-end gap-2","data-name":"message-actions"},this.role==="user"&&this.enable_edit&&i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",icon:"edit",class:"text-xs",onClick:this.handleEdit,"data-name":"edit-button"}),i("span",null,((o=(s=(t=this.translations)===null||t===void 0?void 0:t.ATUI)===null||s===void 0?void 0:s.PROMPT)===null||o===void 0?void 0:o.EDIT)||"Edit")),this.role==="assistant"&&this.enable_vote&&i(e,null,i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",onClick:()=>this.handleVote(h.UP),"data-name":"vote-up-button"},this.score===h.UP?i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"0 -960 960 960",width:"15px",fill:"#000000"},i("path",{d:"M720-144H264v-480l288-288 32 22q18 13 26.5 33t3.5 41l-38 192h264q30 0 51 21t21 51v57q0 8-1.5 14.5T906-467L787-188q-9 20-27 32t-40 12Z"})):i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"0 -960 960 960",width:"15px",fill:"#adb5bd"},i("path",{d:"M720-144H264v-480l288-288 32 22q17 12 26 30.5t5 38.5l-1 5-38 192h264q30 0 51 21t21 51v57q0 8-1.5 14.5T906-467L786.93-187.8Q778-168 760-156t-40 12Zm-384-72h384l120-279v-57H488l49-243-201 201v378Zm0-378v378-378Z"}))),i("span",null,((l=(n=(a=this.translations)===null||a===void 0?void 0:a.ATUI)===null||n===void 0?void 0:n.PROMPT)===null||l===void 0?void 0:l.HELPFUL)||"Helpful")),i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",onClick:()=>this.handleVote(h.DOWN),"data-name":"vote-down-button"},this.score===h.DOWN?i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"0 -960 960 960",width:"15px",fill:"#000000"},i("path",{d:"M240-816h456v480L408-48l-32-22q-18-13-26.5-33t-3.5-41l38-192H120q-30 0-51-21t-21-51v-57q0-8 1.5-14.5T54-493l119-279q8-20 26.5-32t40.5-12Z"})):i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15px",viewBox:"0 -960 960 960",height:"15px",fill:"#adb5bd"},i("path",{d:"M240-816h456v480L408-48l-32-22q-17-12-26-30.5t-5-38.5l1-5 38-192H120q-30 0-51-21t-21-51v-57q0-8 1.5-14.5T54-493l119-279q8-20 26.5-32t40.5-12Zm384 72H240L120-465v57h352l-49 243 201-201v-378Zm0 378v-378 378Z"}))),i("span",null,((p=(d=(r=this.translations)===null||r===void 0?void 0:r.ATUI)===null||d===void 0?void 0:d.PROMPT)===null||p===void 0?void 0:p.NOT_HELPFUL)||"Not Helpful"))),this.role==="assistant"&&this.enable_copy&&i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",icon:this.copyFeedbackVisible?"check":"content_copy",type:"secondaryText",onClick:this.handleCopy,"data-name":"copy-button"}),i("span",null,this.copyFeedbackVisible?((u=(v=(c=this.translations)===null||c===void 0?void 0:c.ATUI)===null||v===void 0?void 0:v.PROMPT)===null||u===void 0?void 0:u.COPIED)||"Copied":((g=(f=(m=this.translations)===null||m===void 0?void 0:m.ATUI)===null||f===void 0?void 0:f.PROMPT)===null||g===void 0?void 0:g.COPY)||"Copy")),this.role==="assistant"&&this.error&&i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",icon:"refresh",onClick:this.handleRetry,"data-name":"retry-button"}),i("span",null,((y=(w=(x=this.translations)===null||x===void 0?void 0:x.ATUI)===null||w===void 0?void 0:w.PROMPT)===null||y===void 0?void 0:y.RETRY)||"Retry")))}renderContent(){var t,s,e;if(this.loading){return i("div",{class:"py-8","data-name":"loading-wrapper"},i("at-loading",{class:"flex items-center gap-4 py-8","data-name":"loading-content",variant:"typing",size:"sm"}))}if(this.error){return i("div",{class:"space-y-2",ref:t=>this.errorEl=t,"data-name":"error-content"},i("p",{class:"text-destructive-foreground"},this.error_message||((e=(s=(t=this.translations)===null||t===void 0?void 0:t.ATUI)===null||s===void 0?void 0:s.PROMPT)===null||e===void 0?void 0:e.ERROR_GENERATING_RESPONSE)||"Error generating response"))}const o=this.response_animation==="words"&&this.role==="assistant"?this.animatedContent:this.content;const a=this.response_animation==="fade"||this.response_animation==="words"?"at-prompt-fade-in":"";return i("div",{class:`prose prose-sm preserve-newlines max-w-none ${a}`,"data-name":"message-content"},i("slot",null),o)}render(){const t=p({role:this.role,loading:this.loading});return i(o,{key:"f10b50dd2216a2ecd4bc874792382e1abf76c3f1",class:"flex w-full gap-8","data-name":"message-container","data-role":this.role},i("div",{key:"b78881e993c7a7faf8709f19d807aa22dfd9358c",class:"flex flex-1 flex-col"},this.name&&i("span",{key:"0af12697ba009dcd7894632e7ffc75ad3c812f80",class:"text-light self-start text-sm","data-name":"message-name"},this.name),i("div",{key:"b74518e67c378734d531d291623ea1fe617755c3",class:t},this.renderContent()),this.renderActions()))}get el(){return a(this)}static get watchers(){return{content:["watchContentChange"]}}};c.style=r;export{c as at_prompt_message};
//# sourceMappingURL=p-e571fbbf.entry.js.map