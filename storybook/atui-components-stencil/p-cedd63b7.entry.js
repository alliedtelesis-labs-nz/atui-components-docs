import{r as t,c as i,h as e,H as s,g as a}from"./p-D3rwhcmG.js";import{f as r}from"./p-DuLooPsr.js";import{c as n}from"./p-CVoOBWGd.js";import{h as o,a as l}from"./p-EexUVHDN.js";const h=n("min-h-36 placeholder-text-light relative flex min-h-[36px] w-full flex-shrink flex-grow basis-0 gap-4 rounded-md border border-solid py-4 pl-8 pr-24 outline-none transition-colors duration-300 ease-in-out focus-within:outline-0 focus-within:ring-2",{variants:{disabled:{false:"bg-white focus-within:ring-active-foreground/30",true:"pointer-events-none border-none bg-surface-1 !text-disabled"},readonly:{false:"focus-within:ring-active-foreground/30",true:"cursor-text border-none !bg-surface-1 !text-dark"},invalid:{false:"border-med focus-within:border-active-dark focus-within:ring-active-foreground/30",true:"border-error-base focus-within:border-error-base focus-within:ring-destructive-foreground/30"},typeahead:{false:"cursor-pointer caret-transparent",true:null}},defaultVariants:{disabled:false,readonly:false,invalid:false,typeahead:false}});const d=n("transition[background-color,color,box-shadow] flex w-full cursor-pointer items-center truncate p-8 text-body font-normal duration-300 ease-in-out focus:outline-0 focus:ring-2 focus:ring-inset focus:ring-active-foreground/40",{variants:{active:{true:"bg-active-light text-active",false:"bg-white hover:bg-disabled-light"}}});const c=class{constructor(e){t(this,e);this.atuiChange=i(this,"atuiChange",7);this.label="";this.hint_text="";this.error_text="";this.info_text="";this.placeholder="";this.value=[];this.searchText="";this.isOpen=false;this.hasMatchingOptions=false;this.parentWidth="";this.menuId=`dropdown-${Math.random().toString(36).substring(2,11)}`}async componentWillLoad(){this.translations=await r(this.el)}componentDidLoad(){const t=this.el.getBoundingClientRect();this.parentWidth=`${t.width}px`}updateIsOpenState(t){this.isOpen=t.detail}handleChange(t){this.value=this.value.includes(t)?this.value.filter((i=>i!==t)):[...this.value,t];this.inputEl.value="";this.searchText="";this.atuiChange.emit(this.value)}handleClear(){this.searchText=""}async handleKeyDownMenu(t){var i;if(t.key==="Escape"){t.preventDefault();await this.menuRef.closeMenu();(i=this.triggerEl)===null||i===void 0?void 0:i.focus();return}if(t.key==="Enter"||t.key===" "){if(t.target instanceof HTMLLIElement){t.preventDefault();t.target.click()}return}if(t.key==="Tab"){return}const e=this.el.querySelector(`ul[id="${this.menuId}"]`);if(!e)return;o(t,e);l(t,e)}render(){return e(s,{key:"c8bd2d8bc4c4f0630afe270b13a26612662c09ab",class:"group/select",onFocusout:async t=>{const i=t.relatedTarget;if(!i||!this.el.contains(i)&&!i.closest("[data-atui-menu-portal]")){this.handleClear();setTimeout((async()=>{var t;await((t=this.menuRef)===null||t===void 0?void 0:t.closeMenu())}),100)}}},this.renderLabel(),e("atui-menu",{key:"e2fe5b1b44858689067bd18f457d6c08248f172d",ref:t=>this.menuRef=t,trigger:"click",align:"start",role:"listbox",width:this.parentWidth,portal:true,autoclose:false,disabled:this.disabled||this.readonly,onAtuiMenuStateChange:t=>this.updateIsOpenState(t)},this.renderInput(),!this.disabled||!this.readonly?this.renderOptions():null),e("div",{key:"ae429c09f666cc1feb70f4e218a10941beb85617"},this.error_text&&this.invalid&&e("span",{key:"91629101afadfaff872975aa8e31634e3e461631","data-name":"multi-select-error",class:"text-error"},this.error_text)))}renderLabel(){return e("div",{class:"mb-4 flex flex-col"},e("slot",{name:"label"}),(this.label||this.required||this.info_text)&&e("atui-form-label",{for:this.menuId,label:this.label,required:this.required&&!this.readonly,info_text:this.info_text}),this.hint_text&&e("span",{class:"text-xs leading-tight text-med","data-name":"multi-select-hint"},this.hint_text))}renderInput(){const t=h({invalid:this.invalid,disabled:this.disabled,readonly:this.readonly,typeahead:this.typeahead});return e("div",{class:t,slot:"menu-trigger",tabindex:0,ref:t=>this.triggerEl=t},e("div",{onClick:t=>t.stopPropagation()},e("atui-chip-list",{size:"sm",class:"w-full focus-within:ring-0",readonly:this.readonly,disabled:this.disabled,show_clear_all:false,onAtuiRemoveChip:t=>{this.value=this.value.filter((i=>!t.detail.includes(i)));this.atuiChange.emit(this.value)},chips:this.value,"data-name":"multi-select-chips-inside"},this.value.length===0&&e("div",{class:"text-body text-light"},this.placeholder))),!this.readonly&&!this.disabled&&e("div",{class:"absolute right-4 flex items-center"},e("div",{class:"user-select-none pointer-events-none flex h-full items-center bg-transparent p-4 text-foreground",role:"presentation",tabindex:-1},e("span",{class:"material-icons h-16 w-16 text-[16px] leading-[16px]","data-name":"button-icon-right"},this.isOpen?"arrow_drop_up":"arrow_drop_down"))))}renderOptions(){var t,i,s;return e("ul",{id:this.menuId,role:"listbox",class:"contents",slot:"menu-content",onKeyDown:async t=>{await this.handleKeyDownMenu(t)}},this.typeahead&&e("div",{class:"relative z-10 bg-white p-4"},e("input",{type:"text",class:`transition[background-color,color] mb-4 h-24 w-full flex-shrink flex-grow basis-0 rounded-md bg-surface-1 p-8 outline-0 ring-active-foreground/30 duration-300 ease-in-out focus:ring-2 ${this.clearable?"pr-24":""} `,placeholder:"Search...",value:this.searchText,onInput:t=>{var i;this.searchText=t.target.value.toLowerCase();const e=this.searchText.trim().toLowerCase();this.hasMatchingOptions=e?(i=this.options)===null||i===void 0?void 0:i.some((t=>t.value.toLowerCase().includes(e))):true},onClick:t=>t.stopPropagation(),ref:t=>this.inputEl=t}),this.clearable&&this.searchText!==""&&e("div",{class:"absolute right-4 top-4"},e("atui-button",{size:"sm",icon:"cancel",type:"secondaryText",onClick:t=>{t.stopPropagation();this.searchText="";this.inputEl.value=""},"data-name":"multi-select-search-clear"}))),(t=this.options)===null||t===void 0?void 0:t.filter((t=>!this.searchText||t.value.toLowerCase().includes(this.searchText))).map((t=>this.renderOption(t))),this.typeahead&&this.searchText&&!this.hasMatchingOptions&&e("div",{class:"w-full bg-white px-16 py-8 text-body text-light"},((s=(i=this.translations)===null||i===void 0?void 0:i.ATUI)===null||s===void 0?void 0:s.NO_RESULTS_FOUND)||"No results found"))}renderOption(t){const i=d({active:this.value.includes(t.value)});return e("li",{role:"option","data-name":"multi-select-option","aria-selected":this.value.includes(t.value),tabIndex:0,class:i,onClick:()=>this.handleChange(t.value)},t.value)}get el(){return a(this)}};export{c as atui_multi_select};
//# sourceMappingURL=p-cedd63b7.entry.js.map