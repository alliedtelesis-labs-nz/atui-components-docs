import{r as t,h as s,H as i}from"./p-jvbUuQtg.js";import{C as e,D as o,A as n,e as a,f as r,i as h,g as c}from"./p-DeceFzal.js";import{A as d}from"./p-Ckr-udZ5.js";import"moment";const l={xs:"h-[70px]",sm:"h-[160px]",md:"h-[235px]",lg:"h-[330px]",xl:"h-[440px]",auto:"h-full"},p=class{constructor(s){t(this,s)}data;options;height="auto";legend_position="top";legend_format={labels:{boxWidth:10,boxHeight:10,fontSize:11},onHover:t=>{t.native&&(t.native.target.style.cursor="pointer")},onClick:(t,s,i)=>{const e=i.chart;e.toggleDataVisibility(s.index);const o=e.data.labels?.some(((t,s)=>e.getDataVisibility(s)));e.options.plugins?.tooltip&&(e.options.plugins.tooltip.enabled=!!o),e.update()},display:!0};tooltip_options={mode:"nearest",intersect:!0,position:"nearest"};plugins;color_palette=d.CATEGORICAL;center_value;center_text;cutout=70;canvasEl;config;chart;async getConfig(){return this.config}async resize(){this.chart&&this.chart.resize()}defaultPieTooltipOptions={mode:"nearest",intersect:!0,position:"nearest",animation:{duration:150}};getDrawCenterTextPlugin(){return{id:"DrawCenterTextPlugin",afterDatasetDraw:t=>{const s=(t.chartArea.left+t.chartArea.right)/2,i=(t.chartArea.top+t.chartArea.bottom)/2,e=t.ctx;if(!e)return;e.restore();const o=t.chartArea.bottom-t.chartArea.top,n=(o/200).toFixed(2)+"em sans-serif",a=(o/140).toFixed(2)+"em sans-serif";e.fillStyle="#0f172a",e.textAlign="center",e.textBaseline="middle",e.font="500 "+a;const r=(t,s,i,o,n)=>{e.font="500 "+t;const a=e.measureText(s),r=a.actualBoundingBoxAscent+a.actualBoundingBoxDescent;"middle"!=n&&(o="top"===n?o-r:o+r),e.fillText(s,i,o)};this.center_value?(r(a,this.center_value,s,i,"top"),r(n,this.center_text,s,i,"bottom")):this.center_text&&r(n,this.center_text,s,i,"middle"),e.save()}}}initChart(){e.register(o,n,a,r,h);const t=window.devicePixelRatio||1,s=c(this.color_palette);s&&this.applyPresetPalette(s);const i=this.plugins?[...this.plugins]:[];(this.center_text||this.center_value)&&i.push(this.getDrawCenterTextPlugin()),this.config={type:"doughnut",data:{...this.data,datasets:this.data.datasets.map((t=>({...t,cutout:`${this.cutout}%`})))},options:{devicePixelRatio:t,maintainAspectRatio:!1,aspectRatio:1,layout:{padding:16},interaction:{mode:"nearest",intersect:!0},plugins:{legend:{...this.legend_format||{},position:this.legend_position,fullSize:!0},tooltip:{...this.tooltip_options||this.defaultPieTooltipOptions,filter:t=>t.chart.getDataVisibility(t.dataIndex),enabled:!0}},...this.options||{}},plugins:i},this.chart&&this.chart.destroy(),this.chart=new e(this.canvasEl,this.config)}applyPresetPalette(t){this.color_palette!==d.CUSTOM&&(this.data.datasets=this.data.datasets.map((s=>{const i=s.data.map(((s,i)=>t[i%t.length]));return{...s,backgroundColor:i,hoverBackgroundColor:i,borderColor:i,hoverBorderColor:i}})))}componentDidUpdate(){this.data&&this.data.datasets.length&&this.initChart()}componentDidLoad(){this.data&&this.data.datasets.length&&this.initChart()}render(){return s(i,{key:"ccacfac03f8806fbde2823d433748985608577c9",style:{height:"100%",width:"100%"}},s("canvas",{key:"44d3bdc962ab5b7e1862010a1c4029d34f5454dc",ref:t=>this.canvasEl=t,class:`w-full min-w-100 ${l[this.height]}`}))}};export{p as at_chart_donut}