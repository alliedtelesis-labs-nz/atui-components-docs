import{r as t,c as i,g as e,h as s}from"./p-EP34iaAr.js";class h{static getElements(t,i=document){if(typeof t==="string"){const e="getElementById"in i?i:undefined;if(e&&!isNaN(+t[0])){const i=e.getElementById(t);return i?[i]:[]}let s=i.querySelectorAll(t);if(!s.length&&t[0]!=="."&&t[0]!=="#"){s=i.querySelectorAll("."+t);if(!s.length)s=i.querySelectorAll("#"+t);if(!s.length){const e=i.querySelector(`[gs-id="${t}"]`);return e?[e]:[]}}return Array.from(s)}return[t]}static getElement(t,i=document){if(typeof t==="string"){const e="getElementById"in i?i:undefined;if(!t.length)return null;if(e&&t[0]==="#"){return e.getElementById(t.substring(1))}if(t[0]==="#"||t[0]==="."||t[0]==="["){return i.querySelector(t)}if(e&&!isNaN(+t[0])){return e.getElementById(t)}let s=i.querySelector(t);if(e&&!s){s=e.getElementById(t)}if(!s){s=i.querySelector("."+t)}return s}return t}static lazyLoad(t){return t.lazyLoad||t.grid?.opts?.lazyLoad&&t.lazyLoad!==false}static createDiv(t,i){const e=document.createElement("div");t.forEach((t=>{if(t)e.classList.add(t)}));i?.appendChild(e);return e}static shouldSizeToContent(t,i=false){return t?.grid&&(i?t.sizeToContent===true||t.grid.opts.sizeToContent===true&&t.sizeToContent===undefined:!!t.sizeToContent||t.grid.opts.sizeToContent&&t.sizeToContent!==false)}static isIntercepted(t,i){return!(t.y>=i.y+i.h||t.y+t.h<=i.y||t.x+t.w<=i.x||t.x>=i.x+i.w)}static isTouching(t,i){return h.isIntercepted(t,{x:i.x-.5,y:i.y-.5,w:i.w+1,h:i.h+1})}static areaIntercept(t,i){const e=t.x>i.x?t.x:i.x;const s=t.x+t.w<i.x+i.w?t.x+t.w:i.x+i.w;if(s<=e)return 0;const h=t.y>i.y?t.y:i.y;const r=t.y+t.h<i.y+i.h?t.y+t.h:i.y+i.h;if(r<=h)return 0;return(s-e)*(r-h)}static area(t){return t.w*t.h}static sort(t,i=1){const e=1e4;return t.sort(((t,s)=>{const h=i*((t.y??e)-(s.y??e));if(h===0)return i*((t.x??e)-(s.x??e));return h}))}static find(t,i){return i?t.find((t=>t.id===i)):undefined}static toBool(t){if(typeof t==="boolean"){return t}if(typeof t==="string"){t=t.toLowerCase();return!(t===""||t==="no"||t==="false"||t==="0")}return Boolean(t)}static toNumber(t){return t===null||t.length===0?undefined:Number(t)}static parseHeight(t){let i;let e="px";if(typeof t==="string"){if(t==="auto"||t==="")i=0;else{const s=t.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw|%|cm|mm)?$/);if(!s){throw new Error(`Invalid height val = ${t}`)}e=s[2]||"px";i=parseFloat(s[1])}}else{i=t}return{h:i,unit:e}}static defaults(t,...i){i.forEach((i=>{for(const e in i){if(!i.hasOwnProperty(e))return;if(t[e]===null||t[e]===undefined){t[e]=i[e]}else if(typeof i[e]==="object"&&typeof t[e]==="object"){h.defaults(t[e],i[e])}}}));return t}static same(t,i){if(typeof t!=="object")return t==i;if(typeof t!==typeof i)return false;if(Object.keys(t).length!==Object.keys(i).length)return false;for(const e in t){if(t[e]!==i[e])return false}return true}static copyPos(t,i,e=false){if(i.x!==undefined)t.x=i.x;if(i.y!==undefined)t.y=i.y;if(i.w!==undefined)t.w=i.w;if(i.h!==undefined)t.h=i.h;if(e){if(i.minW)t.minW=i.minW;if(i.minH)t.minH=i.minH;if(i.maxW)t.maxW=i.maxW;if(i.maxH)t.maxH=i.maxH}return t}static samePos(t,i){return t&&i&&t.x===i.x&&t.y===i.y&&(t.w||1)===(i.w||1)&&(t.h||1)===(i.h||1)}static sanitizeMinMax(t){if(!t.minW){delete t.minW}if(!t.minH){delete t.minH}if(!t.maxW){delete t.maxW}if(!t.maxH){delete t.maxH}}static removeInternalAndSame(t,i){if(typeof t!=="object"||typeof i!=="object")return;if(Array.isArray(t)||Array.isArray(i))return;for(let e in t){const s=t[e];const r=i[e];if(e[0]==="_"||s===r){delete t[e]}else if(s&&typeof s==="object"&&r!==undefined){h.removeInternalAndSame(s,r);if(!Object.keys(s).length){delete t[e]}}}}static removeInternalForSave(t,i=true){for(let i in t){if(i[0]==="_"||t[i]===null||t[i]===undefined)delete t[i]}delete t.grid;if(i)delete t.el;if(!t.autoPosition)delete t.autoPosition;if(!t.noResize)delete t.noResize;if(!t.noMove)delete t.noMove;if(!t.locked)delete t.locked;if(t.w===1||t.w===t.minW)delete t.w;if(t.h===1||t.h===t.minH)delete t.h}static throttle(t,i){let e=false;return(...s)=>{if(!e){e=true;setTimeout((()=>{t(...s);e=false}),i)}}}static removePositioningStyles(t){const i=t.style;if(i.position){i.removeProperty("position")}if(i.left){i.removeProperty("left")}if(i.top){i.removeProperty("top")}if(i.width){i.removeProperty("width")}if(i.height){i.removeProperty("height")}}static getScrollElement(t){if(!t)return document.scrollingElement||document.documentElement;const i=getComputedStyle(t);const e=/(auto|scroll)/;if(e.test(i.overflow+i.overflowY)){return t}else{return h.getScrollElement(t.parentElement)}}static updateScrollPosition(t,i,e){const s=h.getScrollElement(t);if(!s)return;const r=t.getBoundingClientRect();const n=s.getBoundingClientRect();const o=window.innerHeight||document.documentElement.clientHeight;const f=r.bottom-Math.min(n.bottom,o);const a=r.top-Math.max(n.top,0);const l=s.scrollTop;if(a<0&&e<0){if(t.offsetHeight>n.height){s.scrollTop+=e}else{s.scrollTop+=Math.abs(a)>Math.abs(e)?e:a}}else if(f>0&&e>0){if(t.offsetHeight>n.height){s.scrollTop+=e}else{s.scrollTop+=f>e?e:f}}i.top+=s.scrollTop-l}static updateScrollResize(t,i,e){const s=h.getScrollElement(i);const r=s.clientHeight;const n=s===h.getScrollElement()?0:s.getBoundingClientRect().top;const o=t.clientY-n;const f=o<e;const a=o>r-e;if(f){s.scrollBy({behavior:"smooth",top:o-e})}else if(a){s.scrollBy({behavior:"smooth",top:e-(r-o)})}}static clone(t){if(t===null||t===undefined||typeof t!=="object"){return t}if(t instanceof Array){return[...t]}return{...t}}static cloneDeep(t){const i=["parentGrid","el","grid","subGrid","engine"];const e=h.clone(t);for(const s in e){if(e.hasOwnProperty(s)&&typeof e[s]==="object"&&s.substring(0,2)!=="__"&&!i.find((t=>t===s))){e[s]=h.cloneDeep(t[s])}}return e}static cloneNode(t){const i=t.cloneNode(true);i.removeAttribute("id");return i}static appendTo(t,i){let e;if(typeof i==="string"){e=h.getElement(i)}else{e=i}if(e){e.appendChild(t)}}static addElStyles(t,i){if(i instanceof Object){for(const e in i){if(i.hasOwnProperty(e)){if(Array.isArray(i[e])){i[e].forEach((i=>{t.style[e]=i}))}else{t.style[e]=i[e]}}}}}static initEvent(t,i){const e={type:i.type};const s={button:0,which:0,buttons:1,bubbles:true,cancelable:true,target:i.target?i.target:t.target};["altKey","ctrlKey","metaKey","shiftKey"].forEach((i=>e[i]=t[i]));["pageX","pageY","clientX","clientY","screenX","screenY"].forEach((i=>e[i]=t[i]));return{...e,...s}}static simulateMouseEvent(t,i,e){const s=t;const h=new MouseEvent(i,{bubbles:true,composed:true,cancelable:true,view:window,detail:1,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:s.ctrlKey??false,altKey:s.altKey??false,shiftKey:s.shiftKey??false,metaKey:s.metaKey??false,button:0,relatedTarget:t.target});(e||t.target).dispatchEvent(h)}static getValuesFromTransformedElement(t){const i=document.createElement("div");h.addElStyles(i,{opacity:"0",position:"fixed",top:0+"px",left:0+"px",width:"1px",height:"1px",zIndex:"-999999"});t.appendChild(i);const e=i.getBoundingClientRect();t.removeChild(i);i.remove();return{xScale:1/e.width,yScale:1/e.height,xOffset:e.left,yOffset:e.top}}static swap(t,i,e){if(!t)return;const s=t[i];t[i]=t[e];t[e]=s}static canBeRotated(t){return!(!t||t.w===t.h||t.locked||t.noResize||t.grid?.opts.disableResize||t.minW&&t.minW===t.maxW||t.minH&&t.minH===t.maxH)}}class r{constructor(t={}){this.addedNodes=[];this.removedNodes=[];this.defaultColumn=12;this.column=t.column||this.defaultColumn;if(this.column>this.defaultColumn)this.defaultColumn=this.column;this.maxRow=t.maxRow;this._float=t.float;this.nodes=t.nodes||[];this.onChange=t.onChange}batchUpdate(t=true,i=true){if(!!this.batchMode===t)return this;this.batchMode=t;if(t){this._prevFloat=this._float;this._float=true;this.cleanNodes();this.saveInitial()}else{this._float=this._prevFloat;delete this._prevFloat;if(i)this._packNodes();this._notify()}return this}_useEntireRowArea(t,i){return(!this.float||this.batchMode&&!this._prevFloat)&&!this._hasLocked&&(!t._moving||t._skipDown||i.y<=t.y)}_fixCollisions(t,i=t,e,s={}){this.sortNodes(-1);e=e||this.collide(t,i);if(!e)return false;if(t._moving&&!s.nested&&!this.float){if(this.swap(t,e))return true}let r=i;if(!this._loading&&this._useEntireRowArea(t,i)){r={x:0,w:this.column,y:i.y,h:i.h};e=this.collide(t,r,s.skip)}let n=false;const o={nested:true,pack:false};let f=0;while(e=e||this.collide(t,r,s.skip)){if(f++>this.nodes.length*2){throw new Error("Infinite collide check")}let r;if(e.locked||this._loading||t._moving&&!t._skipDown&&i.y>t.y&&!this.float&&(!this.collide(e,{...e,y:t.y},t)||!this.collide(e,{...e,y:i.y-e.h},t))){t._skipDown=t._skipDown||i.y>t.y;const f={...i,y:e.y+e.h,...o};r=this._loading&&h.samePos(t,f)?true:this.moveNode(t,f);if((e.locked||this._loading)&&r){h.copyPos(i,t)}else if(!e.locked&&r&&s.pack){this._packNodes();i.y=e.y+e.h;h.copyPos(t,i)}n=n||r}else{r=this.moveNode(e,{...e,y:i.y+i.h,skip:t,...o})}if(!r)return n;e=undefined}return n}collide(t,i=t,e){const s=t._id;const r=e?._id;return this.nodes.find((t=>t._id!==s&&t._id!==r&&h.isIntercepted(t,i)))}collideAll(t,i=t,e){const s=t._id;const r=e?._id;return this.nodes.filter((t=>t._id!==s&&t._id!==r&&h.isIntercepted(t,i)))}directionCollideCoverage(t,i,e){if(!i.rect||!t._rect)return;const s=t._rect;const h={...i.rect};if(h.y>s.y){h.h+=h.y-s.y;h.y=s.y}else{h.h+=s.y-h.y}if(h.x>s.x){h.w+=h.x-s.x;h.x=s.x}else{h.w+=s.x-h.x}let r;let n=.5;for(let t of e){if(t.locked||!t._rect){break}const i=t._rect;let e=Number.MAX_VALUE,o=Number.MAX_VALUE;if(s.y<i.y){e=(h.y+h.h-i.y)/i.h}else if(s.y+s.h>i.y+i.h){e=(i.y+i.h-h.y)/i.h}if(s.x<i.x){o=(h.x+h.w-i.x)/i.w}else if(s.x+s.w>i.x+i.w){o=(i.x+i.w-h.x)/i.w}const f=Math.min(o,e);if(f>n){n=f;r=t}}i.collide=r;return r}cacheRects(t,i,e,s,h,r){this.nodes.forEach((n=>n._rect={y:n.y*i+e,x:n.x*t+r,w:n.w*t-r-s,h:n.h*i-e-h}));return this}swap(t,i){if(!i||i.locked||!t||t.locked)return false;function e(){const e=i.x,s=i.y;i.x=t.x;i.y=t.y;if(t.h!=i.h){t.x=e;t.y=i.y+i.h}else if(t.w!=i.w){t.x=i.x+i.w;t.y=s}else{t.x=e;t.y=s}t._dirty=i._dirty=true;return true}let s;if(t.w===i.w&&t.h===i.h&&(t.x===i.x||t.y===i.y)&&(s=h.isTouching(t,i)))return e();if(s===false)return;if(t.w===i.w&&t.x===i.x&&(s||(s=h.isTouching(t,i)))){if(i.y<t.y){const e=t;t=i;i=e}return e()}if(s===false)return;if(t.h===i.h&&t.y===i.y&&(s||(s=h.isTouching(t,i)))){if(i.x<t.x){const e=t;t=i;i=e}return e()}return false}isAreaEmpty(t,i,e,s){const h={x:t||0,y:i||0,w:e||1,h:s||1};return!this.collide(h)}compact(t="compact",i=true){if(this.nodes.length===0)return this;if(i)this.sortNodes();const e=this.batchMode;if(!e)this.batchUpdate();const s=this._inColumnResize;if(!s)this._inColumnResize=true;const h=this.nodes;this.nodes=[];h.forEach(((i,e,s)=>{let h;if(!i.locked){i.autoPosition=true;if(t==="list"&&e)h=s[e-1]}this.addNode(i,false,h)}));if(!s)delete this._inColumnResize;if(!e)this.batchUpdate(false);return this}set float(t){if(this._float===t)return;this._float=t||false;if(!t){this._packNodes()._notify()}}get float(){return this._float||false}sortNodes(t=1){this.nodes=h.sort(this.nodes,t);return this}_packNodes(){if(this.batchMode){return this}this.sortNodes();if(this.float){this.nodes.forEach((t=>{if(t._updating||t._orig===undefined||t.y===t._orig.y)return;let i=t.y;while(i>t._orig.y){--i;const e=this.collide(t,{x:t.x,y:i,w:t.w,h:t.h});if(!e){t._dirty=true;t.y=i}}}))}else{this.nodes.forEach(((t,i)=>{if(t.locked)return;while(t.y>0){const e=i===0?0:t.y-1;const s=i===0||!this.collide(t,{x:t.x,y:e,w:t.w,h:t.h});if(!s)break;t._dirty=t.y!==e;t.y=e}}))}return this}prepareNode(t,i){t._id=t._id??r._idSeq++;const e=t.id;if(e){let i=1;while(this.nodes.find((i=>i.id===t.id&&i!==t))){t.id=e+"_"+i++}}if(t.x===undefined||t.y===undefined||t.x===null||t.y===null){t.autoPosition=true}const s={x:0,y:0,w:1,h:1};h.defaults(t,s);if(!t.autoPosition){delete t.autoPosition}if(!t.noResize){delete t.noResize}if(!t.noMove){delete t.noMove}h.sanitizeMinMax(t);if(typeof t.x=="string"){t.x=Number(t.x)}if(typeof t.y=="string"){t.y=Number(t.y)}if(typeof t.w=="string"){t.w=Number(t.w)}if(typeof t.h=="string"){t.h=Number(t.h)}if(isNaN(t.x)){t.x=s.x;t.autoPosition=true}if(isNaN(t.y)){t.y=s.y;t.autoPosition=true}if(isNaN(t.w)){t.w=s.w}if(isNaN(t.h)){t.h=s.h}this.nodeBoundFix(t,i);return t}nodeBoundFix(t,i){const e=t._orig||h.copyPos({},t);if(t.maxW){t.w=Math.min(t.w||1,t.maxW)}if(t.maxH){t.h=Math.min(t.h||1,t.maxH)}if(t.minW){t.w=Math.max(t.w||1,t.minW)}if(t.minH){t.h=Math.max(t.h||1,t.minH)}const s=(t.x||0)+(t.w||1)>this.column;if(s&&this.column<this.defaultColumn&&!this._inColumnResize&&!this.skipCacheUpdate&&t._id!=null&&this.findCacheLayout(t,this.defaultColumn)===-1){const i={...t};if(i.autoPosition||i.x===undefined){delete i.x;delete i.y}else i.x=Math.min(this.defaultColumn-1,i.x);i.w=Math.min(this.defaultColumn,i.w||1);this.cacheOneLayout(i,this.defaultColumn)}if(t.w>this.column){t.w=this.column}else if(t.w<1){t.w=1}if(this.maxRow&&t.h>this.maxRow){t.h=this.maxRow}else if(t.h<1){t.h=1}if(t.x<0){t.x=0}if(t.y<0){t.y=0}if(t.x+t.w>this.column){if(i){t.w=this.column-t.x}else{t.x=this.column-t.w}}if(this.maxRow&&t.y+t.h>this.maxRow){if(i){t.h=this.maxRow-t.y}else{t.y=this.maxRow-t.h}}if(!h.samePos(t,e)){t._dirty=true}return this}getDirtyNodes(t){if(t){return this.nodes.filter((t=>t._dirty&&!h.samePos(t,t._orig)))}return this.nodes.filter((t=>t._dirty))}_notify(t){if(this.batchMode||!this.onChange)return this;const i=(t||[]).concat(this.getDirtyNodes());this.onChange(i);return this}cleanNodes(){if(this.batchMode)return this;this.nodes.forEach((t=>{delete t._dirty;delete t._lastTried}));return this}saveInitial(){this.nodes.forEach((t=>{t._orig=h.copyPos({},t);delete t._dirty}));this._hasLocked=this.nodes.some((t=>t.locked));return this}restoreInitial(){this.nodes.forEach((t=>{if(!t._orig||h.samePos(t,t._orig))return;h.copyPos(t,t._orig);t._dirty=true}));this._notify();return this}findEmptyPosition(t,i=this.nodes,e=this.column,s){const r=s?s.y*e+(s.x+s.w):0;let n=false;for(let s=r;!n;++s){const r=s%e;const o=Math.floor(s/e);if(r+t.w>e){continue}const f={x:r,y:o,w:t.w,h:t.h};if(!i.find((t=>h.isIntercepted(f,t)))){if(t.x!==r||t.y!==o)t._dirty=true;t.x=r;t.y=o;delete t.autoPosition;n=true}}return n}addNode(t,i=false,e){const s=this.nodes.find((i=>i._id===t._id));if(s)return s;this._inColumnResize?this.nodeBoundFix(t):this.prepareNode(t);delete t._temporaryRemoved;delete t._removeDOM;let h;if(t.autoPosition&&this.findEmptyPosition(t,this.nodes,this.column,e)){delete t.autoPosition;h=true}this.nodes.push(t);if(i){this.addedNodes.push(t)}if(!h)this._fixCollisions(t);if(!this.batchMode){this._packNodes()._notify()}return t}removeNode(t,i=true,e=false){if(!this.nodes.find((i=>i._id===t._id))){return this}if(e){this.removedNodes.push(t)}if(i)t._removeDOM=true;this.nodes=this.nodes.filter((i=>i._id!==t._id));if(!t._isAboutToRemove)this._packNodes();this._notify([t]);return this}removeAll(t=true,i=true){delete this._layouts;if(!this.nodes.length)return this;t&&this.nodes.forEach((t=>t._removeDOM=true));const e=this.nodes;this.removedNodes=i?e:[];this.nodes=[];return this._notify(e)}moveNodeCheck(t,i){if(!this.changedPosConstrain(t,i))return false;i.pack=true;if(!this.maxRow){return this.moveNode(t,i)}let e;const s=new r({column:this.column,float:this.float,nodes:this.nodes.map((i=>{if(i._id===t._id){e={...i};return e}return{...i}}))});if(!e)return false;const n=s.moveNode(e,i)&&s.getRow()<=Math.max(this.getRow(),this.maxRow);if(!n&&!i.resizing&&i.collide){const e=i.collide.el.gridstackNode;if(this.swap(t,e)){this._notify();return true}}if(!n)return false;s.nodes.filter((t=>t._dirty)).forEach((t=>{const i=this.nodes.find((i=>i._id===t._id));if(!i)return;h.copyPos(i,t);i._dirty=true}));this._notify();return true}willItFit(t){delete t._willFitPos;if(!this.maxRow)return true;const i=new r({column:this.column,float:this.float,nodes:this.nodes.map((t=>({...t})))});const e={...t};this.cleanupNode(e);delete e.el;delete e._id;delete e.content;delete e.grid;i.addNode(e);if(i.getRow()<=this.maxRow){t._willFitPos=h.copyPos({},e);return true}return false}changedPosConstrain(t,i){i.w=i.w||t.w;i.h=i.h||t.h;if(t.x!==i.x||t.y!==i.y)return true;if(t.maxW){i.w=Math.min(i.w,t.maxW)}if(t.maxH){i.h=Math.min(i.h,t.maxH)}if(t.minW){i.w=Math.max(i.w,t.minW)}if(t.minH){i.h=Math.max(i.h,t.minH)}return t.w!==i.w||t.h!==i.h}moveNode(t,i){if(!t||!i)return false;let e;if(i.pack===undefined&&!this.batchMode){e=i.pack=true}if(typeof i.x!=="number"){i.x=t.x}if(typeof i.y!=="number"){i.y=t.y}if(typeof i.w!=="number"){i.w=t.w}if(typeof i.h!=="number"){i.h=t.h}const s=t.w!==i.w||t.h!==i.h;const r=h.copyPos({},t,true);h.copyPos(r,i);this.nodeBoundFix(r,s);h.copyPos(i,r);if(!i.forceCollide&&h.samePos(t,i))return false;const n=h.copyPos({},t);const o=this.collideAll(t,r,i.skip);let f=true;if(o.length){const s=t._moving&&!i.nested;let n=s?this.directionCollideCoverage(t,i,o):o[0];if(s&&n&&t.grid?.opts?.subGridDynamic&&!t.grid._isTemp){const e=h.areaIntercept(i.rect,n._rect);const s=h.area(i.rect);const r=h.area(n._rect);const o=e/(s<r?s:r);if(o>.8){n.grid.makeSubGrid(n.el,undefined,t);n=undefined}}if(n){f=!this._fixCollisions(t,r,n,i)}else{f=false;if(e)delete i.pack}}if(f&&!h.samePos(t,r)){t._dirty=true;h.copyPos(t,r)}if(i.pack){this._packNodes()._notify()}return!h.samePos(t,n)}getRow(){return this.nodes.reduce(((t,i)=>Math.max(t,i.y+i.h)),0)}beginUpdate(t){if(!t._updating){t._updating=true;delete t._skipDown;if(!this.batchMode)this.saveInitial()}return this}endUpdate(){const t=this.nodes.find((t=>t._updating));if(t){delete t._updating;delete t._skipDown}return this}save(t=true,i,e){const s=this._layouts?.length||0;let r;if(s){if(e){if(e!==this.column)r=this._layouts[e]}else if(this.column!==s-1){r=this._layouts[s-1]}}const n=[];this.sortNodes();this.nodes.forEach((e=>{const s=r?.find((t=>t._id===e._id));const o={...e,...s||{}};h.removeInternalForSave(o,!t);if(i)i(e,o);n.push(o)}));return n}layoutsNodesChange(t){if(!this._layouts||this._inColumnResize)return this;this._layouts.forEach(((i,e)=>{if(!i||e===this.column)return this;if(e<this.column){this._layouts[e]=undefined}else{const s=e/this.column;t.forEach((t=>{if(!t._orig)return;const e=i.find((i=>i._id===t._id));if(!e)return;if(e.y>=0&&t.y!==t._orig.y){e.y+=t.y-t._orig.y;if(e.y<0)e.y=0}if(t.x!==t._orig.x){e.x=Math.round(t.x*s);if(e.x<0)e.x=0}if(t.w!==t._orig.w){e.w=Math.round(t.w*s);if(e.w<1)e.w=1}}))}}));return this}columnChanged(t,i,e="moveScale"){if(!this.nodes.length||!i||t===i)return this;const s=e==="compact"||e==="list";if(s){this.sortNodes(1)}if(i<t)this.cacheLayout(this.nodes,t);this.batchUpdate();let r=[];let n=s?this.nodes:h.sort(this.nodes,-1);if(i>t&&this._layouts){const e=this._layouts[i]||[];const h=this._layouts.length-1;if(!e.length&&t!==h&&this._layouts[h]?.length){t=h;this._layouts[h].forEach((t=>{const i=n.find((i=>i._id===t._id));if(i){if(!s&&!t.autoPosition){i.x=t.x??i.x;i.y=t.y??i.y}i.w=t.w??i.w;if(t.x==undefined||t.y===undefined)i.autoPosition=true}}))}e.forEach((t=>{const i=n.findIndex((i=>i._id===t._id));if(i!==-1){const e=n[i];if(s){e.w=t.w;return}if(t.autoPosition||isNaN(t.x)||isNaN(t.y)){this.findEmptyPosition(t,r)}if(!t.autoPosition){e.x=t.x??e.x;e.y=t.y??e.y;e.w=t.w??e.w;r.push(e)}n.splice(i,1)}}))}if(s){this.compact(e,false)}else{if(n.length){if(typeof e==="function"){e(i,t,r,n)}else{const h=s||e==="none"?1:i/t;const o=e==="move"||e==="moveScale";const f=e==="scale"||e==="moveScale";n.forEach((e=>{e.x=i===1?0:o?Math.round(e.x*h):Math.min(e.x,i-1);e.w=i===1||t===1?1:f?Math.round(e.w*h)||1:Math.min(e.w,i);r.push(e)}));n=[]}}r=h.sort(r,-1);this._inColumnResize=true;this.nodes=[];r.forEach((t=>{this.addNode(t,false);delete t._orig}))}this.nodes.forEach((t=>delete t._orig));this.batchUpdate(false,!s);delete this._inColumnResize;return this}cacheLayout(t,i,e=false){const s=[];t.forEach(((t,i)=>{if(t._id===undefined){const i=t.id?this.nodes.find((i=>i.id===t.id)):undefined;t._id=i?._id??r._idSeq++}s[i]={x:t.x,y:t.y,w:t.w,_id:t._id}}));this._layouts=e?[]:this._layouts||[];this._layouts[i]=s;return this}cacheOneLayout(t,i){t._id=t._id??r._idSeq++;const e={x:t.x,y:t.y,w:t.w,_id:t._id};if(t.autoPosition||t.x===undefined){delete e.x;delete e.y;if(t.autoPosition)e.autoPosition=true}this._layouts=this._layouts||[];this._layouts[i]=this._layouts[i]||[];const s=this.findCacheLayout(t,i);if(s===-1)this._layouts[i].push(e);else this._layouts[i][s]=e;return this}findCacheLayout(t,i){return this._layouts?.[i]?.findIndex((i=>i._id===t._id))??-1}removeNodeFromLayoutCache(t){if(!this._layouts){return}for(let i=0;i<this._layouts.length;i++){const e=this.findCacheLayout(t,i);if(e!==-1){this._layouts[i].splice(e,1)}}}cleanupNode(t){for(const i in t){if(i[0]==="_"&&i!=="_id")delete t[i]}return this}}r._idSeq=0;const n={alwaysShowResizeHandle:"mobile",animate:true,auto:true,cellHeight:"auto",cellHeightThrottle:100,cellHeightUnit:"px",column:12,draggable:{handle:".grid-stack-item-content",appendTo:"body",scroll:true},handle:".grid-stack-item-content",itemClass:"grid-stack-item",margin:10,marginUnit:"px",maxRow:0,minRow:0,placeholderClass:"grid-stack-placeholder",placeholderText:"",removableOptions:{accept:"grid-stack-item",decline:"grid-stack-non-removable"},resizable:{handles:"se"},rtl:"auto"};class o{}const f=typeof window!=="undefined"&&typeof document!=="undefined"&&("ontouchstart"in document||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);class a{}function l(t,i){if(t.touches.length>1)return;if(t.cancelable)t.preventDefault();h.simulateMouseEvent(t.changedTouches[0],i)}function u(t,i){if(t.cancelable)t.preventDefault();h.simulateMouseEvent(t,i)}function d(t){if(a.touchHandled)return;a.touchHandled=true;l(t,"mousedown")}function c(t){if(!a.touchHandled)return;l(t,"mousemove")}function g(t){if(!a.touchHandled)return;if(a.pointerLeaveTimeout){window.clearTimeout(a.pointerLeaveTimeout);delete a.pointerLeaveTimeout}const i=!!o.dragElement;l(t,"mouseup");if(!i){l(t,"click")}a.touchHandled=false}function m(t){if(t.pointerType==="mouse")return;t.target.releasePointerCapture(t.pointerId)}function p(t){if(!o.dragElement){return}if(t.pointerType==="mouse")return;u(t,"mouseenter")}function b(t){if(!o.dragElement){return}if(t.pointerType==="mouse")return;a.pointerLeaveTimeout=window.setTimeout((()=>{delete a.pointerLeaveTimeout;u(t,"mouseleave")}),10)}class w{constructor(t,i,e){this.host=t;this.dir=i;this.option=e;this.moving=false;this._mouseDown=this._mouseDown.bind(this);this._mouseMove=this._mouseMove.bind(this);this._mouseUp=this._mouseUp.bind(this);this._keyEvent=this._keyEvent.bind(this);this._init()}_init(){if(this.option.element){try{this.el=this.option.element instanceof HTMLElement?this.option.element:this.host.querySelector(this.option.element)}catch(t){this.option.element=undefined;console.error("Query for resizeable handle failed, falling back",t)}}if(!this.el){this.el=document.createElement("div");this.host.appendChild(this.el)}this.el.classList.add("ui-resizable-handle");this.el.classList.add(`${w.prefix}${this.dir}`);this.el.style.zIndex="100";this.el.style.userSelect="none";this.el.addEventListener("mousedown",this._mouseDown);if(f){this.el.addEventListener("touchstart",d);this.el.addEventListener("pointerdown",m)}return this}destroy(){if(this.moving)this._mouseUp(this.mouseDownEvent);this.el.removeEventListener("mousedown",this._mouseDown);if(f){this.el.removeEventListener("touchstart",d);this.el.removeEventListener("pointerdown",m)}if(!this.option.element){this.host.removeChild(this.el)}delete this.el;delete this.host;return this}_mouseDown(t){this.mouseDownEvent=t;document.addEventListener("mousemove",this._mouseMove,{capture:true,passive:true});document.addEventListener("mouseup",this._mouseUp,true);if(f){this.el.addEventListener("touchmove",c);this.el.addEventListener("touchend",g)}t.stopPropagation();t.preventDefault()}_mouseMove(t){const i=this.mouseDownEvent;if(this.moving){this._triggerEvent("move",t)}else if(Math.abs(t.x-i.x)+Math.abs(t.y-i.y)>2){this.moving=true;this._triggerEvent("start",this.mouseDownEvent);this._triggerEvent("move",t);document.addEventListener("keydown",this._keyEvent)}t.stopPropagation()}_mouseUp(t){if(this.moving){this._triggerEvent("stop",t);document.removeEventListener("keydown",this._keyEvent)}document.removeEventListener("mousemove",this._mouseMove,true);document.removeEventListener("mouseup",this._mouseUp,true);if(f){this.el.removeEventListener("touchmove",c);this.el.removeEventListener("touchend",g)}delete this.moving;delete this.mouseDownEvent;t.stopPropagation();t.preventDefault()}_keyEvent(t){if(t.key==="Escape"){this.host.gridstackNode?.grid?.engine.restoreInitial();this._mouseUp(this.mouseDownEvent)}}_triggerEvent(t,i){if(this.option[t])this.option[t](i);return this}}w.prefix="ui-resizable-";class y{constructor(){this._eventRegister={}}get disabled(){return this._disabled}on(t,i){this._eventRegister[t]=i}off(t){delete this._eventRegister[t]}enable(){this._disabled=false}disable(){this._disabled=true}destroy(){delete this._eventRegister}triggerEvent(t,i){if(!this.disabled&&this._eventRegister&&this._eventRegister[t])return this._eventRegister[t](i)}}class v extends y{constructor(t,i={}){super();this.el=t;this.option=i;this.rectScale={x:1,y:1};this._ui=()=>{const t=this.el.parentElement;const i=t.getBoundingClientRect();const e={width:this.originalRect.width,height:this.originalRect.height+this.scrolled,left:this.originalRect.left,top:this.originalRect.top-this.scrolled};const s=this.temporalRect||e;return{position:{left:(s.left-i.left)*this.rectScale.x,top:(s.top-i.top)*this.rectScale.y},size:{width:s.width*this.rectScale.x,height:s.height*this.rectScale.y}}};this._mouseOver=this._mouseOver.bind(this);this._mouseOut=this._mouseOut.bind(this);this.enable();this._setupAutoHide(this.option.autoHide);this._setupHandlers()}on(t,i){super.on(t,i)}off(t){super.off(t)}enable(){super.enable();this.el.classList.remove("ui-resizable-disabled");this._setupAutoHide(this.option.autoHide)}disable(){super.disable();this.el.classList.add("ui-resizable-disabled");this._setupAutoHide(false)}destroy(){this._removeHandlers();this._setupAutoHide(false);delete this.el;super.destroy()}updateOption(t){const i=t.handles&&t.handles!==this.option.handles;const e=t.autoHide&&t.autoHide!==this.option.autoHide;Object.keys(t).forEach((i=>this.option[i]=t[i]));if(i){this._removeHandlers();this._setupHandlers()}if(e){this._setupAutoHide(this.option.autoHide)}return this}_setupAutoHide(t){if(t){this.el.classList.add("ui-resizable-autohide");this.el.addEventListener("mouseover",this._mouseOver);this.el.addEventListener("mouseout",this._mouseOut)}else{this.el.classList.remove("ui-resizable-autohide");this.el.removeEventListener("mouseover",this._mouseOver);this.el.removeEventListener("mouseout",this._mouseOut);if(o.overResizeElement===this){delete o.overResizeElement}}return this}_mouseOver(t){if(o.overResizeElement||o.dragElement)return;o.overResizeElement=this;this.el.classList.remove("ui-resizable-autohide")}_mouseOut(t){if(o.overResizeElement!==this)return;delete o.overResizeElement;this.el.classList.add("ui-resizable-autohide")}_setupHandlers(){this.handlers=this.option.handles.split(",").map((t=>t.trim())).map((t=>new w(this.el,t,{element:this.option.element,start:t=>this._resizeStart(t),stop:t=>this._resizeStop(t),move:i=>this._resizing(i,t)})));return this}_resizeStart(t){this.sizeToContent=h.shouldSizeToContent(this.el.gridstackNode,true);this.originalRect=this.el.getBoundingClientRect();this.scrollEl=h.getScrollElement(this.el);this.scrollY=this.scrollEl.scrollTop;this.scrolled=0;this.startEvent=t;this._setupHelper();this._applyChange();const i=h.initEvent(t,{type:"resizestart",target:this.el});if(this.option.start){this.option.start(i,this._ui())}this.el.classList.add("ui-resizable-resizing");this.triggerEvent("resizestart",i);return this}_resizing(t,i){this.scrolled=this.scrollEl.scrollTop-this.scrollY;this.temporalRect=this._getChange(t,i);this._applyChange();const e=h.initEvent(t,{type:"resize",target:this.el});if(this.option.resize){this.option.resize(e,this._ui())}this.triggerEvent("resize",e);return this}_resizeStop(t){const i=h.initEvent(t,{type:"resizestop",target:this.el});this._cleanHelper();if(this.option.stop){this.option.stop(i)}this.el.classList.remove("ui-resizable-resizing");this.triggerEvent("resizestop",i);delete this.startEvent;delete this.originalRect;delete this.temporalRect;delete this.scrollY;delete this.scrolled;return this}_setupHelper(){this.elOriginStyleVal=v._originStyleProp.map((t=>this.el.style[t]));this.parentOriginStylePosition=this.el.parentElement.style.position;const t=this.el.parentElement;const i=h.getValuesFromTransformedElement(t);this.rectScale={x:i.xScale,y:i.yScale};if(getComputedStyle(this.el.parentElement).position.match(/static/)){this.el.parentElement.style.position="relative"}this.el.style.position="absolute";this.el.style.opacity="0.8";return this}_cleanHelper(){v._originStyleProp.forEach(((t,i)=>{this.el.style[t]=this.elOriginStyleVal[i]||null}));this.el.parentElement.style.position=this.parentOriginStylePosition||null;return this}_getChange(t,i){const e=this.startEvent;const s={width:this.originalRect.width,height:this.originalRect.height+this.scrolled,left:this.originalRect.left,top:this.originalRect.top-this.scrolled};const h=t.clientX-e.clientX;const r=this.sizeToContent?0:t.clientY-e.clientY;let n;let o;if(i.indexOf("e")>-1){s.width+=h}else if(i.indexOf("w")>-1){s.width-=h;s.left+=h;n=true}if(i.indexOf("s")>-1){s.height+=r}else if(i.indexOf("n")>-1){s.height-=r;s.top+=r;o=true}const f=this._constrainSize(s.width,s.height,n,o);if(Math.round(s.width)!==Math.round(f.width)){if(i.indexOf("w")>-1){s.left+=s.width-f.width}s.width=f.width}if(Math.round(s.height)!==Math.round(f.height)){if(i.indexOf("n")>-1){s.top+=s.height-f.height}s.height=f.height}return s}_constrainSize(t,i,e,s){const h=this.option;const r=(e?h.maxWidthMoveLeft:h.maxWidth)||Number.MAX_SAFE_INTEGER;const n=h.minWidth/this.rectScale.x||t;const o=(s?h.maxHeightMoveUp:h.maxHeight)||Number.MAX_SAFE_INTEGER;const f=h.minHeight/this.rectScale.y||i;const a=Math.min(r,Math.max(n,t));const l=Math.min(o,Math.max(f,i));return{width:a,height:l}}_applyChange(){let t={left:0,top:0,width:0,height:0};if(this.el.style.position==="absolute"){const i=this.el.parentElement;const{left:e,top:s}=i.getBoundingClientRect();t={left:e,top:s,width:0,height:0}}if(!this.temporalRect)return this;Object.keys(this.temporalRect).forEach((i=>{const e=this.temporalRect[i];const s=i==="width"||i==="left"?this.rectScale.x:i==="height"||i==="top"?this.rectScale.y:1;this.el.style[i]=(e-t[i])*s+"px"}));return this}_removeHandlers(){this.handlers.forEach((t=>t.destroy()));delete this.handlers;return this}}v._originStyleProp=["width","height","position","left","top","opacity","zIndex"];const k='input,textarea,button,select,option,[contenteditable="true"],.ui-resizable-handle';class z extends y{constructor(t,i={}){super();this.el=t;this.option=i;this.dragTransform={xScale:1,yScale:1,xOffset:0,yOffset:0};const e=i?.handle?.substring(1);const s=t.gridstackNode;this.dragEls=!e||t.classList.contains(e)?[t]:s?.subGrid?[t.querySelector(i.handle)||t]:Array.from(t.querySelectorAll(i.handle));if(this.dragEls.length===0){this.dragEls=[t]}this._mouseDown=this._mouseDown.bind(this);this._mouseMove=this._mouseMove.bind(this);this._mouseUp=this._mouseUp.bind(this);this._keyEvent=this._keyEvent.bind(this);this.enable()}on(t,i){super.on(t,i)}off(t){super.off(t)}enable(){if(this.disabled===false)return;super.enable();this.dragEls.forEach((t=>{t.addEventListener("mousedown",this._mouseDown);if(f){t.addEventListener("touchstart",d);t.addEventListener("pointerdown",m)}}));this.el.classList.remove("ui-draggable-disabled")}disable(t=false){if(this.disabled===true)return;super.disable();this.dragEls.forEach((t=>{t.removeEventListener("mousedown",this._mouseDown);if(f){t.removeEventListener("touchstart",d);t.removeEventListener("pointerdown",m)}}));if(!t)this.el.classList.add("ui-draggable-disabled")}destroy(){if(this.dragTimeout)window.clearTimeout(this.dragTimeout);delete this.dragTimeout;if(this.mouseDownEvent)this._mouseUp(this.mouseDownEvent);this.disable(true);delete this.el;delete this.helper;delete this.option;super.destroy()}updateOption(t){Object.keys(t).forEach((i=>this.option[i]=t[i]));return this}_mouseDown(t){if(o.mouseHandled)return;if(t.button!==0)return true;if(!this.dragEls.find((i=>i===t.target))&&t.target.closest(k))return true;if(this.option.cancel){if(t.target.closest(this.option.cancel))return true}this.mouseDownEvent=t;delete this.dragging;delete o.dragElement;delete o.dropElement;document.addEventListener("mousemove",this._mouseMove,{capture:true,passive:true});document.addEventListener("mouseup",this._mouseUp,true);if(f){t.currentTarget.addEventListener("touchmove",c);t.currentTarget.addEventListener("touchend",g)}t.preventDefault();if(document.activeElement)document.activeElement.blur();o.mouseHandled=true;return true}_callDrag(t){if(!this.dragging)return;const i=h.initEvent(t,{target:this.el,type:"drag"});if(this.option.drag){this.option.drag(i,this.ui())}this.triggerEvent("drag",i)}_mouseMove(t){const i=this.mouseDownEvent;this.lastDrag=t;if(this.dragging){this._dragFollow(t);if(o.pauseDrag){const i=Number.isInteger(o.pauseDrag)?o.pauseDrag:100;if(this.dragTimeout)window.clearTimeout(this.dragTimeout);this.dragTimeout=window.setTimeout((()=>this._callDrag(t)),i)}else{this._callDrag(t)}}else if(Math.abs(t.x-i.x)+Math.abs(t.y-i.y)>3){this.dragging=true;o.dragElement=this;const i=this.el.gridstackNode?.grid;if(i){o.dropElement=i.el.ddElement.ddDroppable}else{delete o.dropElement}this.helper=this._createHelper();this._setupHelperContainmentStyle();this.dragTransform=h.getValuesFromTransformedElement(this.helperContainment);this.dragOffset=this._getDragOffset(t,this.el,this.helperContainment);this._setupHelperStyle(t);const e=h.initEvent(t,{target:this.el,type:"dragstart"});if(this.option.start){this.option.start(e,this.ui())}this.triggerEvent("dragstart",e);document.addEventListener("keydown",this._keyEvent)}return true}_mouseUp(t){document.removeEventListener("mousemove",this._mouseMove,true);document.removeEventListener("mouseup",this._mouseUp,true);if(f&&t.currentTarget){t.currentTarget.removeEventListener("touchmove",c,true);t.currentTarget.removeEventListener("touchend",g,true)}if(this.dragging){delete this.dragging;delete this.el.gridstackNode?._origRotate;document.removeEventListener("keydown",this._keyEvent);if(o.dropElement?.el===this.el.parentElement){delete o.dropElement}this.helperContainment.style.position=this.parentOriginStylePosition||null;if(this.helper!==this.el)this.helper.remove();this._removeHelperStyle();const i=h.initEvent(t,{target:this.el,type:"dragstop"});if(this.option.stop){this.option.stop(i)}this.triggerEvent("dragstop",i);if(o.dropElement){o.dropElement.drop(t)}}delete this.helper;delete this.mouseDownEvent;delete o.dragElement;delete o.dropElement;delete o.mouseHandled;t.preventDefault()}_keyEvent(t){const i=this.el.gridstackNode;const e=i?.grid||o.dropElement?.el?.gridstack;if(t.key==="Escape"){if(i&&i._origRotate){i._orig=i._origRotate;delete i._origRotate}e?.cancelDrag();this._mouseUp(this.mouseDownEvent)}else if(i&&e&&(t.key==="r"||t.key==="R")){if(!h.canBeRotated(i))return;i._origRotate=i._origRotate||{...i._orig};delete i._moving;e.setAnimation(false).rotate(i.el,{top:-this.dragOffset.offsetTop,left:-this.dragOffset.offsetLeft}).setAnimation();i._moving=true;this.dragOffset=this._getDragOffset(this.lastDrag,i.el,this.helperContainment);this.helper.style.width=this.dragOffset.width+"px";this.helper.style.height=this.dragOffset.height+"px";h.swap(i._orig,"w","h");delete i._rect;this._mouseMove(this.lastDrag)}}_createHelper(){let t=this.el;if(typeof this.option.helper==="function"){t=this.option.helper(this.el)}else if(this.option.helper==="clone"){t=h.cloneNode(this.el)}if(!t.parentElement){h.appendTo(t,this.option.appendTo==="parent"?this.el.parentElement:this.option.appendTo)}this.dragElementOriginStyle=z.originStyleProp.map((t=>this.el.style[t]));return t}_setupHelperStyle(t){this.helper.classList.add("ui-draggable-dragging");this.el.gridstackNode?.grid?.el.classList.add("grid-stack-dragging");const i=this.helper.style;i.pointerEvents="none";i.width=this.dragOffset.width+"px";i.height=this.dragOffset.height+"px";i.willChange="left, top";i.position="fixed";this._dragFollow(t);i.transition="none";setTimeout((()=>{if(this.helper){i.transition=null}}),0);return this}_removeHelperStyle(){this.helper.classList.remove("ui-draggable-dragging");this.el.gridstackNode?.grid?.el.classList.remove("grid-stack-dragging");const t=this.helper?.gridstackNode;if(!t?._isAboutToRemove&&this.dragElementOriginStyle){const t=this.helper;const i=this.dragElementOriginStyle["transition"]||null;t.style.transition=this.dragElementOriginStyle["transition"]="none";z.originStyleProp.forEach((i=>t.style[i]=this.dragElementOriginStyle[i]||null));setTimeout((()=>t.style.transition=i),50)}delete this.dragElementOriginStyle;return this}_dragFollow(t){const i={left:0,top:0};const e=this.helper.style;const s=this.dragOffset;e.left=(t.clientX+s.offsetLeft-i.left)*this.dragTransform.xScale+"px";e.top=(t.clientY+s.offsetTop-i.top)*this.dragTransform.yScale+"px"}_setupHelperContainmentStyle(){this.helperContainment=this.helper.parentElement;if(this.helper.style.position!=="fixed"){this.parentOriginStylePosition=this.helperContainment.style.position;if(getComputedStyle(this.helperContainment).position.match(/static/)){this.helperContainment.style.position="relative"}}return this}_getDragOffset(t,i,e){let s=0;let h=0;if(e){s=this.dragTransform.xOffset;h=this.dragTransform.yOffset}const r=i.getBoundingClientRect();return{left:r.left,top:r.top,offsetLeft:-t.clientX+r.left-s,offsetTop:-t.clientY+r.top-h,width:r.width*this.dragTransform.xScale,height:r.height*this.dragTransform.yScale}}ui(){const t=this.el.parentElement;const i=t.getBoundingClientRect();const e=this.helper.getBoundingClientRect();return{position:{top:(e.top-i.top)*this.dragTransform.yScale,left:(e.left-i.left)*this.dragTransform.xScale}}}}z.originStyleProp=["width","height","transform","transform-origin","transition","pointerEvents","position","left","top","minWidth","willChange"];class x extends y{constructor(t,i={}){super();this.el=t;this.option=i;this._mouseEnter=this._mouseEnter.bind(this);this._mouseLeave=this._mouseLeave.bind(this);this.enable();this._setupAccept()}on(t,i){super.on(t,i)}off(t){super.off(t)}enable(){if(this.disabled===false)return;super.enable();this.el.classList.add("ui-droppable");this.el.classList.remove("ui-droppable-disabled");this.el.addEventListener("mouseenter",this._mouseEnter);this.el.addEventListener("mouseleave",this._mouseLeave);if(f){this.el.addEventListener("pointerenter",p);this.el.addEventListener("pointerleave",b)}}disable(t=false){if(this.disabled===true)return;super.disable();this.el.classList.remove("ui-droppable");if(!t)this.el.classList.add("ui-droppable-disabled");this.el.removeEventListener("mouseenter",this._mouseEnter);this.el.removeEventListener("mouseleave",this._mouseLeave);if(f){this.el.removeEventListener("pointerenter",p);this.el.removeEventListener("pointerleave",b)}}destroy(){this.disable(true);this.el.classList.remove("ui-droppable");this.el.classList.remove("ui-droppable-disabled");super.destroy()}updateOption(t){Object.keys(t).forEach((i=>this.option[i]=t[i]));this._setupAccept();return this}_mouseEnter(t){if(!o.dragElement)return;if(f&&t.isTrusted){return}if(!this._canDrop(o.dragElement.el))return;t.preventDefault();t.stopPropagation();if(o.dropElement&&o.dropElement!==this){o.dropElement._mouseLeave(t,true)}o.dropElement=this;const i=h.initEvent(t,{target:this.el,type:"dropover"});if(this.option.over){this.option.over(i,this._ui(o.dragElement))}this.triggerEvent("dropover",i);this.el.classList.add("ui-droppable-over")}_mouseLeave(t,i=false){if(!o.dragElement||o.dropElement!==this)return;t.preventDefault();t.stopPropagation();const e=h.initEvent(t,{target:this.el,type:"dropout"});if(this.option.out){this.option.out(e,this._ui(o.dragElement))}this.triggerEvent("dropout",e);if(o.dropElement===this){delete o.dropElement;if(!i){let i;let e=this.el.parentElement;while(!i&&e){i=e.ddElement?.ddDroppable;e=e.parentElement}if(i){i._mouseEnter(t)}}}}drop(t){t.preventDefault();const i=h.initEvent(t,{target:this.el,type:"drop"});if(this.option.drop){this.option.drop(i,this._ui(o.dragElement))}this.triggerEvent("drop",i)}_canDrop(t){return t&&(!this.accept||this.accept(t))}_setupAccept(){if(!this.option.accept)return this;if(typeof this.option.accept==="string"){this.accept=t=>t.classList.contains(this.option.accept)||t.matches(this.option.accept)}else{this.accept=this.option.accept}return this}_ui(t){return{draggable:t.el,...t.ui()}}}class M{static init(t){if(!t.ddElement){t.ddElement=new M(t)}return t.ddElement}constructor(t){this.el=t}on(t,i){if(this.ddDraggable&&["drag","dragstart","dragstop"].indexOf(t)>-1){this.ddDraggable.on(t,i)}else if(this.ddDroppable&&["drop","dropover","dropout"].indexOf(t)>-1){this.ddDroppable.on(t,i)}else if(this.ddResizable&&["resizestart","resize","resizestop"].indexOf(t)>-1){this.ddResizable.on(t,i)}return this}off(t){if(this.ddDraggable&&["drag","dragstart","dragstop"].indexOf(t)>-1){this.ddDraggable.off(t)}else if(this.ddDroppable&&["drop","dropover","dropout"].indexOf(t)>-1){this.ddDroppable.off(t)}else if(this.ddResizable&&["resizestart","resize","resizestop"].indexOf(t)>-1){this.ddResizable.off(t)}return this}setupDraggable(t){if(!this.ddDraggable){this.ddDraggable=new z(this.el,t)}else{this.ddDraggable.updateOption(t)}return this}cleanDraggable(){if(this.ddDraggable){this.ddDraggable.destroy();delete this.ddDraggable}return this}setupResizable(t){if(!this.ddResizable){this.ddResizable=new v(this.el,t)}else{this.ddResizable.updateOption(t)}return this}cleanResizable(){if(this.ddResizable){this.ddResizable.destroy();delete this.ddResizable}return this}setupDroppable(t){if(!this.ddDroppable){this.ddDroppable=new x(this.el,t)}else{this.ddDroppable.updateOption(t)}return this}cleanDroppable(){if(this.ddDroppable){this.ddDroppable.destroy();delete this.ddDroppable}return this}}class _{resizable(t,i,e,s){this._getDDElements(t,i).forEach((t=>{if(i==="disable"||i==="enable"){t.ddResizable&&t.ddResizable[i]()}else if(i==="destroy"){t.ddResizable&&t.cleanResizable()}else if(i==="option"){t.setupResizable({[e]:s})}else{const e=t.el.gridstackNode;const s=e.grid;let h=t.el.getAttribute("gs-resize-handles")||s.opts.resizable.handles||"e,s,se";if(h==="all")h="n,e,s,w,se,sw,ne,nw";const r=!s.opts.alwaysShowResizeHandle;t.setupResizable({...s.opts.resizable,...{handles:h,autoHide:r},...{start:i.start,stop:i.stop,resize:i.resize}})}}));return this}draggable(t,i,e,s){this._getDDElements(t,i).forEach((t=>{if(i==="disable"||i==="enable"){t.ddDraggable&&t.ddDraggable[i]()}else if(i==="destroy"){t.ddDraggable&&t.cleanDraggable()}else if(i==="option"){t.setupDraggable({[e]:s})}else{const e=t.el.gridstackNode.grid;t.setupDraggable({...e.opts.draggable,...{start:i.start,stop:i.stop,drag:i.drag}})}}));return this}dragIn(t,i){this._getDDElements(t).forEach((t=>t.setupDraggable(i)));return this}droppable(t,i,e,s){if(typeof i.accept==="function"&&!i._accept){i._accept=i.accept;i.accept=t=>i._accept(t)}this._getDDElements(t,i).forEach((t=>{if(i==="disable"||i==="enable"){t.ddDroppable&&t.ddDroppable[i]()}else if(i==="destroy"){t.ddDroppable&&t.cleanDroppable()}else if(i==="option"){t.setupDroppable({[e]:s})}else{t.setupDroppable(i)}}));return this}isDroppable(t){return!!(t?.ddElement?.ddDroppable&&!t.ddElement.ddDroppable.disabled)}isDraggable(t){return!!(t?.ddElement?.ddDraggable&&!t.ddElement.ddDraggable.disabled)}isResizable(t){return!!(t?.ddElement?.ddResizable&&!t.ddElement.ddResizable.disabled)}on(t,i,e){this._getDDElements(t).forEach((t=>t.on(i,(t=>{e(t,o.dragElement?o.dragElement.el:t.target,o.dragElement?o.dragElement.helper:null)}))));return this}off(t,i){this._getDDElements(t).forEach((t=>t.off(i)));return this}_getDDElements(t,i){const e=t.gridstack||i!=="destroy"&&i!=="disable";const s=h.getElements(t);if(!s.length)return[];const r=s.map((t=>t.ddElement||(e?M.init(t):null))).filter((t=>t));return r}}
/*!
 * GridStack 12.4.1
 * https://gridstackjs.com/
 *
 * Copyright (c) 2021-2025  Alain Dumesny
 * see root license https://github.com/gridstack/gridstack.js/tree/master/LICENSE
 */const S=new _;class C{static init(t={},i=".grid-stack"){if(typeof document==="undefined")return null;const e=C.getGridElement(i);if(!e){if(typeof i==="string"){console.error('GridStack.initAll() no grid was found with selector "'+i+'" - element missing or wrong selector ?'+'\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.')}else{console.error("GridStack.init() no grid element was passed.")}return null}if(!e.gridstack){e.gridstack=new C(e,h.cloneDeep(t))}return e.gridstack}static initAll(t={},i=".grid-stack"){const e=[];if(typeof document==="undefined")return e;C.getGridElements(i).forEach((i=>{if(!i.gridstack){i.gridstack=new C(i,h.cloneDeep(t))}e.push(i.gridstack)}));if(e.length===0){console.error('GridStack.initAll() no grid was found with selector "'+i+'" - element missing or wrong selector ?'+'\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.')}return e}static addGrid(t,i={}){if(!t)return null;let e=t;if(e.gridstack){const t=e.gridstack;if(i)t.opts={...t.opts,...i};if(i.children!==undefined)t.load(i.children);return t}const s=t.classList.contains("grid-stack");if(!s||C.addRemoveCB){if(C.addRemoveCB){e=C.addRemoveCB(t,i,true,true)}else{e=h.createDiv(["grid-stack",i.class],t)}}const r=C.init(i,e);return r}static registerEngine(t){C.engineClass=t}get placeholder(){if(!this._placeholder){this._placeholder=h.createDiv([this.opts.placeholderClass,n.itemClass,this.opts.itemClass]);const t=h.createDiv(["placeholder-content"],this._placeholder);if(this.opts.placeholderText){t.textContent=this.opts.placeholderText}}return this._placeholder}constructor(t,i={}){this.el=t;this.opts=i;this.animationDelay=300+10;this._gsEventHandler={};this._extraDragRow=0;this.dragTransform={xScale:1,yScale:1,xOffset:0,yOffset:0};t.gridstack=this;this.opts=i=i||{};if(!t.classList.contains("grid-stack")){this.el.classList.add("grid-stack")}if(i.row){i.minRow=i.maxRow=i.row;delete i.row}const e=h.toNumber(t.getAttribute("gs-row"));if(i.column==="auto"){delete i.column}if(i.alwaysShowResizeHandle!==undefined){i._alwaysShowResizeHandle=i.alwaysShowResizeHandle}const s=i.columnOpts;if(s){const t=s.breakpoints;if(!s.columnWidth&&!t?.length){delete i.columnOpts}else{s.columnMax=s.columnMax||12;if(t?.length>1)t.sort(((t,i)=>(i.w||0)-(t.w||0)))}}const a={...h.cloneDeep(n),column:h.toNumber(t.getAttribute("gs-column"))||n.column,minRow:e?e:h.toNumber(t.getAttribute("gs-min-row"))||n.minRow,maxRow:e?e:h.toNumber(t.getAttribute("gs-max-row"))||n.maxRow,staticGrid:h.toBool(t.getAttribute("gs-static"))||n.staticGrid,sizeToContent:h.toBool(t.getAttribute("gs-size-to-content"))||undefined,draggable:{handle:(i.handleClass?"."+i.handleClass:i.handle?i.handle:"")||n.draggable.handle},removableOptions:{accept:i.itemClass||n.removableOptions.accept,decline:n.removableOptions.decline}};if(t.getAttribute("gs-animate")){a.animate=h.toBool(t.getAttribute("gs-animate"))}i=h.defaults(i,a);this._initMargin();this.checkDynamicColumn();this._updateColumnVar(i);if(i.rtl==="auto"){i.rtl=t.style.direction==="rtl"}if(i.rtl){this.el.classList.add("grid-stack-rtl")}const l=this.el.closest("."+n.itemClass);const u=l?.gridstackNode;if(u){u.subGrid=this;this.parentGridNode=u;this.el.classList.add("grid-stack-nested");u.el.classList.add("grid-stack-sub-grid")}this._isAutoCellHeight=i.cellHeight==="auto";if(this._isAutoCellHeight||i.cellHeight==="initial"){this.cellHeight(undefined)}else{if(typeof i.cellHeight=="number"&&i.cellHeightUnit&&i.cellHeightUnit!==n.cellHeightUnit){i.cellHeight=i.cellHeight+i.cellHeightUnit;delete i.cellHeightUnit}const t=i.cellHeight;delete i.cellHeight;this.cellHeight(t)}if(i.alwaysShowResizeHandle==="mobile"){i.alwaysShowResizeHandle=f}this._setStaticClass();const d=i.engineClass||C.engineClass||r;this.engine=new d({column:this.getColumn(),float:i.float,maxRow:i.maxRow,onChange:t=>{t.forEach((t=>{const i=t.el;if(!i)return;if(t._removeDOM){if(i)i.remove();delete t._removeDOM}else{this._writePosAttr(i,t)}}));this._updateContainerHeight()}});if(i.auto){this.batchUpdate();this.engine._loading=true;this.getGridItems().forEach((t=>this._prepareElement(t)));delete this.engine._loading;this.batchUpdate(false)}if(i.children){const t=i.children;delete i.children;if(t.length)this.load(t)}this.setAnimation();if(i.subGridDynamic&&!o.pauseDrag)o.pauseDrag=true;if(i.draggable?.pause!==undefined)o.pauseDrag=i.draggable.pause;this._setupRemoveDrop();this._setupAcceptWidget();this._updateResizeEvent()}_updateColumnVar(t=this.opts){this.el.classList.add("gs-"+t.column);if(typeof t.column==="number")this.el.style.setProperty("--gs-column-width",`${100/t.column}%`)}addWidget(t){if(!t)return;if(typeof t==="string"){console.error("V11: GridStack.addWidget() does not support string anymore. see #2736");return}if(t.ELEMENT_NODE){console.error("V11: GridStack.addWidget() does not support HTMLElement anymore. use makeWidget()");return this.makeWidget(t)}let i;let e=t;e.grid=this;if(e.el){i=e.el}else if(C.addRemoveCB){i=C.addRemoveCB(this.el,t,true,false)}else{i=this.createWidgetDivs(e)}if(!i)return;e=i.gridstackNode;if(e&&i.parentElement===this.el&&this.engine.nodes.find((t=>t._id===e._id)))return i;const s=this._readAttr(i);h.defaults(t,s);this.engine.prepareNode(t);this.el.appendChild(i);this.makeWidget(i,t);return i}createWidgetDivs(t){const i=h.createDiv(["grid-stack-item",this.opts.itemClass]);const e=h.createDiv(["grid-stack-item-content"],i);if(h.lazyLoad(t)){if(!t.visibleObservable){t.visibleObservable=new IntersectionObserver((([i])=>{if(i.isIntersecting){t.visibleObservable?.disconnect();delete t.visibleObservable;C.renderCB(e,t);t.grid?.prepareDragDrop(t.el)}}));window.setTimeout((()=>t.visibleObservable?.observe(i)))}}else C.renderCB(e,t);return i}makeSubGrid(t,i,e,s=true){let r=t.gridstackNode;if(!r){r=this.makeWidget(t).gridstackNode}if(r.subGrid?.el)return r.subGrid;let n;let o=this;while(o&&!n){n=o.opts?.subGridOpts;o=o.parentGridNode?.grid}i=h.cloneDeep({...this.opts,id:undefined,children:undefined,column:"auto",columnOpts:undefined,layout:"list",subGridOpts:undefined,...n||{},...i||r.subGridOpts||{}});r.subGridOpts=i;let f;if(i.column==="auto"){f=true;i.column=Math.max(r.w||1,e?.w||1);delete i.columnOpts}let a=r.el.querySelector(".grid-stack-item-content");let l;let u;if(s){this._removeDD(r.el);u={...r,x:0,y:0};h.removeInternalForSave(u);delete u.subGridOpts;if(r.content){u.content=r.content;delete r.content}if(C.addRemoveCB){l=C.addRemoveCB(this.el,u,true,false)}else{l=h.createDiv(["grid-stack-item"]);l.appendChild(a);a=h.createDiv(["grid-stack-item-content"],r.el)}this.prepareDragDrop(r.el)}if(e){const t=f?i.column:r.w;const s=r.h+e.h;const h=r.el.style;h.transition="none";this.update(r.el,{w:t,h:s});setTimeout((()=>h.transition=null))}const d=r.subGrid=C.addGrid(a,i);if(e?._moving)d._isTemp=true;if(f)d._autoColumn=true;if(s){d.makeWidget(l,u)}if(e){if(e._moving){window.setTimeout((()=>h.simulateMouseEvent(e._event,"mouseenter",d.el)),0)}else{d.makeWidget(r.el,r)}}this.resizeToContentCheck(false,r);return d}removeAsSubGrid(t){const i=this.parentGridNode?.grid;if(!i)return;i.batchUpdate();i.removeWidget(this.parentGridNode.el,true,true);this.engine.nodes.forEach((t=>{t.x+=this.parentGridNode.x;t.y+=this.parentGridNode.y;i.makeWidget(t.el,t)}));i.batchUpdate(false);if(this.parentGridNode)delete this.parentGridNode.subGrid;delete this.parentGridNode;if(t){window.setTimeout((()=>h.simulateMouseEvent(t._event,"mouseenter",i.el)),0)}}save(t=true,i=false,e=C.saveCB,s){const r=this.engine.save(t,e,s);r.forEach((s=>{if(t&&s.el&&!s.subGrid&&!e){const t=s.el.querySelector(".grid-stack-item-content");s.content=t?.innerHTML;if(!s.content)delete s.content}else{if(!t&&!e){delete s.content}if(s.subGrid?.el){const h=s.w||s.subGrid.getColumn();const r=s.subGrid.save(t,i,e,h);s.subGridOpts=i?r:{children:r};delete s.subGrid}}delete s.el}));if(i){const t=h.cloneDeep(this.opts);if(t.marginBottom===t.marginTop&&t.marginRight===t.marginLeft&&t.marginTop===t.marginRight){t.margin=t.marginTop;delete t.marginTop;delete t.marginRight;delete t.marginBottom;delete t.marginLeft}if(t.rtl===(this.el.style.direction==="rtl")){t.rtl="auto"}if(this._isAutoCellHeight){t.cellHeight="auto"}if(this._autoColumn){t.column="auto"}const i=t._alwaysShowResizeHandle;delete t._alwaysShowResizeHandle;if(i!==undefined){t.alwaysShowResizeHandle=i}else{delete t.alwaysShowResizeHandle}h.removeInternalAndSame(t,n);t.children=r;return t}return r}load(t,i=C.addRemoveCB||true){t=h.cloneDeep(t);const e=this.getColumn();t.forEach((t=>{t.w=t.w||t.minW||1;t.h=t.h||t.minH||1}));t=h.sort(t);this.engine.skipCacheUpdate=this._ignoreLayoutsNodeChange=true;let s=0;t.forEach((t=>{s=Math.max(s,(t.x||0)+t.w)}));if(s>this.engine.defaultColumn)this.engine.defaultColumn=s;if(s>e){if(this.engine.nodes.length===0&&this.responseLayout){this.engine.nodes=t;this.engine.columnChanged(s,e,this.responseLayout);t=this.engine.nodes;this.engine.nodes=[];delete this.responseLayout}else this.engine.cacheLayout(t,s,true)}const r=C.addRemoveCB;if(typeof i==="function")C.addRemoveCB=i;const n=[];this.batchUpdate();const o=!this.engine.nodes.length;const f=o&&this.opts.animate;if(f)this.setAnimation(false);if(!o&&i){const i=[...this.engine.nodes];i.forEach((i=>{if(!i.id)return;const e=h.find(t,i.id);if(!e){if(C.addRemoveCB)C.addRemoveCB(this.el,i,false,false);n.push(i);this.removeWidget(i.el,true,false)}}))}this.engine._loading=true;const a=[];this.engine.nodes=this.engine.nodes.filter((i=>{if(h.find(t,i.id)){a.push(i);return false}return true}));t.forEach((t=>{const e=h.find(a,t.id);if(e){if(h.shouldSizeToContent(e))t.h=e.h;this.engine.nodeBoundFix(t);if(t.autoPosition||t.x===undefined||t.y===undefined){t.w=t.w||e.w;t.h=t.h||e.h;this.engine.findEmptyPosition(t)}this.engine.nodes.push(e);if(h.samePos(e,t)&&this.engine.nodes.length>1){this.moveNode(e,{...t,forceCollide:true});h.copyPos(t,e)}this.update(e.el,t);if(t.subGridOpts?.children){const i=e.el.querySelector(".grid-stack");if(i&&i.gridstack){i.gridstack.load(t.subGridOpts.children)}}}else if(i){this.addWidget(t)}}));delete this.engine._loading;this.engine.removedNodes=n;this.batchUpdate(false);delete this._ignoreLayoutsNodeChange;delete this.engine.skipCacheUpdate;r?C.addRemoveCB=r:delete C.addRemoveCB;if(f)this.setAnimation(true,true);return this}batchUpdate(t=true){this.engine.batchUpdate(t);if(!t){this._updateContainerHeight();this._triggerRemoveEvent();this._triggerAddEvent();this._triggerChangeEvent()}return this}getCellHeight(t=false){if(this.opts.cellHeight&&this.opts.cellHeight!=="auto"&&(!t||!this.opts.cellHeightUnit||this.opts.cellHeightUnit==="px")){return this.opts.cellHeight}if(this.opts.cellHeightUnit==="rem"){return this.opts.cellHeight*parseFloat(getComputedStyle(document.documentElement).fontSize)}if(this.opts.cellHeightUnit==="em"){return this.opts.cellHeight*parseFloat(getComputedStyle(this.el).fontSize)}if(this.opts.cellHeightUnit==="cm"){return this.opts.cellHeight*(96/2.54)}if(this.opts.cellHeightUnit==="mm"){return this.opts.cellHeight*(96/2.54)/10}const i=this.el.querySelector("."+this.opts.itemClass);if(i){const t=h.toNumber(i.getAttribute("gs-h"))||1;return Math.round(i.offsetHeight/t)}const e=parseInt(this.el.getAttribute("gs-current-row"));return e?Math.round(this.el.getBoundingClientRect().height/e):this.opts.cellHeight}cellHeight(t){if(t!==undefined){if(this._isAutoCellHeight!==(t==="auto")){this._isAutoCellHeight=t==="auto";this._updateResizeEvent()}}if(t==="initial"||t==="auto"){t=undefined}if(t===undefined){const i=-this.opts.marginRight-this.opts.marginLeft+this.opts.marginTop+this.opts.marginBottom;t=this.cellWidth()+i}const i=h.parseHeight(t);if(this.opts.cellHeightUnit===i.unit&&this.opts.cellHeight===i.h){return this}this.opts.cellHeightUnit=i.unit;this.opts.cellHeight=i.h;this.el.style.setProperty("--gs-cell-height",`${this.opts.cellHeight}${this.opts.cellHeightUnit}`);this._updateContainerHeight();this.resizeToContentCheck();return this}cellWidth(){return this._widthOrContainer()/this.getColumn()}_widthOrContainer(t=false){return t&&this.opts.columnOpts?.breakpointForWindow?window.innerWidth:this.el.clientWidth||this.el.parentElement.clientWidth||window.innerWidth}checkDynamicColumn(){const t=this.opts.columnOpts;if(!t||!t.columnWidth&&!t.breakpoints?.length)return false;const i=this.getColumn();let e=i;const s=this._widthOrContainer(true);if(t.columnWidth){e=Math.min(Math.round(s/t.columnWidth)||1,t.columnMax)}else{e=t.columnMax;let h=0;while(h<t.breakpoints.length&&s<=t.breakpoints[h].w){e=t.breakpoints[h++].c||i}}if(e!==i){const i=t.breakpoints?.find((t=>t.c===e));this.column(e,i?.layout||t.layout);return true}return false}compact(t="compact",i=true){this.engine.compact(t,i);this._triggerChangeEvent();return this}column(t,i="moveScale"){if(!t||t<1||this.opts.column===t)return this;const e=this.getColumn();this.opts.column=t;if(!this.engine){this.responseLayout=i;return this}this.engine.column=t;this.el.classList.remove("gs-"+e);this._updateColumnVar();this.engine.columnChanged(e,t,i);if(this._isAutoCellHeight)this.cellHeight();this.resizeToContentCheck(true);this._ignoreLayoutsNodeChange=true;this._triggerChangeEvent();delete this._ignoreLayoutsNodeChange;return this}getColumn(){return this.opts.column}getGridItems(){return Array.from(this.el.children).filter((t=>t.matches("."+this.opts.itemClass)&&!t.matches("."+this.opts.placeholderClass)))}isIgnoreChangeCB(){return this._ignoreLayoutsNodeChange}destroy(t=true){if(!this.el)return;this.offAll();this._updateResizeEvent(true);this.setStatic(true,false);this.setAnimation(false);if(!t){this.removeAll(t);this.el.removeAttribute("gs-current-row")}else{this.el.parentNode.removeChild(this.el)}if(this.parentGridNode)delete this.parentGridNode.subGrid;delete this.parentGridNode;delete this.opts;delete this._placeholder?.gridstackNode;delete this._placeholder;delete this.engine;delete this.el.gridstack;delete this.el;return this}float(t){if(this.opts.float!==t){this.opts.float=this.engine.float=t;this._triggerChangeEvent()}return this}getFloat(){return this.engine.float}getCellFromPixel(t,i=false){const e=this.el.getBoundingClientRect();let s;if(i){s={top:e.top+document.documentElement.scrollTop,left:e.left}}else{s={top:this.el.offsetTop,left:this.el.offsetLeft}}const h=t.left-s.left;const r=t.top-s.top;const n=e.width/this.getColumn();const o=e.height/parseInt(this.el.getAttribute("gs-current-row"));return{x:Math.floor(h/n),y:Math.floor(r/o)}}getRow(){return Math.max(this.engine.getRow(),this.opts.minRow||0)}isAreaEmpty(t,i,e,s){return this.engine.isAreaEmpty(t,i,e,s)}makeWidget(t,i){const e=C.getElement(t);if(!e||e.gridstackNode)return e;if(!e.parentElement)this.el.appendChild(e);this._prepareElement(e,true,i);const s=e.gridstackNode;this._updateContainerHeight();if(s.subGridOpts){this.makeSubGrid(e,s.subGridOpts,undefined,false)}let h;if(this.opts.column===1&&!this._ignoreLayoutsNodeChange){h=this._ignoreLayoutsNodeChange=true}this._triggerAddEvent();this._triggerChangeEvent();if(h)delete this._ignoreLayoutsNodeChange;return e}on(t,i){if(t.indexOf(" ")!==-1){const e=t.split(" ");e.forEach((t=>this.on(t,i)));return this}if(t==="change"||t==="added"||t==="removed"||t==="enable"||t==="disable"){const e=t==="enable"||t==="disable";if(e){this._gsEventHandler[t]=t=>i(t)}else{this._gsEventHandler[t]=t=>{if(t.detail)i(t,t.detail)}}this.el.addEventListener(t,this._gsEventHandler[t])}else if(t==="drag"||t==="dragstart"||t==="dragstop"||t==="resizestart"||t==="resize"||t==="resizestop"||t==="dropped"||t==="resizecontent"){this._gsEventHandler[t]=i}else{console.error("GridStack.on("+t+") event not supported")}return this}off(t){if(t.indexOf(" ")!==-1){const i=t.split(" ");i.forEach((t=>this.off(t)));return this}if(t==="change"||t==="added"||t==="removed"||t==="enable"||t==="disable"){if(this._gsEventHandler[t]){this.el.removeEventListener(t,this._gsEventHandler[t])}}delete this._gsEventHandler[t];return this}offAll(){Object.keys(this._gsEventHandler).forEach((t=>this.off(t)));return this}removeWidget(t,i=true,e=true){if(!t){console.error("Error: GridStack.removeWidget(undefined) called");return this}C.getElements(t).forEach((t=>{if(t.parentElement&&t.parentElement!==this.el)return;let s=t.gridstackNode;if(!s){s=this.engine.nodes.find((i=>t===i.el))}if(!s)return;if(i&&C.addRemoveCB){C.addRemoveCB(this.el,s,false,false)}delete t.gridstackNode;this._removeDD(t);this.engine.removeNode(s,i,e);if(i&&t.parentElement){t.remove()}}));if(e){this._triggerRemoveEvent();this._triggerChangeEvent()}return this}removeAll(t=true,i=true){this.engine.nodes.forEach((i=>{if(t&&C.addRemoveCB){C.addRemoveCB(this.el,i,false,false)}delete i.el.gridstackNode;if(!this.opts.staticGrid)this._removeDD(i.el)}));this.engine.removeAll(t,i);if(i)this._triggerRemoveEvent();return this}setAnimation(t=this.opts.animate,i){if(i){setTimeout((()=>{if(this.opts)this.setAnimation(t)}))}else if(t){this.el.classList.add("grid-stack-animate")}else{this.el.classList.remove("grid-stack-animate")}this.opts.animate=t;return this}hasAnimationCSS(){return this.el.classList.contains("grid-stack-animate")}setStatic(t,i=true,e=true){if(!!this.opts.staticGrid===t)return this;t?this.opts.staticGrid=true:delete this.opts.staticGrid;this._setupRemoveDrop();this._setupAcceptWidget();this.engine.nodes.forEach((s=>{this.prepareDragDrop(s.el);if(s.subGrid&&e)s.subGrid.setStatic(t,i,e)}));if(i){this._setStaticClass()}return this}updateOptions(t){const i=this.opts;if(t===i)return this;if(t.acceptWidgets!==undefined){i.acceptWidgets=t.acceptWidgets;this._setupAcceptWidget()}if(t.animate!==undefined)this.setAnimation(t.animate);if(t.cellHeight)this.cellHeight(t.cellHeight);if(t.class!==undefined&&t.class!==i.class){if(i.class)this.el.classList.remove(i.class);if(t.class)this.el.classList.add(t.class)}if(t.columnOpts){this.opts.columnOpts=t.columnOpts;this.checkDynamicColumn()}else if(t.columnOpts===null&&this.opts.columnOpts){delete this.opts.columnOpts;this._updateResizeEvent()}else if(typeof t.column==="number")this.column(t.column);if(t.margin!==undefined)this.margin(t.margin);if(t.staticGrid!==undefined)this.setStatic(t.staticGrid);if(t.disableDrag!==undefined&&!t.staticGrid)this.enableMove(!t.disableDrag);if(t.disableResize!==undefined&&!t.staticGrid)this.enableResize(!t.disableResize);if(t.float!==undefined)this.float(t.float);if(t.row!==undefined){i.minRow=i.maxRow=i.row=t.row;this._updateContainerHeight()}else{if(t.minRow!==undefined){i.minRow=t.minRow;this._updateContainerHeight()}if(t.maxRow!==undefined)i.maxRow=t.maxRow}if(t.lazyLoad!==undefined)i.lazyLoad=t.lazyLoad;if(t.children?.length)this.load(t.children);return this}update(t,i){C.getElements(t).forEach((t=>{const e=t?.gridstackNode;if(!e)return;const s={...h.copyPos({},e),...h.cloneDeep(i)};this.engine.nodeBoundFix(s);delete s.autoPosition;const r=["x","y","w","h"];let n;if(r.some((t=>s[t]!==undefined&&s[t]!==e[t]))){n={};r.forEach((t=>{n[t]=s[t]!==undefined?s[t]:e[t];delete s[t]}))}if(!n&&(s.minW||s.minH||s.maxW||s.maxH)){n={}}if(s.content!==undefined){const i=t.querySelector(".grid-stack-item-content");if(i&&i.textContent!==s.content){e.content=s.content;C.renderCB(i,s);if(e.subGrid?.el){i.appendChild(e.subGrid.el);e.subGrid._updateContainerHeight()}}delete s.content}let o=false;let f=false;for(const t in s){if(t[0]!=="_"&&e[t]!==s[t]){e[t]=s[t];o=true;f=f||!this.opts.staticGrid&&(t==="noResize"||t==="noMove"||t==="locked")}}h.sanitizeMinMax(e);if(n){const t=n.w!==undefined&&n.w!==e.w;this.moveNode(e,n);if(t&&e.subGrid){e.subGrid.onResize(this.hasAnimationCSS()?e.w:undefined)}else{this.resizeToContentCheck(t,e)}delete e._orig}if(n||o){this._writeAttr(t,e)}if(f){this.prepareDragDrop(e.el)}if(C.updateCB)C.updateCB(e)}));return this}moveNode(t,i){const e=t._updating;if(!e)this.engine.cleanNodes().beginUpdate(t);this.engine.moveNode(t,i);this._updateContainerHeight();if(!e){this._triggerChangeEvent();this.engine.endUpdate()}}resizeToContent(t){if(!t)return;t.classList.remove("size-to-content-max");if(!t.clientHeight)return;const i=t.gridstackNode;if(!i)return;const e=i.grid;if(!e||t.parentElement!==e.el)return;const s=e.getCellHeight(true);if(!s)return;let h=i.h?i.h*s:t.clientHeight;let r;if(i.resizeToContentParent)r=t.querySelector(i.resizeToContentParent);if(!r)r=t.querySelector(C.resizeToContentParent);if(!r)return;const n=t.clientHeight-r.clientHeight;const o=i.h?i.h*s-n:r.clientHeight;let f;if(i.subGrid){f=i.subGrid.getRow()*i.subGrid.getCellHeight(true);const e=i.subGrid.el.getBoundingClientRect();const s=t.getBoundingClientRect();f+=e.top-s.top}else if(i.subGridOpts?.children?.length){return}else{const t=r.firstElementChild;if(!t){console.error(`Error: GridStack.resizeToContent() widget id:${i.id} '${C.resizeToContentParent}'.firstElementChild is null, make sure to have a div like container. Skipping sizing.`);return}f=t.getBoundingClientRect().height||o}if(o===f)return;h+=f-o;let a=Math.ceil(h/s);const l=Number.isInteger(i.sizeToContent)?i.sizeToContent:0;if(l&&a>l){a=l;t.classList.add("size-to-content-max")}if(i.minH&&a<i.minH)a=i.minH;else if(i.maxH&&a>i.maxH)a=i.maxH;if(a!==i.h){e._ignoreLayoutsNodeChange=true;e.moveNode(i,{h:a});delete e._ignoreLayoutsNodeChange}}resizeToContentCBCheck(t){if(C.resizeToContentCB)C.resizeToContentCB(t);else this.resizeToContent(t)}rotate(t,i){C.getElements(t).forEach((t=>{const e=t.gridstackNode;if(!h.canBeRotated(e))return;const s={w:e.h,h:e.w,minH:e.minW,minW:e.minH,maxH:e.maxW,maxW:e.maxH};if(i){const t=i.left>0?Math.floor(i.left/this.cellWidth()):0;const h=i.top>0?Math.floor(i.top/this.opts.cellHeight):0;s.x=e.x+t-(e.h-(h+1));s.y=e.y+h-t}Object.keys(s).forEach((t=>{if(s[t]===undefined)delete s[t]}));const r=e._orig;this.update(t,s);e._orig=r}));return this}margin(t){const i=typeof t==="string"&&t.split(" ").length>1;if(!i){const i=h.parseHeight(t);if(this.opts.marginUnit===i.unit&&this.opts.margin===i.h)return}this.opts.margin=t;this.opts.marginTop=this.opts.marginBottom=this.opts.marginLeft=this.opts.marginRight=undefined;this._initMargin();return this}getMargin(){return this.opts.margin}willItFit(t){return this.engine.willItFit(t)}_triggerChangeEvent(){if(this.engine.batchMode)return this;const t=this.engine.getDirtyNodes(true);if(t&&t.length){if(!this._ignoreLayoutsNodeChange){this.engine.layoutsNodesChange(t)}this._triggerEvent("change",t)}this.engine.saveInitial();return this}_triggerAddEvent(){if(this.engine.batchMode)return this;if(this.engine.addedNodes?.length){if(!this._ignoreLayoutsNodeChange){this.engine.layoutsNodesChange(this.engine.addedNodes)}this.engine.addedNodes.forEach((t=>{delete t._dirty}));const t=[...this.engine.addedNodes];this.engine.addedNodes=[];this._triggerEvent("added",t)}return this}_triggerRemoveEvent(){if(this.engine.batchMode)return this;if(this.engine.removedNodes?.length){const t=[...this.engine.removedNodes];this.engine.removedNodes=[];this._triggerEvent("removed",t)}return this}_triggerEvent(t,i){const e=i?new CustomEvent(t,{bubbles:false,detail:i}):new Event(t);let s=this;while(s.parentGridNode)s=s.parentGridNode.grid;s.el.dispatchEvent(e);return this}_updateContainerHeight(){if(!this.engine||this.engine.batchMode)return this;const t=this.parentGridNode;let i=this.getRow()+this._extraDragRow;const e=this.opts.cellHeight;const s=this.opts.cellHeightUnit;if(!e)return this;if(!t&&!this.opts.minRow){const t=h.parseHeight(getComputedStyle(this.el)["minHeight"]);if(t.h>0&&t.unit===s){const s=Math.floor(t.h/e);if(i<s){i=s}}}this.el.setAttribute("gs-current-row",String(i));this.el.style.removeProperty("min-height");this.el.style.removeProperty("height");if(i){this.el.style[t?"minHeight":"height"]=i*e+s}if(t&&h.shouldSizeToContent(t)){t.grid.resizeToContentCBCheck(t.el)}return this}_prepareElement(t,i=false,e){e=e||this._readAttr(t);t.gridstackNode=e;e.el=t;e.grid=this;e=this.engine.addNode(e,i);this._writeAttr(t,e);t.classList.add(n.itemClass,this.opts.itemClass);const s=h.shouldSizeToContent(e);s?t.classList.add("size-to-content"):t.classList.remove("size-to-content");if(s)this.resizeToContentCheck(false,e);if(!h.lazyLoad(e))this.prepareDragDrop(e.el);return this}_writePosAttr(t,i){if(!i._moving&&!i._resizing||this._placeholder===t){t.style.top=i.y?i.y===1?`var(--gs-cell-height)`:`calc(${i.y} * var(--gs-cell-height))`:null;t.style.left=i.x?i.x===1?`var(--gs-column-width)`:`calc(${i.x} * var(--gs-column-width))`:null;t.style.width=i.w>1?`calc(${i.w} * var(--gs-column-width))`:null;t.style.height=i.h>1?`calc(${i.h} * var(--gs-cell-height))`:null}t.setAttribute("gs-x",String(i.x));t.setAttribute("gs-y",String(i.y));i.w>1?t.setAttribute("gs-w",String(i.w)):t.removeAttribute("gs-w");i.h>1?t.setAttribute("gs-h",String(i.h)):t.removeAttribute("gs-h");return this}_writeAttr(t,i){if(!i)return this;this._writePosAttr(t,i);const e={noResize:"gs-no-resize",noMove:"gs-no-move",locked:"gs-locked",id:"gs-id",sizeToContent:"gs-size-to-content"};for(const s in e){if(i[s]){t.setAttribute(e[s],String(i[s]))}else{t.removeAttribute(e[s])}}return this}_readAttr(t,i=true){const e={};e.x=h.toNumber(t.getAttribute("gs-x"));e.y=h.toNumber(t.getAttribute("gs-y"));e.w=h.toNumber(t.getAttribute("gs-w"));e.h=h.toNumber(t.getAttribute("gs-h"));e.autoPosition=h.toBool(t.getAttribute("gs-auto-position"));e.noResize=h.toBool(t.getAttribute("gs-no-resize"));e.noMove=h.toBool(t.getAttribute("gs-no-move"));e.locked=h.toBool(t.getAttribute("gs-locked"));const s=t.getAttribute("gs-size-to-content");if(s){if(s==="true"||s==="false")e.sizeToContent=h.toBool(s);else e.sizeToContent=parseInt(s,10)}e.id=t.getAttribute("gs-id");e.maxW=h.toNumber(t.getAttribute("gs-max-w"));e.minW=h.toNumber(t.getAttribute("gs-min-w"));e.maxH=h.toNumber(t.getAttribute("gs-max-h"));e.minH=h.toNumber(t.getAttribute("gs-min-h"));if(i){if(e.w===1)t.removeAttribute("gs-w");if(e.h===1)t.removeAttribute("gs-h");if(e.maxW)t.removeAttribute("gs-max-w");if(e.minW)t.removeAttribute("gs-min-w");if(e.maxH)t.removeAttribute("gs-max-h");if(e.minH)t.removeAttribute("gs-min-h")}for(const t in e){if(!e.hasOwnProperty(t))return;if(!e[t]&&e[t]!==0&&t!=="sizeToContent"){delete e[t]}}return e}_setStaticClass(){const t=["grid-stack-static"];if(this.opts.staticGrid){this.el.classList.add(...t);this.el.setAttribute("gs-static","true")}else{this.el.classList.remove(...t);this.el.removeAttribute("gs-static")}return this}onResize(t=this.el?.clientWidth){if(!t)return;if(this.prevWidth===t)return;this.prevWidth=t;this.batchUpdate();let i=false;if(this._autoColumn&&this.parentGridNode){if(this.opts.column!==this.parentGridNode.w){this.column(this.parentGridNode.w,this.opts.layout||"list");i=true}}else{i=this.checkDynamicColumn()}if(this._isAutoCellHeight)this.cellHeight();this.engine.nodes.forEach((t=>{if(t.subGrid)t.subGrid.onResize()}));if(!this._skipInitialResize)this.resizeToContentCheck(i);delete this._skipInitialResize;this.batchUpdate(false);return this}resizeToContentCheck(t=false,i=undefined){if(!this.engine)return;if(t&&this.hasAnimationCSS())return setTimeout((()=>this.resizeToContentCheck(false,i)),this.animationDelay);if(i){if(h.shouldSizeToContent(i))this.resizeToContentCBCheck(i.el)}else if(this.engine.nodes.some((t=>h.shouldSizeToContent(t)))){const t=[...this.engine.nodes];this.batchUpdate();t.forEach((t=>{if(h.shouldSizeToContent(t))this.resizeToContentCBCheck(t.el)}));this._ignoreLayoutsNodeChange=true;this.batchUpdate(false);this._ignoreLayoutsNodeChange=false}if(this._gsEventHandler["resizecontent"])this._gsEventHandler["resizecontent"](null,i?[i]:this.engine.nodes)}_updateResizeEvent(t=false){const i=!this.parentGridNode&&(this._isAutoCellHeight||this.opts.sizeToContent||this.opts.columnOpts||this.engine.nodes.find((t=>t.sizeToContent)));if(!t&&i&&!this.resizeObserver){this._sizeThrottle=h.throttle((()=>this.onResize()),this.opts.cellHeightThrottle);this.resizeObserver=new ResizeObserver((()=>this._sizeThrottle()));this.resizeObserver.observe(this.el);this._skipInitialResize=true}else if((t||!i)&&this.resizeObserver){this.resizeObserver.disconnect();delete this.resizeObserver;delete this._sizeThrottle}return this}static getElement(t=".grid-stack-item"){return h.getElement(t)}static getElements(t=".grid-stack-item"){return h.getElements(t)}static getGridElement(t){return C.getElement(t)}static getGridElements(t){return h.getElements(t)}_initMargin(){let t;let i=0;let e=[];if(typeof this.opts.margin==="string"){e=this.opts.margin.split(" ")}if(e.length===2){this.opts.marginTop=this.opts.marginBottom=e[0];this.opts.marginLeft=this.opts.marginRight=e[1]}else if(e.length===4){this.opts.marginTop=e[0];this.opts.marginRight=e[1];this.opts.marginBottom=e[2];this.opts.marginLeft=e[3]}else{t=h.parseHeight(this.opts.margin);this.opts.marginUnit=t.unit;i=this.opts.margin=t.h}const s=["marginTop","marginRight","marginBottom","marginLeft"];s.forEach((e=>{if(this.opts[e]===undefined){this.opts[e]=i}else{t=h.parseHeight(this.opts[e]);this.opts[e]=t.h;delete this.opts.margin}}));this.opts.marginUnit=t.unit;if(this.opts.marginTop===this.opts.marginBottom&&this.opts.marginLeft===this.opts.marginRight&&this.opts.marginTop===this.opts.marginRight){this.opts.margin=this.opts.marginTop}const r=this.el.style;r.setProperty("--gs-item-margin-top",`${this.opts.marginTop}${this.opts.marginUnit}`);r.setProperty("--gs-item-margin-bottom",`${this.opts.marginBottom}${this.opts.marginUnit}`);r.setProperty("--gs-item-margin-right",`${this.opts.marginRight}${this.opts.marginUnit}`);r.setProperty("--gs-item-margin-left",`${this.opts.marginLeft}${this.opts.marginUnit}`);return this}static getDD(){return S}static setupDragIn(t,i,e,s=document){if(i?.pause!==undefined){o.pauseDrag=i.pause}i={appendTo:"body",helper:"clone",...i||{}};const r=typeof t==="string"?h.getElements(t,s):t;r.forEach(((t,s)=>{if(!S.isDraggable(t))S.dragIn(t,i);if(e?.[s])t.gridstackNode=e[s]}))}movable(t,i){if(this.opts.staticGrid)return this;C.getElements(t).forEach((t=>{const e=t.gridstackNode;if(!e)return;i?delete e.noMove:e.noMove=true;this.prepareDragDrop(e.el)}));return this}resizable(t,i){if(this.opts.staticGrid)return this;C.getElements(t).forEach((t=>{const e=t.gridstackNode;if(!e)return;i?delete e.noResize:e.noResize=true;this.prepareDragDrop(e.el)}));return this}disable(t=true){if(this.opts.staticGrid)return;this.enableMove(false,t);this.enableResize(false,t);this._triggerEvent("disable");return this}enable(t=true){if(this.opts.staticGrid)return;this.enableMove(true,t);this.enableResize(true,t);this._triggerEvent("enable");return this}enableMove(t,i=true){if(this.opts.staticGrid)return this;t?delete this.opts.disableDrag:this.opts.disableDrag=true;this.engine.nodes.forEach((e=>{this.prepareDragDrop(e.el);if(e.subGrid&&i)e.subGrid.enableMove(t,i)}));return this}enableResize(t,i=true){if(this.opts.staticGrid)return this;t?delete this.opts.disableResize:this.opts.disableResize=true;this.engine.nodes.forEach((e=>{this.prepareDragDrop(e.el);if(e.subGrid&&i)e.subGrid.enableResize(t,i)}));return this}cancelDrag(){const t=this._placeholder?.gridstackNode;if(!t)return;if(t._isExternal){t._isAboutToRemove=true;this.engine.removeNode(t)}else if(t._isAboutToRemove){C._itemRemoving(t.el,false)}this.engine.restoreInitial()}_removeDD(t){S.draggable(t,"destroy").resizable(t,"destroy");if(t.gridstackNode){delete t.gridstackNode._initDD}delete t.ddElement;return this}_setupAcceptWidget(){if(this.opts.staticGrid||!this.opts.acceptWidgets&&!this.opts.removable){S.droppable(this.el,"destroy");return this}let t,i;const e=(e,s,r)=>{r=r||s;const n=r.gridstackNode;if(!n)return;if(!n.grid?.el){r.style.transform=`scale(${1/this.dragTransform.xScale},${1/this.dragTransform.yScale})`;const t=r.getBoundingClientRect();r.style.left=t.x+(this.dragTransform.xScale-1)*(e.clientX-t.x)/this.dragTransform.xScale+"px";r.style.top=t.y+(this.dragTransform.yScale-1)*(e.clientY-t.y)/this.dragTransform.yScale+"px";r.style.transformOrigin=`0px 0px`}let{top:o,left:f}=r.getBoundingClientRect();const a=this.el.getBoundingClientRect();f-=a.left;o-=a.top;const l={position:{top:o*this.dragTransform.xScale,left:f*this.dragTransform.yScale}};if(n._temporaryRemoved){n.x=Math.max(0,Math.round(f/i));n.y=Math.max(0,Math.round(o/t));delete n.autoPosition;this.engine.nodeBoundFix(n);if(!this.engine.willItFit(n)){n.autoPosition=true;if(!this.engine.willItFit(n)){S.off(s,"drag");return}if(n._willFitPos){h.copyPos(n,n._willFitPos);delete n._willFitPos}}this._onStartMoving(r,e,l,n,i,t)}else{this._dragOrResize(r,e,l,n,i,t)}};S.droppable(this.el,{accept:t=>{const i=t.gridstackNode||this._readAttr(t,false);if(i?.grid===this)return true;if(!this.opts.acceptWidgets)return false;let e=true;if(typeof this.opts.acceptWidgets==="function"){e=this.opts.acceptWidgets(t)}else{const i=this.opts.acceptWidgets===true?".grid-stack-item":this.opts.acceptWidgets;e=t.matches(i)}if(e&&i&&this.opts.maxRow){const t={w:i.w,h:i.h,minW:i.minW,minH:i.minH};e=this.engine.willItFit(t)}return e}}).on(this.el,"dropover",((s,h,r)=>{let n=r?.gridstackNode||h.gridstackNode;if(n?.grid===this&&!n._temporaryRemoved){return false}if(n?._sidebarOrig){n.w=n._sidebarOrig.w;n.h=n._sidebarOrig.h}if(n?.grid&&n.grid!==this&&!n._temporaryRemoved){const t=n.grid;t._leave(h,r)}r=r||h;i=this.cellWidth();t=this.getCellHeight(true);if(!n){const t=r.getAttribute("data-gs-widget")||r.getAttribute("gridstacknode");if(t){try{n=JSON.parse(t)}catch(i){console.error("Gridstack dropover: Bad JSON format: ",t)}r.removeAttribute("data-gs-widget");r.removeAttribute("gridstacknode")}if(!n)n=this._readAttr(r);n._sidebarOrig={w:n.w,h:n.h}}if(!n.grid){if(!n.el)n={...n};n._isExternal=true;r.gridstackNode=n}const o=n.w||Math.round(r.offsetWidth/i)||1;const f=n.h||Math.round(r.offsetHeight/t)||1;if(n.grid&&n.grid!==this){if(!h._gridstackNodeOrig)h._gridstackNodeOrig=n;h.gridstackNode=n={...n,w:o,h:f,grid:this};delete n.x;delete n.y;this.engine.cleanupNode(n).nodeBoundFix(n);n._initDD=n._isExternal=n._temporaryRemoved=true}else{n.w=o;n.h=f;n._temporaryRemoved=true}C._itemRemoving(n.el,false);S.on(h,"drag",e);e(s,h,r);return false})).on(this.el,"dropout",((t,i,e)=>{const s=e?.gridstackNode||i.gridstackNode;if(!s)return false;if(!s.grid||s.grid===this){this._leave(i,e);if(this._isTemp){this.removeAsSubGrid(s)}}return false})).on(this.el,"drop",((t,i,e)=>{const s=e?.gridstackNode||i.gridstackNode;if(s?.grid===this&&!s._isExternal)return false;const r=!!this.placeholder.parentElement;const n=i!==e;this.placeholder.remove();delete this.placeholder.gridstackNode;if(r&&this.opts.animate){this.setAnimation(false);this.setAnimation(true,true)}const o=i._gridstackNodeOrig;delete i._gridstackNodeOrig;if(r&&o?.grid&&o.grid!==this){const t=o.grid;t.engine.removeNodeFromLayoutCache(o);t.engine.removedNodes.push(o);t._triggerRemoveEvent()._triggerChangeEvent();if(t.parentGridNode&&!t.engine.nodes.length&&t.opts.subGridDynamic){t.removeAsSubGrid()}}if(!s)return false;if(r){this.engine.cleanupNode(s);s.grid=this}delete s.grid?._isTemp;S.off(i,"drag");if(e!==i){e.remove();i=e}else{i.remove()}this._removeDD(i);if(!r)return false;const f=s.subGrid?.el?.gridstack;h.copyPos(s,this._readAttr(this.placeholder));h.removePositioningStyles(i);if(n&&(s.content||s.subGridOpts||C.addRemoveCB)){delete s.el;i=this.addWidget(s)}else{this._prepareElement(i,true,s);this.el.appendChild(i);this.resizeToContentCheck(false,s);if(f){f.parentGridNode=s}this._updateContainerHeight()}this.engine.addedNodes.push(s);this._triggerAddEvent();this._triggerChangeEvent();this.engine.endUpdate();if(this._gsEventHandler["dropped"]){this._gsEventHandler["dropped"]({...t,type:"dropped"},o&&o.grid?o:undefined,s)}return false}));return this}static _itemRemoving(t,i){if(!t)return;const e=t?t.gridstackNode:undefined;if(!e?.grid||t.classList.contains(e.grid.opts.removableOptions.decline))return;i?e._isAboutToRemove=true:delete e._isAboutToRemove;i?t.classList.add("grid-stack-item-removing"):t.classList.remove("grid-stack-item-removing")}_setupRemoveDrop(){if(typeof this.opts.removable!=="string")return this;const t=document.querySelector(this.opts.removable);if(!t)return this;if(!this.opts.staticGrid&&!S.isDroppable(t)){S.droppable(t,this.opts.removableOptions).on(t,"dropover",((t,i)=>C._itemRemoving(i,true))).on(t,"dropout",((t,i)=>C._itemRemoving(i,false)))}return this}prepareDragDrop(t,i=false){const e=t?.gridstackNode;if(!e)return;const s=e.noMove||this.opts.disableDrag;const r=e.noResize||this.opts.disableResize;const n=this.opts.staticGrid||s&&r;if(i||n){if(e._initDD){this._removeDD(t);delete e._initDD}if(n)t.classList.add("ui-draggable-disabled","ui-resizable-disabled");if(!i)return this}if(!e._initDD){let i;let s;const r=(h,r)=>{this.triggerEvent(h,h.target);i=this.cellWidth();s=this.getCellHeight(true);this._onStartMoving(t,h,r,e,i,s)};const n=(h,r)=>{this._dragOrResize(t,h,r,e,i,s)};const o=i=>{this.placeholder.remove();delete this.placeholder.gridstackNode;delete e._moving;delete e._resizing;delete e._event;delete e._lastTried;const s=e.w!==e._orig.w;const r=i.target;if(!r.gridstackNode||r.gridstackNode.grid!==this)return;e.el=r;if(e._isAboutToRemove){const s=t.gridstackNode.grid;if(s._gsEventHandler[i.type]){s._gsEventHandler[i.type](i,r)}s.engine.nodes.push(e);s.removeWidget(t,true,true)}else{h.removePositioningStyles(r);if(e._temporaryRemoved){this._writePosAttr(r,e);this.engine.addNode(e)}else{this._writePosAttr(r,e)}this.triggerEvent(i,r)}this._extraDragRow=0;this._updateContainerHeight();this._triggerChangeEvent();this.engine.endUpdate();if(i.type==="resizestop"){if(Number.isInteger(e.sizeToContent))e.sizeToContent=e.h;this.resizeToContentCheck(s,e)}};S.draggable(t,{start:r,stop:o,drag:n}).resizable(t,{start:r,stop:o,resize:n});e._initDD=true}S.draggable(t,s?"disable":"enable").resizable(t,r?"disable":"enable");return this}_onStartMoving(t,i,e,s,r,n){this.engine.cleanNodes().beginUpdate(s);this._writePosAttr(this.placeholder,s);this.el.appendChild(this.placeholder);this.placeholder.gridstackNode=s;if(s.grid?.el){this.dragTransform=h.getValuesFromTransformedElement(t)}else if(this.placeholder&&this.placeholder.closest(".grid-stack")){const t=this.placeholder.closest(".grid-stack");this.dragTransform=h.getValuesFromTransformedElement(t)}else{this.dragTransform={xScale:1,xOffset:0,yScale:1,yOffset:0}}s.el=this.placeholder;s._lastUiPosition=e.position;s._prevYPix=e.position.top;s._moving=i.type==="dragstart";s._resizing=i.type==="resizestart";delete s._lastTried;if(i.type==="dropover"&&s._temporaryRemoved){this.engine.addNode(s);s._moving=true}this.engine.cacheRects(r,n,this.opts.marginTop,this.opts.marginRight,this.opts.marginBottom,this.opts.marginLeft);if(i.type==="resizestart"){const i=this.getColumn()-s.x;const e=(this.opts.maxRow||Number.MAX_SAFE_INTEGER)-s.y;S.resizable(t,"option","minWidth",r*Math.min(s.minW||1,i)).resizable(t,"option","minHeight",n*Math.min(s.minH||1,e)).resizable(t,"option","maxWidth",r*Math.min(s.maxW||Number.MAX_SAFE_INTEGER,i)).resizable(t,"option","maxWidthMoveLeft",r*Math.min(s.maxW||Number.MAX_SAFE_INTEGER,s.x+s.w)).resizable(t,"option","maxHeight",n*Math.min(s.maxH||Number.MAX_SAFE_INTEGER,e)).resizable(t,"option","maxHeightMoveUp",n*Math.min(s.maxH||Number.MAX_SAFE_INTEGER,s.y+s.h))}}_dragOrResize(t,i,e,s,r,n){const o={...s._orig};let f;let a=this.opts.marginLeft,l=this.opts.marginRight,u=this.opts.marginTop,d=this.opts.marginBottom;const c=Math.round(n*.1),g=Math.round(r*.1);a=Math.min(a,g);l=Math.min(l,g);u=Math.min(u,c);d=Math.min(d,c);if(i.type==="drag"){if(s._temporaryRemoved)return;const i=e.position.top-s._prevYPix;s._prevYPix=e.position.top;if(this.opts.draggable.scroll!==false){h.updateScrollPosition(t,e.position,i)}const f=e.position.left+(e.position.left>s._lastUiPosition.left?-l:a);const c=e.position.top+(e.position.top>s._lastUiPosition.top?-d:u);o.x=Math.round(f/r);o.y=Math.round(c/n);const g=this._extraDragRow;if(this.engine.collide(s,o)){const t=this.getRow();let i=Math.max(0,o.y+s.h-t);if(this.opts.maxRow&&t+i>this.opts.maxRow){i=Math.max(0,this.opts.maxRow-t)}this._extraDragRow=i}else this._extraDragRow=0;if(this._extraDragRow!==g)this._updateContainerHeight();if(s.x===o.x&&s.y===o.y)return}else if(i.type==="resize"){if(o.x<0)return;h.updateScrollResize(i,t,n);o.w=Math.round((e.size.width-a)/r);o.h=Math.round((e.size.height-u)/n);if(s.w===o.w&&s.h===o.h)return;if(s._lastTried&&s._lastTried.w===o.w&&s._lastTried.h===o.h)return;const l=e.position.left+a;const d=e.position.top+u;o.x=Math.round(l/r);o.y=Math.round(d/n);f=true}s._event=i;s._lastTried=o;const m={x:e.position.left+a,y:e.position.top+u,w:(e.size?e.size.width:s.w*r)-a-l,h:(e.size?e.size.height:s.h*n)-u-d};if(this.engine.moveNodeCheck(s,{...o,cellWidth:r,cellHeight:n,rect:m,resizing:f})){s._lastUiPosition=e.position;this.engine.cacheRects(r,n,u,l,d,a);delete s._skipDown;if(f&&s.subGrid)s.subGrid.onResize();this._extraDragRow=0;this._updateContainerHeight();const t=i.target;if(!s._sidebarOrig){this._writePosAttr(t,s)}this.triggerEvent(i,t)}}triggerEvent(t,i){let e=this;while(e.parentGridNode)e=e.parentGridNode.grid;if(e._gsEventHandler[t.type]){e._gsEventHandler[t.type](t,i)}}_leave(t,i){i=i||t;const e=i.gridstackNode;if(!e)return;i.style.transform=i.style.transformOrigin=null;S.off(t,"drag");if(e._temporaryRemoved)return;e._temporaryRemoved=true;this.engine.removeNode(e);e.el=e._isExternal&&i?i:t;const s=e._sidebarOrig;if(e._isExternal)this.engine.cleanupNode(e);e._sidebarOrig=s;if(this.opts.removable===true){C._itemRemoving(t,true)}if(t._gridstackNodeOrig){t.gridstackNode=t._gridstackNodeOrig;delete t._gridstackNodeOrig}else if(e._isExternal){this.engine.restoreInitial()}}}C.renderCB=(t,i)=>{if(t&&i?.content)t.textContent=i.content};C.resizeToContentParent=".grid-stack-item-content";C.Utils=h;C.Engine=r;C.GDRev="12.4.1";const N='.grid-stack{position:relative}.grid-stack-rtl{direction:ltr}.grid-stack-rtl>.grid-stack-item{direction:rtl}.grid-stack-placeholder>.placeholder-content{background-color:rgba(0,0,0,.1);margin:0;position:absolute;width:auto;z-index:0!important}.grid-stack>.grid-stack-item{position:absolute;padding:0;top:0;left:0;width:var(--gs-column-width);height:var(--gs-cell-height)}.grid-stack>.grid-stack-item>.grid-stack-item-content{margin:0;position:absolute;width:auto;overflow-x:hidden;overflow-y:auto}.grid-stack>.grid-stack-item.size-to-content:not(.size-to-content-max)>.grid-stack-item-content{overflow-y:hidden}.grid-stack>.grid-stack-item>.grid-stack-item-content,.grid-stack>.grid-stack-placeholder>.placeholder-content{top:var(--gs-item-margin-top);right:var(--gs-item-margin-right);bottom:var(--gs-item-margin-bottom);left:var(--gs-item-margin-left)}.grid-stack-item>.ui-resizable-handle{position:absolute;font-size:.1px;display:block;-ms-touch-action:none;touch-action:none}.grid-stack-item.ui-resizable-autohide>.ui-resizable-handle,.grid-stack-item.ui-resizable-disabled>.ui-resizable-handle{display:none}.grid-stack-item>.ui-resizable-ne,.grid-stack-item>.ui-resizable-nw,.grid-stack-item>.ui-resizable-se,.grid-stack-item>.ui-resizable-sw{background-image:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="%23666" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 20 20"><path d="m10 3 2 2H8l2-2v14l-2-2h4l-2 2"/></svg>\');background-repeat:no-repeat;background-position:center}.grid-stack-item>.ui-resizable-ne{transform:rotate(45deg)}.grid-stack-item>.ui-resizable-sw{transform:rotate(45deg)}.grid-stack-item>.ui-resizable-nw{transform:rotate(-45deg)}.grid-stack-item>.ui-resizable-se{transform:rotate(-45deg)}.grid-stack-item>.ui-resizable-nw{cursor:nw-resize;width:20px;height:20px;top:var(--gs-item-margin-top);left:var(--gs-item-margin-left)}.grid-stack-item>.ui-resizable-n{cursor:n-resize;height:10px;top:var(--gs-item-margin-top);left:25px;right:25px}.grid-stack-item>.ui-resizable-ne{cursor:ne-resize;width:20px;height:20px;top:var(--gs-item-margin-top);right:var(--gs-item-margin-right)}.grid-stack-item>.ui-resizable-e{cursor:e-resize;width:10px;top:15px;bottom:15px;right:var(--gs-item-margin-right)}.grid-stack-item>.ui-resizable-se{cursor:se-resize;width:20px;height:20px;bottom:var(--gs-item-margin-bottom);right:var(--gs-item-margin-right)}.grid-stack-item>.ui-resizable-s{cursor:s-resize;height:10px;left:25px;bottom:var(--gs-item-margin-bottom);right:25px}.grid-stack-item>.ui-resizable-sw{cursor:sw-resize;width:20px;height:20px;bottom:var(--gs-item-margin-bottom);left:var(--gs-item-margin-left)}.grid-stack-item>.ui-resizable-w{cursor:w-resize;width:10px;top:15px;bottom:15px;left:var(--gs-item-margin-left)}.grid-stack-item.ui-draggable-dragging>.ui-resizable-handle{display:none!important}.grid-stack-item.ui-draggable-dragging{will-change:left,top}.grid-stack-item.ui-resizable-resizing{will-change:width,height}.ui-draggable-dragging,.ui-resizable-resizing{z-index:10000}.ui-draggable-dragging>.grid-stack-item-content,.ui-resizable-resizing>.grid-stack-item-content{box-shadow:1px 4px 6px rgba(0,0,0,.2);opacity:.8}.grid-stack-animate,.grid-stack-animate .grid-stack-item{transition:left .3s,top .3s,height .3s,width .3s}.grid-stack-animate .grid-stack-item.grid-stack-placeholder,.grid-stack-animate .grid-stack-item.ui-draggable-dragging,.grid-stack-animate .grid-stack-item.ui-resizable-resizing{transition:left 0s,top 0s,height 0s,width 0s}.grid-stack>.grid-stack-item[gs-y="0"]{top:0}.grid-stack>.grid-stack-item[gs-x="0"]{left:0}';const E=class{constructor(e){t(this,e);this.changedItem=i(this,"changedItem",7);this.removedItem=i(this,"removedItem",7);this.resizeEvent=i(this,"resizeEvent",7)}get el(){return e(this)}widget_templates=[];changedItem;removedItem;resizeEvent;widgetTemplatesChanged(){this.needsLayout=true}grid;gridContainerRef;needsLayout=false;componentWillLoad(){this.injectStyle()}componentDidLoad(){if(!this.gridContainerRef)return;this.grid=C.init({margin:4,minRow:1,maxRow:100,float:true,columnOpts:{columnMax:16,breakpoints:[{w:768,c:1}]}},this.gridContainerRef);this.grid.on("change",((t,i)=>{i?.forEach((t=>{const i=this.widget_templates.find((i=>i.id===t.id));if(i){Object.assign(i,{x:t.x,y:t.y,w:t.w,h:t.h});this.changedItem.emit(i)}}))}));this.grid.on("resizestop",((t,i)=>{const e=i.gridstackNode;this.resizeEvent.emit(e)}))}componentDidRender(){if(!this.grid||!this.needsLayout)return;this.grid.removeAll(false);this.layoutWidgets();this.needsLayout=false}disconnectedCallback(){this.grid?.destroy(false)}layoutWidgets(){if(!this.grid)return;this.widget_templates.forEach((t=>this.makeWidget(t)))}makeWidget(t){const i=`#${t.id}`;const e={id:t.id,x:t.x,y:t.y,w:t.w,h:t.h};this.grid.makeWidget(i,e)}removeWidget(t){this.removedItem.emit(t)}injectStyle(){const t=document.createElement("style");t.textContent=N;this.el.appendChild(t)}render(){return s("div",{key:"2d9b8af743ee0fba8932dba5525322002303c23b",class:"grid-stack",ref:t=>this.gridContainerRef=t},this.widget_templates.map((t=>s("div",{class:"grid-stack-item",id:t.id},s("div",{class:"grid-stack-item-content"},s("div",{class:"absolute top-0 right-0"},s("at-menu",null,s("at-button",{slot:"menu-trigger",icon:"more_vert",type:"secondaryText"}),s("at-button",{label:"Delete",type:"secondaryText",onAtuiClick:()=>{this.removeWidget(t)}}))),s("slot",{name:t.id}))))))}static get watchers(){return{widget_templates:["widgetTemplatesChanged"]}}};export{E as at_dashboard};
//# sourceMappingURL=p-6f9cd9e9.entry.js.map