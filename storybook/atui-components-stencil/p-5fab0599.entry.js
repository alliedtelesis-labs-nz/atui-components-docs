import{r as t,c as i,h as e,H as s,g as a}from"./p-BvDeEv6o.js";import{a as n,T as o,M as h,D as l,b as r}from"./p-CtdB9iYt.js";import"./p-3wjBk_6c.js";import{h as c}from"./p-BMuAbjcg.js";import{f as d}from"./p-DuLooPsr.js";var u;(function(t){t["SECONDS"]="s";t["MINUTES"]="min";t["HOURS"]="hr";t["DAYS"]="d";t["WEEKS"]="w";t["MONTHS"]="m";t["YEARS"]="yr"})(u||(u={}));var f;(function(t){t["SECONDS"]="SECONDS";t["MINUTES"]="MINUTES";t["HOURS"]="HOURS";t["DAYS"]="DAYS";t["WEEKS"]="WEEKS";t["MONTHS"]="MONTHS";t["YEARS"]="YEARS"})(f||(f={}));const m=class{constructor(e){t(this,e);this.atuiChange=i(this,"atuiChange",7);this.selected_time_range={selected:{unit:n.HOURS,value:1}};this.range_limit=7;this.enable_relative_time=true;this.custom_error_message=null;this.show_all_time=false;this.enable_range_limit=true;this.units=[n.MINUTES,n.HOURS,n.DAYS,n.WEEKS,n.MONTHS,n.YEARS];this.minSeconds=300}async componentWillLoad(){this.translations=await d(this.el);this.today=new Date}componentWillRender(){this.lowerLimit=this.enable_range_limit?c().subtract(this.range_limit,"day").toDate():o.floorDateByTimeUnit(h,l.HOURS);this.defaultFromDate=c(this.today).subtract(1,"hours").toDate()}getLongUnitDisplay(t){if(t.custom||!t.selected){return}return f[t.selected["unit"]]}getRelativeDate(t){if(t.custom||!t.selected){return}return o.getRelativeDateRange(t.selected)}getCustomStartAndEndDate(t){if(!t.custom){return}const{from:i,to:e}=t.custom;const s=c(i).toDate();const a=c(e).toDate();return{fromDate:s,toDate:a}}getShortUnitDisplay(t){return u[t.unit]}onChangeCustomTime(t){this.selected_time_range={selected:r.CUSTOM,custom:t};this.atuiChange.emit(Object.assign({},this.selected_time_range))}onChangeRelativeTime(t){this.selected_time_range={selected:t};this.atuiChange.emit(Object.assign({},this.selected_time_range))}get buttonGroupOptions(){var t,i;const s=[];if(this.selected_time_range.selected===r.ALL){s.push({value:e("div",{class:"flex items-center gap-4 font-normal text-dark"},e("span",{class:"font-medium"},this.translations.ATUI.TIME.ALL_TIME_LABEL))})}else if(this.selected_time_range.custom){s.push({value:[e("div",{class:"flex items-center gap-4 font-normal text-dark"},e("span",null,(t=this.getCustomStartAndEndDate(this.selected_time_range))===null||t===void 0?void 0:t.fromDate.toLocaleString()),e("span",{class:"icon-md material-icons text-light"},"arrow_forward"),e("span",null,this.selected_time_range.custom.lockEndDateToNow?"NOW":(i=this.getCustomStartAndEndDate(this.selected_time_range))===null||i===void 0?void 0:i.toDate.toLocaleString()))]})}else{s.push({value:e("div",{class:"flex items-center gap-4 font-normal text-dark"},e("span",{class:"font-medium"},this.translations.ATUI.TIME.LAST,` `,this.selected_time_range.selected["value"],` `,this.translations.ATUI.TIME[this.getLongUnitDisplay(this.selected_time_range)]," ",":"),e("span",null,this.getRelativeDate(this.selected_time_range).startDate.toLocaleString()),e("span",{class:"icon-md material-icons text-light"},"arrow_forward"),e("span",null,"NOW"))})}s.push({value:e("div",{class:"flex items-center"},e("span",{class:"icon-md material-icons text-light"},"date_range"))});return s}get predefinedTimeRanges(){const t=[];this.presets.forEach((i=>{t.push({value:e("span",null,i.value,this.getShortUnitDisplay(i))})}));t.push({value:e("div",{class:"flex items-center"},e("span",{class:"material-icons text-body text-light"},"date_range"))});return t}render(){var t,i,a;return e(s,{key:"76db95cfb7ceff52ce16ec1db94eee77c7c26d6e",class:"relative flex justify-center gap-8"},this.enable_relative_time&&e("atui-button-group",{key:"ad2c79667f6cf58e66d24b69d332b374727ec99d",options:this.buttonGroupOptions,onAtuiIndexChange:t=>t.detail===0&&this.relativeTimeMenuEl.focus()||t.detail===1&&this.absoluteTimeMenuEl.focus()}),!this.enable_relative_time&&e("atui-button-group",{key:"a634bf94e71bbd3dd1e6b80708203573e2c36fab",options:this.predefinedTimeRanges,onAtuiIndexChange:t=>{if(t.detail<this.presets.length){this.onChangeRelativeTime(this.presets[t.detail])}else if(t.detail===this.predefinedTimeRanges.length-1){this.absoluteTimeMenuEl.focus()}}}),e("div",{key:"7aa694ec1203dab14724d4fd42575777a1ce5617",ref:t=>this.relativeTimeMenuEl=t,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:t=>t.stopPropagation()},e("atui-time-with-unit",{key:"f438e5384a6e3080a38c6a8f363303f91bd2cf27",units:this.units,common_options:this.presets,min_date:this.lowerLimit,min_seconds:this.minSeconds,initial_selected_time:this.selected_time_range.selected===r.CUSTOM?r.ALL:this.selected_time_range.selected,custom_error_message:this.custom_error_message,show_all_time:this.show_all_time,onAtuiSubmit:t=>this.onChangeRelativeTime(t.detail),onAtuiCancel:()=>{this.relativeTimeMenuEl.focus();this.relativeTimeMenuEl.blur()}})),e("div",{key:"d0220996a4cc8e24f19e5adc88c9f91d460e20d5",ref:t=>this.absoluteTimeMenuEl=t,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:t=>t.stopPropagation()},e("atui-custom-time-range",{key:"9bcef8a9bfb3b6e0b26a5483ffccfc3e472402b4",min_date:this.lowerLimit,default_to_date:this.today,default_from_date:this.defaultFromDate,from_date_value:(t=this.getCustomStartAndEndDate(this.selected_time_range))===null||t===void 0?void 0:t.fromDate,to_date_value:(i=this.getCustomStartAndEndDate(this.selected_time_range))===null||i===void 0?void 0:i.toDate,lock_end_date_to_now:(a=this.selected_time_range.custom)===null||a===void 0?void 0:a.lockEndDateToNow,onAtuiSubmit:t=>this.onChangeCustomTime(t.detail),onAtuiCancel:()=>{this.absoluteTimeMenuEl.focus();this.absoluteTimeMenuEl.blur()}})))}get el(){return a(this)}};export{m as atui_time_range};
//# sourceMappingURL=p-5fab0599.entry.js.map