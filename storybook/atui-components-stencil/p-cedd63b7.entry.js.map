{"version":3,"names":["inputVariants","cva","variants","disabled","false","true","readonly","invalid","typeahead","defaultVariants","optionVariants","active","AtuiMultiSelectComponent","constructor","hostRef","this","label","hint_text","error_text","info_text","placeholder","value","searchText","isOpen","hasMatchingOptions","parentWidth","menuId","Math","random","toString","substring","componentWillLoad","translations","fetchTranslations","el","componentDidLoad","parentRect","getBoundingClientRect","width","updateIsOpenState","event","detail","handleChange","option","includes","filter","item","inputEl","atuiChange","emit","handleClear","handleKeyDownMenu","key","preventDefault","menuRef","closeMenu","_a","triggerEl","focus","target","HTMLLIElement","click","menuContainer","querySelector","handleArrowNavigation","handleHomeEndNavigation","render","h","Host","class","onFocusout","async","relatedTarget","contains","closest","setTimeout","renderLabel","ref","trigger","align","role","portal","autoclose","onAtuiMenuStateChange","renderInput","renderOptions","name","required","for","classname","slot","tabindex","onClick","e","stopPropagation","size","show_clear_all","onAtuiRemoveChip","chips","length","id","onKeyDown","type","clearable","onInput","toLowerCase","trimmedSearch","trim","options","some","icon","map","renderOption","_c","_b","ATUI","NO_RESULTS_FOUND","tabIndex"],"sources":["src/components/atui-multi-select/atui-multi-select.tsx"],"sourcesContent":["import {\n    Component,\n    h,\n    Prop,\n    State,\n    Element,\n    Event,\n    EventEmitter,\n    Host,\n} from '@stencil/core';\nimport { fetchTranslations } from '../../utils/translation';\nimport { cva } from 'class-variance-authority';\nimport { SelectOption } from '../../types/select';\nimport {\n    handleArrowNavigation,\n    handleHomeEndNavigation,\n} from '../../utils/keyboard-navigation';\n\nconst inputVariants = cva(\n    'min-h-36 placeholder-text-light relative flex min-h-[36px] w-full flex-shrink flex-grow basis-0 gap-4 rounded-md border border-solid py-4 pl-8 pr-24 outline-none transition-colors duration-300 ease-in-out focus-within:outline-0 focus-within:ring-2',\n    {\n        variants: {\n            disabled: {\n                false: 'bg-white focus-within:ring-active-foreground/30',\n                true: 'pointer-events-none border-none bg-surface-1 !text-disabled',\n            },\n            readonly: {\n                false: 'focus-within:ring-active-foreground/30',\n                true: 'cursor-text border-none !bg-surface-1 !text-dark',\n            },\n            invalid: {\n                false: 'border-med focus-within:border-active-dark focus-within:ring-active-foreground/30',\n                true: 'border-error-base focus-within:border-error-base focus-within:ring-destructive-foreground/30',\n            },\n            typeahead: {\n                false: 'cursor-pointer caret-transparent',\n                true: null,\n            },\n        },\n        defaultVariants: {\n            disabled: false,\n            readonly: false,\n            invalid: false,\n            typeahead: false,\n        },\n    },\n);\n\nconst optionVariants = cva(\n    'transition[background-color,color,box-shadow] flex w-full cursor-pointer items-center truncate p-8 text-body font-normal duration-300 ease-in-out focus:outline-0 focus:ring-2 focus:ring-inset focus:ring-active-foreground/40',\n    {\n        variants: {\n            active: {\n                true: 'bg-active-light text-active',\n                false: 'bg-white hover:bg-disabled-light',\n            },\n        },\n    },\n);\n\n/**\n * @category Form Controls\n * @description A multi-selection dropdown component for choosing multiple values from a list of options. Features search functionality, keyboard navigation, and accessibility support.\n */\n@Component({\n    tag: 'atui-multi-select',\n    shadow: false,\n})\nexport class AtuiMultiSelectComponent {\n    /**\n     * Options displayed in the dropdown menu.\n     */\n    @Prop()\n    options: SelectOption[];\n\n    /**\n     * Label of the select.\n     */\n    @Prop()\n    label?: string = '';\n\n    /**\n     * Short description or validation hint if required.\n     */\n    @Prop()\n    hint_text?: string = '';\n\n    /**\n     * Error text for the select.\n     */\n    @Prop()\n    error_text?: string = '';\n\n    /**\n     * Optional info icon with detailed tooltip description. Displayed at right of label.\n     */\n    @Prop()\n    info_text?: string = '';\n\n    /**\n     * Placeholder text for the select.\n     */\n    @Prop()\n    placeholder?: string = '';\n\n    /**\n     * Indicated form field is required.\n     */\n    @Prop()\n    required?: boolean;\n\n    /**\n     * Set the select to appear invalid.\n     */\n    @Prop()\n    invalid?: boolean;\n\n    /**\n     * Set the select to be clearable.\n     */\n    @Prop()\n    clearable?: boolean;\n\n    /**\n     * Disable user interaction. Disabled state should be applied via form control.\n     */\n    @Prop()\n    disabled?: boolean;\n\n    /**\n     * Set input to readonly mode, allows users to select any active values.\n     */\n    @Prop()\n    readonly?: boolean;\n\n    /**\n     * Set the select to enable typeahead search.\n     */\n    @Prop()\n    typeahead?: boolean;\n\n    /**\n     * The selected items\n     */\n    @Prop({ mutable: true })\n    value: string[] = [];\n\n    @State() searchText: string = '';\n    @State() isOpen: boolean = false;\n    @State() translations: any;\n    @State() hasMatchingOptions: boolean = false;\n    @State() parentWidth: string = '';\n\n    @Element() el: HTMLElement;\n    private inputEl!: HTMLInputElement;\n    private menuId = `dropdown-${Math.random().toString(36).substring(2, 11)}`;\n    private menuRef: HTMLAtuiMenuElement;\n    private triggerEl: HTMLElement;\n\n    /**\n     * Emits an event containing a list of the selected items when the selection changes.\n     */\n    @Event()\n    atuiChange: EventEmitter<string[]>;\n\n    async componentWillLoad(): Promise<void> {\n        this.translations = await fetchTranslations(this.el);\n    }\n\n    componentDidLoad() {\n        const parentRect = this.el.getBoundingClientRect();\n        this.parentWidth = `${parentRect.width}px`;\n    }\n\n    private updateIsOpenState(event: CustomEvent<boolean>): void {\n        this.isOpen = event.detail;\n    }\n\n    private handleChange(option: string) {\n        this.value = this.value.includes(option)\n            ? this.value.filter((item) => item !== option)\n            : [...this.value, option];\n        this.inputEl.value = '';\n        this.searchText = '';\n        this.atuiChange.emit(this.value);\n    }\n\n    handleClear() {\n        this.searchText = '';\n    }\n\n    private async handleKeyDownMenu(event: KeyboardEvent): Promise<void> {\n        if (event.key === 'Escape') {\n            event.preventDefault();\n            await this.menuRef.closeMenu();\n            this.triggerEl?.focus();\n            return;\n        }\n\n        if (event.key === 'Enter' || event.key === ' ') {\n            if (event.target instanceof HTMLLIElement) {\n                event.preventDefault();\n                event.target.click();\n            }\n            return;\n        }\n\n        if (event.key === 'Tab') {\n            return;\n        }\n\n        const menuContainer = this.el.querySelector(\n            `ul[id=\"${this.menuId}\"]`,\n        ) as HTMLElement;\n        if (!menuContainer) return;\n\n        handleArrowNavigation(event, menuContainer);\n        handleHomeEndNavigation(event, menuContainer);\n    }\n\n    render() {\n        return (\n            <Host\n                class=\"group/select\"\n                onFocusout={async (event: FocusEvent) => {\n                    const relatedTarget = event.relatedTarget as HTMLElement;\n                    if (\n                        !relatedTarget ||\n                        (!this.el.contains(relatedTarget) &&\n                            !relatedTarget.closest('[data-atui-menu-portal]'))\n                    ) {\n                        this.handleClear();\n                        setTimeout(async () => {\n                            await this.menuRef?.closeMenu();\n                        }, 100);\n                    }\n                }}\n            >\n                {this.renderLabel()}\n                <atui-menu\n                    ref={(el) => (this.menuRef = el)}\n                    trigger=\"click\"\n                    align=\"start\"\n                    role=\"listbox\"\n                    width={this.parentWidth}\n                    portal={true}\n                    autoclose={false}\n                    disabled={this.disabled || this.readonly}\n                    onAtuiMenuStateChange={(event) =>\n                        this.updateIsOpenState(event)\n                    }\n                >\n                    {this.renderInput()}\n                    {!this.disabled || !this.readonly\n                        ? this.renderOptions()\n                        : null}\n                </atui-menu>\n\n                <div>\n                    {this.error_text && this.invalid && (\n                        <span\n                            data-name=\"multi-select-error\"\n                            class=\"text-error\"\n                        >\n                            {this.error_text}\n                        </span>\n                    )}\n                </div>\n            </Host>\n        );\n    }\n\n    renderLabel() {\n        return (\n            <div class=\"mb-4 flex flex-col\">\n                <slot name=\"label\" />\n                {(this.label || this.required || this.info_text) && (\n                    <atui-form-label\n                        for={this.menuId}\n                        label={this.label}\n                        required={this.required && !this.readonly}\n                        info_text={this.info_text}\n                    />\n                )}\n                {this.hint_text && (\n                    <span\n                        class=\"text-xs leading-tight text-med\"\n                        data-name=\"multi-select-hint\"\n                    >\n                        {this.hint_text}\n                    </span>\n                )}\n            </div>\n        );\n    }\n\n    renderInput() {\n        const classname = inputVariants({\n            invalid: this.invalid,\n            disabled: this.disabled,\n            readonly: this.readonly,\n            typeahead: this.typeahead,\n        });\n\n        return (\n            <div\n                class={classname}\n                slot=\"menu-trigger\"\n                tabindex={0}\n                ref={(el) => (this.triggerEl = el)}\n            >\n                <div onClick={(e) => e.stopPropagation()}>\n                    <atui-chip-list\n                        size=\"sm\"\n                        class=\"w-full focus-within:ring-0\"\n                        readonly={this.readonly}\n                        disabled={this.disabled}\n                        show_clear_all={false}\n                        onAtuiRemoveChip={(event) => {\n                            this.value = this.value.filter(\n                                (item) => !event.detail.includes(item),\n                            );\n                            this.atuiChange.emit(this.value);\n                        }}\n                        chips={this.value}\n                        data-name=\"multi-select-chips-inside\"\n                    >\n                        {this.value.length === 0 && (\n                            <div class=\"text-body text-light\">\n                                {this.placeholder}\n                            </div>\n                        )}\n                    </atui-chip-list>\n                </div>\n\n                {!this.readonly && !this.disabled && (\n                    <div class=\"absolute right-4 flex items-center\">\n                        <div\n                            class=\"user-select-none pointer-events-none flex h-full items-center bg-transparent p-4 text-foreground\"\n                            role=\"presentation\"\n                            tabindex={-1}\n                        >\n                            <span\n                                class=\"material-icons h-16 w-16 text-[16px] leading-[16px]\"\n                                data-name=\"button-icon-right\"\n                            >\n                                {this.isOpen\n                                    ? 'arrow_drop_up'\n                                    : 'arrow_drop_down'}\n                            </span>\n                        </div>\n                    </div>\n                )}\n            </div>\n        );\n    }\n\n    renderOptions() {\n        return (\n            <ul\n                id={this.menuId}\n                role=\"listbox\"\n                class=\"contents\"\n                slot=\"menu-content\"\n                onKeyDown={async (event) => {\n                    await this.handleKeyDownMenu(event);\n                }}\n            >\n                {this.typeahead && (\n                    <div class=\"relative z-10 bg-white p-4\">\n                        <input\n                            type=\"text\"\n                            class={`transition[background-color,color] mb-4 h-24 w-full flex-shrink flex-grow basis-0 rounded-md bg-surface-1 p-8 outline-0 ring-active-foreground/30 duration-300 ease-in-out focus:ring-2 ${\n                                this.clearable ? 'pr-24' : ''\n                            } `}\n                            placeholder=\"Search...\"\n                            value={this.searchText}\n                            onInput={(event) => {\n                                this.searchText = (\n                                    event.target as HTMLInputElement\n                                ).value.toLowerCase();\n                                const trimmedSearch = this.searchText\n                                    .trim()\n                                    .toLowerCase();\n                                this.hasMatchingOptions = trimmedSearch\n                                    ? this.options?.some((option) =>\n                                          option.value\n                                              .toLowerCase()\n                                              .includes(trimmedSearch),\n                                      )\n                                    : true;\n                            }}\n                            onClick={(e) => e.stopPropagation()}\n                            ref={(el) => (this.inputEl = el)}\n                        />\n\n                        {this.clearable && this.searchText !== '' && (\n                            <div class=\"absolute right-4 top-4\">\n                                <atui-button\n                                    size=\"sm\"\n                                    icon=\"cancel\"\n                                    type=\"secondaryText\"\n                                    onClick={(event) => {\n                                        event.stopPropagation();\n                                        this.searchText = '';\n                                        this.inputEl.value = '';\n                                    }}\n                                    data-name=\"multi-select-search-clear\"\n                                ></atui-button>\n                            </div>\n                        )}\n                    </div>\n                )}\n\n                {this.options\n                    ?.filter(\n                        (option) =>\n                            !this.searchText ||\n                            option.value\n                                .toLowerCase()\n                                .includes(this.searchText),\n                    )\n                    .map((option) => this.renderOption(option))}\n\n                {this.typeahead &&\n                    this.searchText &&\n                    !this.hasMatchingOptions && (\n                        <div class=\"w-full bg-white px-16 py-8 text-body text-light\">\n                            {this.translations?.ATUI?.NO_RESULTS_FOUND ||\n                                'No results found'}\n                        </div>\n                    )}\n            </ul>\n        );\n    }\n\n    renderOption(option: SelectOption) {\n        const classname = optionVariants({\n            active: this.value.includes(option.value),\n        });\n\n        return (\n            <li\n                role=\"option\"\n                data-name=\"multi-select-option\"\n                aria-selected={this.value.includes(option.value)}\n                tabIndex={0}\n                class={classname}\n                onClick={() => this.handleChange(option.value)}\n            >\n                {option.value}\n            </li>\n        );\n    }\n}\n"],"mappings":"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","ignoreList":[]}