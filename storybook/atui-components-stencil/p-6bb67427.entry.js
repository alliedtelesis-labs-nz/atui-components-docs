import{r as t,c as e,g as i,h as s,H as a}from"./p-jvbUuQtg.js";import{a as n,T as o,D as h}from"./p-B3Y_DZ8s.js";import r from"moment";import{f as l}from"./p-DuLooPsr.js";import{M as c,T as d}from"./p-C3LwY5aR.js";var u,m;!function(t){t.SECONDS="s",t.MINUTES="min",t.HOURS="hr",t.DAYS="d",t.WEEKS="w",t.MONTHS="m",t.YEARS="yr"}(u||(u={})),function(t){t.SECONDS="SECONDS",t.MINUTES="MINUTES",t.HOURS="HOURS",t.DAYS="DAYS",t.WEEKS="WEEKS",t.MONTHS="MONTHS",t.YEARS="YEARS"}(m||(m={}));const f=class{constructor(i){t(this,i),this.atuiChange=e(this,"atuiChange",7)}selected_time_range={selected:{unit:n.HOURS,value:1}};range_limit=7;presets;enable_relative_time=!0;custom_error_message=null;show_all_time=!1;enable_range_limit=!0;today;lowerLimit;defaultFromDate;translations;relativeTimeMenuEl;absoluteTimeMenuEl;get el(){return i(this)}units=[n.MINUTES,n.HOURS,n.DAYS,n.WEEKS,n.MONTHS,n.YEARS];minSeconds=300;async componentWillLoad(){this.translations=await l(this.el),this.today=new Date}componentWillRender(){this.lowerLimit=this.enable_range_limit?r().subtract(this.range_limit,"day").toDate():o.floorDateByTimeUnit(c,h.HOURS),this.defaultFromDate=r(this.today).subtract(1,"hours").toDate()}getLongUnitDisplay(t){if(!t.custom&&t.selected)return m[t.selected.unit]}getRelativeDate(t){if(!t.custom&&t.selected)return o.getRelativeDateRange(t.selected)}getCustomStartAndEndDate(t){if(!t.custom)return;const{from:e,to:i}=t.custom;return{fromDate:r(e).toDate(),toDate:r(i).toDate()}}getShortUnitDisplay(t){return u[t.unit]}atuiChange;onChangeCustomTime(t){this.selected_time_range={selected:d.CUSTOM,custom:t},this.atuiChange.emit({...this.selected_time_range})}onChangeRelativeTime(t){this.selected_time_range={selected:t},this.atuiChange.emit({...this.selected_time_range})}get buttonGroupOptions(){const t=[];return t.push(this.selected_time_range.selected===d.ALL?{value:s("div",{class:"text-dark flex items-center gap-4 font-normal"},s("span",{class:"font-medium"},this.translations.ATUI.TIME.ALL_TIME_LABEL))}:this.selected_time_range.custom?{value:[s("div",{class:"text-dark flex items-center gap-4 font-normal"},s("span",null,this.getCustomStartAndEndDate(this.selected_time_range)?.fromDate.toLocaleString()),s("span",{class:"icon-md material-icons text-light"},"arrow_forward"),s("span",null,this.selected_time_range.custom.lockEndDateToNow?"NOW":this.getCustomStartAndEndDate(this.selected_time_range)?.toDate.toLocaleString()))]}:{value:s("div",{class:"text-dark flex items-center gap-4 font-normal"},s("span",{class:"font-medium"},this.translations.ATUI.TIME.LAST," ",this.selected_time_range.selected.value," ",this.translations.ATUI.TIME[this.getLongUnitDisplay(this.selected_time_range)]," ",":"),s("span",null,this.getRelativeDate(this.selected_time_range).startDate.toLocaleString()),s("span",{class:"icon-md material-icons text-light"},"arrow_forward"),s("span",null,"NOW"))}),t.push({value:s("div",{class:"flex items-center"},s("span",{class:"icon-md material-icons text-light"},"date_range"))}),t}get predefinedTimeRanges(){const t=[];return this.presets.forEach((e=>{t.push({value:s("span",null,e.value,this.getShortUnitDisplay(e))})})),t.push({value:s("div",{class:"flex items-center"},s("span",{class:"material-icons text-body text-light"},"date_range"))}),t}render(){return s(a,{key:"6e119672a79f74a6d5bfe3a068af763ff1ad747d",class:"relative flex justify-center gap-8"},this.enable_relative_time&&s("at-button-group",{key:"ec6693b3c05deb0899286404bc81a8d4c99dcb8a",options:this.buttonGroupOptions,onAtuiIndexChange:t=>0===t.detail&&this.relativeTimeMenuEl.focus()||1===t.detail&&this.absoluteTimeMenuEl.focus()}),!this.enable_relative_time&&s("at-button-group",{key:"3a33e400d0454c5a38526c9070ed6b8dfd29ab8b",options:this.predefinedTimeRanges,onAtuiIndexChange:t=>{t.detail<this.presets.length?this.onChangeRelativeTime(this.presets[t.detail]):t.detail===this.predefinedTimeRanges.length-1&&this.absoluteTimeMenuEl.focus()}}),s("div",{key:"6e734d6ccb819df0b55bbd5641593da9bf90bdb1",ref:t=>this.relativeTimeMenuEl=t,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:t=>t.stopPropagation()},s("at-time-with-unit",{key:"0cb0936bfcf9e32e5fa2e7dfa234dbf5bac91439",units:this.units,common_options:this.presets,min_date:this.lowerLimit,min_seconds:this.minSeconds,initial_selected_time:this.selected_time_range.selected===d.CUSTOM?d.ALL:this.selected_time_range.selected,custom_error_message:this.custom_error_message,show_all_time:this.show_all_time,onAtuiSubmit:t=>this.onChangeRelativeTime(t.detail),onAtuiCancel:()=>{this.relativeTimeMenuEl.focus(),this.relativeTimeMenuEl.blur()}})),s("div",{key:"cb0c6e257f202d435834e134db6c18c18084e5df",ref:t=>this.absoluteTimeMenuEl=t,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:t=>t.stopPropagation()},s("at-custom-time-range",{key:"063e0cf81d077b0667f35a25a4ba3387df6e53fb",min_date:this.lowerLimit,default_to_date:this.today,default_from_date:this.defaultFromDate,from_date_value:this.getCustomStartAndEndDate(this.selected_time_range)?.fromDate,to_date_value:this.getCustomStartAndEndDate(this.selected_time_range)?.toDate,lock_end_date_to_now:this.selected_time_range.custom?.lockEndDateToNow,onAtuiSubmit:t=>this.onChangeCustomTime(t.detail),onAtuiCancel:()=>{this.absoluteTimeMenuEl.focus(),this.absoluteTimeMenuEl.blur()}})))}};export{f as at_time_range}