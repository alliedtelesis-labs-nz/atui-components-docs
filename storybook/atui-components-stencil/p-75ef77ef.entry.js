import{r as t,h as e,g as i,H as s}from"./p-DW9Wz0FM.js";import{a,c as o,o as h,f as n,s as r,b as d}from"./p-BO6p966C.js";const l=class{constructor(e){t(this,e)}label;required;info_text;for;render(){return e("div",{key:"44637372c2205f4e3b5567dab2540c1b8693132c",class:"flex items-center gap-8"},[(this.label||this.required)&&e("label",{key:"f0888dd9af9d08d5bbd31aac09b9159957346027",htmlFor:this.for??void 0,class:"flex gap-4"},this.label,this.required&&e("span",{key:"e1def040d93e2f603c9bf847171914c9542e5ed1",class:"text-error"},"*")),this.info_text&&e("at-tooltip",{key:"fbaec73e6422bc6eeb3b2e2e8620b2b153aeaf77",position:"right"},e("span",{key:"70fbc0692dc65e18350fd58a493b2dc48e2d50f7",slot:"tooltip-trigger",class:"material-icons !text-icon-sm text-light cursor-pointer"},"info_outline"),e("span",{key:"e2b4165726a85b87b2987f16fd1f662d4ef00e66"},this.info_text))])}},c=class{constructor(e){t(this,e)}position="top";align="center";disabled=!1;width="200px";offset=8;delay=150;trigger_id;async disabledChanged(t){t&&this.isOpen&&await this.closeTooltip()}isOpen=!1;get el(){return i(this)}triggerEl;tooltipEl;triggerEls=[];cleanupAutoUpdate;popoverId;showTimeout;hideTimeout;updatePosition=async()=>{this.triggerEl&&this.tooltipEl&&this.isOpen&&await this.updateFloatingPosition()};async openTooltip(){this.disabled||(this.tooltipEl&&(this.tooltipEl.showPopover(),this.isOpen=!0),await this.updatePosition(),this.updateAriaExpanded())}async closeTooltip(){this.tooltipEl&&(this.tooltipEl.hidePopover(),this.isOpen=!1),this.updateAriaExpanded()}updateAriaExpanded(){this.trigger_id&&this.triggerEl&&this.triggerEl.setAttribute("aria-expanded",this.isOpen?"true":"false")}async componentDidLoad(){if(this.popoverId=`atui-tooltip-${Math.random().toString(36).substr(2,9)}`,this.trigger_id){if(this.triggerEls=Array.from(document.querySelectorAll(`[data-tooltip="${this.trigger_id}"]`)),0===this.triggerEls.length)return void console.warn(`atui-tooltip: No elements found with data-tooltip="${this.trigger_id}"`)}else this.triggerEl=this.el.querySelector('[data-name="tooltip-trigger"]');await this.setupFloatingUI(),setTimeout((()=>this.setupPopoverEventListeners()),0),this.trigger_id&&this.triggerEls.length&&this.setupExternalTriggerListeners()}disconnectedCallback(){this.cleanupFloatingUI(),this.cleanupExternalTriggerListeners(),this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=void 0),this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=void 0)}externalTriggerListeners=[];cleanupExternalTriggerListeners(){this.externalTriggerListeners.forEach((({element:t,event:e,handler:i})=>{t.removeEventListener(e,i)})),this.externalTriggerListeners=[]}async setupPopoverEventListeners(){this.tooltipEl&&this.tooltipEl.addEventListener("toggle",(t=>{this.isOpen="open"===t.newState,this.isOpen?requestAnimationFrame((()=>{this.tooltipEl.style.opacity="1",this.updatePosition()})):this.tooltipEl.style.opacity="0"}))}setupExternalTriggerListeners(){this.triggerEls&&0!==this.triggerEls.length&&this.triggerEls.forEach((t=>{const e=()=>{this.disabled||(this.triggerEl=t,this.mouseEnterHandler())},i=()=>{this.disabled||(this.triggerEl=t,this.mouseLeaveHandler())};t.addEventListener("mouseenter",e),t.addEventListener("mouseleave",i),this.externalTriggerListeners.push({element:t,event:"mouseenter",handler:e},{element:t,event:"mouseleave",handler:i}),t.setAttribute("aria-haspopup","true"),t.setAttribute("aria-expanded","false")}))}async mouseEnterHandler(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=void 0),this.isOpen||(this.showTimeout&&clearTimeout(this.showTimeout),this.showTimeout=setTimeout((async()=>{this.disabled||this.isOpen||await this.openTooltip(),this.showTimeout=void 0}),this.delay||0))}async mouseLeaveHandler(){if(this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=void 0),!this.isOpen)return;const t=Math.min(this.delay||0,150);this.hideTimeout=setTimeout((async()=>{this.isOpen&&await this.closeTooltip(),this.hideTimeout=void 0}),t)}async setupFloatingUI(){if(this.cleanupAutoUpdate&&this.cleanupAutoUpdate(),this.triggerEl&&this.tooltipEl){const t=new IntersectionObserver((t=>{!t[0].isIntersecting&&this.isOpen&&this.closeTooltip()}),{threshold:0});t.observe(this.triggerEl),this.cleanupAutoUpdate=a(this.triggerEl,this.tooltipEl,(()=>{if(this.isOpen){const t=this.getFloatingUIPlacement(),e="fixed";o(this.triggerEl,this.tooltipEl,{placement:t,strategy:e,middleware:[h(this.offset??8),n({fallbackStrategy:"bestFit",padding:8}),r({padding:8,mainAxis:!0,crossAxis:!0}),d({apply:({availableWidth:t,availableHeight:e,elements:i})=>{const s=parseInt((this.width||"200px").toString(),10)||200;Object.assign(i.floating.style,{maxWidth:`${Math.min(t,s)}px`,maxHeight:`${e}px`})}})]}).then((({x:t,y:i})=>{Object.assign(this.tooltipEl.style,{position:e,left:`${t}px`,top:`${i}px`,margin:"0",transform:"none",maxWidth:this.width||"200px"})}))}}),{ancestorScroll:!0,ancestorResize:!0,elementResize:!0,layoutShift:!0,animationFrame:!0});const e=this.cleanupAutoUpdate;this.cleanupAutoUpdate=()=>{e(),t.disconnect()}}}cleanupFloatingUI(){this.cleanupAutoUpdate?.(),this.cleanupAutoUpdate=void 0}async updateFloatingPosition(){this.triggerEl&&this.tooltipEl&&this.setupFloatingUI()}getFloatingUIPlacement(){return`${{top:"top",bottom:"bottom",left:"left",right:"right"}[this.position]||"bottom"}-${{start:"start",end:"end",center:"center"}[this.align]||"center"}`}render(){return e(s,{key:"a6dbd57bd2e5a20335a9c93524d408ef990d2565",class:"relative"},!this.trigger_id&&e("div",{key:"a09d0c5b98ced0956019c3b88102501b227f91c2","aria-haspopup":"true","data-name":"tooltip-trigger",ref:t=>this.triggerEl=t,"aria-expanded":this.isOpen?"true":"false",class:this.disabled?"contents":"",onMouseEnter:()=>this.disabled?null:this.mouseEnterHandler(),onMouseLeave:()=>this.disabled?null:this.mouseLeaveHandler()},e("slot",{key:"d7af1ba9821f333ce50904f9fee9da4e6169d45d",name:"tooltip-trigger"})),e("div",{key:"d23d9dcdf5766501deba1b4f1bdfa56d0a5d05e6",ref:t=>this.tooltipEl=t,"data-position":this.position,"data-align":this.align,popover:"auto",id:this.popoverId,class:"pointer-events-none w-fit rounded-md bg-gray-950/80 px-[6px] py-2 text-sm text-white opacity-0 shadow-md transition-opacity duration-200 ease-out","data-name":"tooltip-content-wrapper"},e("slot",{key:"fe31ca67fa572f34581b7290d58afd77c8417553"})))}static get watchers(){return{disabled:[{disabledChanged:0}]}}};export{l as at_form_label,c as at_tooltip}