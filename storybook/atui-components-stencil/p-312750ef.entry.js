import{r as t,c as e,g as s,h as i,H as a}from"./p-EP34iaAr.js";import{f as r}from"./p-DuLooPsr.js";import{c as n}from"./p-COG8_R0C.js";import{h as o,a as l}from"./p-CF3ljWUs.js";const c={variants:{focused:{false:"ring-active-foreground/30",true:"pointer-events-none"},disabled:{false:"focus-within:ring-active-foreground/30 cursor-pointer bg-white",true:"bg-surface-1 !text-disabled pointer-events-none border-none"},readonly:{false:"focus-within:ring-active-foreground/30",true:"!bg-surface-1 !text-dark cursor-text border-none"},invalid:{false:"border-med focus-within:border-active-dark focus-within:ring-active-foreground/30",true:"border-error-base focus-within:border-error-base focus-within:ring-destructive-foreground/30"}},defaultVariants:{disabled:false,readonly:false,invalid:false}};const h=class{constructor(s){t(this,s);this.atuiChange=e(this,"atuiChange",7)}value;options;label;hint_text;info_text;placeholder;error_text;required;invalid;disabled;readonly;clearable;typeahead=false;autoclose=true;inputEl;searchText="";isOpen=false;translations;hasMatchingOptions=false;hasMatchingElOptions=false;parentWidth;get el(){return s(this)}menuId=`dropdown-${Math.random().toString(36).substring(2,11)}`;menuRef;optionEls=[];searchInputEl;watchValue(t){this.optionEls.forEach((e=>{e.is_active=t===e.value}))}watchSearchText(t){const e=t.trim().toLowerCase();this.optionEls.forEach((t=>{const s=!e||t.value.toLowerCase().includes(e);t.style.display=s?"":"none"}))}atuiChange;async componentWillLoad(){this.translations=await r(this.el)}componentDidLoad(){this.el.querySelectorAll("at-select-option").forEach((t=>{const e=t;e.is_active=this.value===e.value;e.addEventListener("atuiClick",(t=>{this.handleChange(t.detail)}));this.optionEls.push(e)}));const t=this.el.getBoundingClientRect();this.parentWidth=`${t.width}px`}updateIsOpenState(t){this.isOpen=t.detail;const e=this.el.querySelector('[slot="menu-trigger"]');const s=e?.getBoundingClientRect();if(s&&s.width>0){this.parentWidth=`${s.width}px`}if(this.isOpen&&this.typeahead){requestAnimationFrame((()=>{if(this.searchInputEl){this.searchInputEl.focus()}}))}}async handleChange(t){if(this.autoclose){await(this.menuRef?.closeMenu())}this.value=t;this.inputEl.focus();this.atuiChange.emit(this.value)}async handleClear(){this.searchText=""}async handleKeyDownMenu(t){if(t.key==="Enter"||t.key===" "){if(t.target instanceof HTMLLIElement){t.preventDefault();t.target.click()}return}const e=this.el.querySelector('ul[id="at-select"]');if(!e)return;o(t,e);l(t,e)}handleSearchInput(t){const e=t.target;this.searchText=e.value.toLowerCase();const s=this.searchText.trim().toLowerCase();this.hasMatchingOptions=s?this.options?.some((t=>t.value.toLowerCase().includes(s))):true;this.hasMatchingElOptions=s?this.optionEls?.some((t=>t.value.toLowerCase().includes(s))):true}render(){return i(a,{key:"839803dafd76a90572f6c6500529ec9131fe1bb1",class:"group/select",onFocusout:async t=>{await this.handleClear();const e=t.relatedTarget;if(!e||!this.el.contains(e)){setTimeout((async()=>{await(this.menuRef?.closeMenu())}),100)}}},this.renderLabel(),i("at-menu",{key:"06f23a61e4085eef49cc59b5663ccd79f987f513",ref:t=>this.menuRef=t,trigger:"click",align:"start",width:this.parentWidth,role:"listbox",disabled:this.disabled||this.readonly,onAtuiMenuStateChange:t=>this.updateIsOpenState(t)},this.renderInput(),!this.disabled||!this.readonly?this.renderOptions():null),i("div",{key:"afe6618280b3ca04cb02b834518fefddbc8a3e6c"},this.error_text&&this.invalid&&i("span",{key:"b06467320cdaa576b92373572b800683508adffa",class:"text-error","data-name":"select-error"},this.error_text)))}renderLabel(){return i("div",{class:"mb-4 flex flex-col"},i("slot",{name:"label"}),(this.label||this.required||this.info_text)&&i("at-form-label",{for:this.menuId,label:this.label,required:this.required&&!this.readonly,info_text:this.info_text}),this.hint_text&&i("span",{class:"text-light inline-block text-xs leading-tight","data-name":"select-hint"},this.hint_text))}renderInput(){const t=n("height-[36px] transition[background-color,color,box-shadow] placeholder-text-light group/select:focus-within:ring-2 w-full cursor-pointer rounded-md border border-solid p-8 outline-0 duration-300 ease-in-out select-none focus:ring-2",c);const e=t({invalid:this.invalid,disabled:this.disabled,readonly:this.readonly});return i("div",{class:"relative flex items-center gap-4",slot:"menu-trigger"},i("input",{class:e,role:"combobox",list:"at-select","aria-expanded":this.isOpen,"aria-controls":this.menuId,type:"text",readonly:true,"aria-disabled":this.disabled,disabled:this.disabled,placeholder:this.placeholder,value:this.value,"data-name":"select-input",ref:t=>this.inputEl=t}),!this.readonly&&!this.disabled&&i("div",{class:"bg-surface1 absolute right-4 flex h-full cursor-pointer items-center rounded-md p-4 select-none",role:"presentation",tabindex:-1},i("span",{class:"material-icons h-16 w-16 text-[16px] leading-[16px]","data-name":"button-icon-right"},this.isOpen?"arrow_drop_up":"arrow_drop_down")))}renderOptions(){return i("ul",{class:"contents",id:"at-select",onKeyDown:async t=>{await this.handleKeyDownMenu(t)}},this.typeahead&&i("div",{class:"relative z-10 bg-white p-4"},i("input",{type:"text",class:`transition[background-color,color] bg-surface-1 ring-active-foreground/30 mb-4 h-[28px] w-full flex-shrink flex-grow basis-0 rounded-md p-8 outline-0 duration-300 ease-in-out focus:ring-2 ${this.clearable?"pr-24":""} `,placeholder:this.translations?.ATUI?.SEARCH||"Search",name:"",autoComplete:"off","aria-autocomplete":"list",value:this.searchText,onInput:t=>{t.stopPropagation();this.handleSearchInput(t)},onClick:t=>t.stopPropagation(),ref:t=>this.searchInputEl=t}),this.clearable&&this.searchText!==""&&i("div",{class:"absolute top-4 right-4"},i("at-button",{size:"sm",icon:"cancel",type:"secondaryText",onClick:async t=>{t.stopPropagation();await this.handleClear()},"data-name":"select-clear"}))),this.options?.filter((t=>!this.searchText||t.value.toLowerCase().includes(this.searchText))).map((t=>this.renderOption(t))),i("slot",null),this.typeahead&&this.searchText&&!this.hasMatchingOptions&&!this.hasMatchingElOptions&&i("div",{class:"text-body text-light w-full bg-white px-16 py-8"},this.translations?.ATUI?.NO_RESULTS_FOUND||"No results found"))}renderOption(t){return i("at-select-option",{value:t.value,is_active:this.value===t.value,onAtuiClick:()=>this.handleChange(t.value)})}static get watchers(){return{value:["watchValue"],searchText:["watchSearchText"]}}};const d={variants:{active:{true:"bg-active-light text-active",false:"hover:bg-disabled-light bg-white"}}};const u=class{constructor(s){t(this,s);this.atuiClick=e(this,"atuiClick",7)}value;is_active=false;atuiClick;handleClick(){this.atuiClick.emit(this.value)}render(){const t=n("transition[background-color,color,box-shadow] text-body focus:ring-active-foreground/40 flex w-full cursor-pointer items-center truncate p-8 font-normal duration-300 ease-in-out focus:ring-2 focus:outline-0 focus:ring-inset",d);const e=t({active:this.is_active});return i("li",{key:"c665cc1ea4eff953e23bcfff6918f352200d003c",role:"option",value:this.value,"data-name":"select-option","aria-selected":this.is_active?"true":"false",tabIndex:0,class:e,onClick:()=>this.handleClick()},i("slot",{key:"28a6613f97a815e6653e4702874133a0e9ae18c1"}),this.value)}};export{h as at_select,u as at_select_option};
//# sourceMappingURL=p-312750ef.entry.js.map