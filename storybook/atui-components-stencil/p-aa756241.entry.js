import{r as t,h as i,H as e}from"./p-EP34iaAr.js";import{C as s,a as o,D as n,A as a,f as r,g as h,i as c,h as l}from"./p-BFIVuvTv.js";import"moment";const d="#0f172a";const p={xs:"h-[70px]",sm:"h-[160px]",md:"h-[235px]",lg:"h-[330px]",xl:"h-[440px]",auto:"h-full"};const f=class{constructor(i){t(this,i)}data;options;height="md";legend_position="top";legend_format={labels:{boxWidth:10,boxHeight:10,fontSize:11},onHover:t=>{if(t.native){t.native.target.style.cursor="pointer"}},onClick:(t,i,e)=>{const s=e.chart;const o=i.index;s.toggleDataVisibility(o);const n=s.data.labels?.some(((t,i)=>s.getDataVisibility(i)));if(s.options.plugins?.tooltip){s.options.plugins.tooltip.enabled=!!n}s.update()},display:true};tooltip_options={mode:"nearest",intersect:true,position:"nearest"};plugins;color_palette=s.CATEGORICAL;center_value;center_text;cutout=70;canvasEl;config;chart;async getConfig(){return this.config}defaultPieTooltipOptions={mode:"nearest",intersect:true,position:"nearest",animation:{duration:150}};getDrawCenterTextPlugin(){return{id:"DrawCenterTextPlugin",afterDatasetDraw:t=>{const i=(t.chartArea.left+t.chartArea.right)/2;const e=(t.chartArea.top+t.chartArea.bottom)/2;const s=t.ctx;if(!s){return}s.restore();const o=t.chartArea.bottom-t.chartArea.top;const n=(o/200).toFixed(2)+"em sans-serif";const a=(o/140).toFixed(2)+"em sans-serif";s.fillStyle=d;s.textAlign="center";s.textBaseline="middle";s.font="500 "+a;const r=(t,i,e,o,n)=>{s.font="500 "+t;const a=s.measureText(i);const r=a.actualBoundingBoxAscent+a.actualBoundingBoxDescent;if(n!="middle"){o=n==="top"?o-r:o+r}s.fillText(i,e,o)};if(this.center_value){r(a,this.center_value,i,e,"top");r(n,this.center_text,i,e,"bottom")}else if(this.center_text){r(n,this.center_text,i,e,"middle")}s.save()}}}initChart(){o.register(n,a,r,h,c);const t=window.devicePixelRatio||1;const i=l(this.color_palette);if(i){this.applyPresetPalette(i)}const e=this.plugins?[...this.plugins]:[];if(this.center_text||this.center_value){e.push(this.getDrawCenterTextPlugin())}this.config={type:"doughnut",data:{...this.data,datasets:this.data.datasets.map((t=>({...t,cutout:`${this.cutout}%`})))},options:{devicePixelRatio:t,maintainAspectRatio:true,aspectRatio:1,layout:{padding:16},interaction:{mode:"nearest",intersect:true},plugins:{legend:{...this.legend_format||{},position:this.legend_position,fullSize:true},tooltip:{...this.tooltip_options||this.defaultPieTooltipOptions,filter:t=>t.chart.getDataVisibility(t.dataIndex),enabled:true}},...this.options||{}},plugins:e};if(this.chart){this.chart.destroy()}this.chart=new o(this.canvasEl,this.config)}applyPresetPalette(t){if(this.color_palette===s.CUSTOM){return}this.data.datasets=this.data.datasets.map((i=>{const e=i.data.map(((i,e)=>t[e%t.length]));return{...i,backgroundColor:e,hoverBackgroundColor:e,borderColor:e,hoverBorderColor:e}}))}componentDidUpdate(){if(this.data&&this.data.datasets.length){this.initChart()}}componentDidLoad(){if(this.data&&this.data.datasets.length){this.initChart()}}render(){return i(e,{key:"cafa2f208d919fa23eeb3c3a9df89dfb20b28d9a",role:"region",class:`relative flex w-full flex-col items-center justify-center ${p[this.height]}`},i("canvas",{key:"0c2a041466a97ae227cddeaa64b56ddf96a1b48e",ref:t=>this.canvasEl=t,style:{position:"static",display:"block",width:"100%",height:"100%"}}))}};export{f as at_chart_donut};
//# sourceMappingURL=p-aa756241.entry.js.map