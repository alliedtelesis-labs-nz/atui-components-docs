import{r as t,c as i,g as s,h as e}from"./p-jvbUuQtg.js";class h{static getElements(t,i=document){if("string"==typeof t){const s="getElementById"in i?i:void 0;if(s&&!isNaN(+t[0])){const i=s.getElementById(t);return i?[i]:[]}let e=i.querySelectorAll(t);if(!e.length&&"."!==t[0]&&"#"!==t[0]&&(e=i.querySelectorAll("."+t),e.length||(e=i.querySelectorAll("#"+t)),!e.length)){const s=i.querySelector(`[gs-id="${t}"]`);return s?[s]:[]}return Array.from(e)}return[t]}static getElement(t,i=document){if("string"==typeof t){const s="getElementById"in i?i:void 0;if(!t.length)return null;if(s&&"#"===t[0])return s.getElementById(t.substring(1));if("#"===t[0]||"."===t[0]||"["===t[0])return i.querySelector(t);if(s&&!isNaN(+t[0]))return s.getElementById(t);let e=i.querySelector(t);return s&&!e&&(e=s.getElementById(t)),e||(e=i.querySelector("."+t)),e}return t}static lazyLoad(t){return t.lazyLoad||t.grid?.opts?.lazyLoad&&!1!==t.lazyLoad}static createDiv(t,i){const s=document.createElement("div");return t.forEach((t=>{t&&s.classList.add(t)})),i?.appendChild(s),s}static shouldSizeToContent(t,i=!1){return t?.grid&&(i?!0===t.sizeToContent||!0===t.grid.opts.sizeToContent&&void 0===t.sizeToContent:!!t.sizeToContent||t.grid.opts.sizeToContent&&!1!==t.sizeToContent)}static isIntercepted(t,i){return!(t.y>=i.y+i.h||t.y+t.h<=i.y||t.x+t.w<=i.x||t.x>=i.x+i.w)}static isTouching(t,i){return h.isIntercepted(t,{x:i.x-.5,y:i.y-.5,w:i.w+1,h:i.h+1})}static areaIntercept(t,i){const s=t.x>i.x?t.x:i.x,e=t.x+t.w<i.x+i.w?t.x+t.w:i.x+i.w;if(e<=s)return 0;const h=t.y>i.y?t.y:i.y,r=t.y+t.h<i.y+i.h?t.y+t.h:i.y+i.h;return r<=h?0:(e-s)*(r-h)}static area(t){return t.w*t.h}static sort(t,i=1){const s=1e4;return t.sort(((t,e)=>{const h=i*((t.y??s)-(e.y??s));return 0===h?i*((t.x??s)-(e.x??s)):h}))}static find(t,i){return i?t.find((t=>t.id===i)):void 0}static toBool(t){return"boolean"==typeof t?t:"string"==typeof t?!(""===(t=t.toLowerCase())||"no"===t||"false"===t||"0"===t):Boolean(t)}static toNumber(t){return null===t||0===t.length?void 0:Number(t)}static parseHeight(t){let i,s="px";if("string"==typeof t)if("auto"===t||""===t)i=0;else{const e=t.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw|%|cm|mm)?$/);if(!e)throw new Error(`Invalid height val = ${t}`);s=e[2]||"px",i=parseFloat(e[1])}else i=t;return{h:i,unit:s}}static defaults(t,...i){return i.forEach((i=>{for(const s in i){if(!i.hasOwnProperty(s))return;null==t[s]?t[s]=i[s]:"object"==typeof i[s]&&"object"==typeof t[s]&&h.defaults(t[s],i[s])}})),t}static same(t,i){if("object"!=typeof t)return t==i;if(typeof t!=typeof i)return!1;if(Object.keys(t).length!==Object.keys(i).length)return!1;for(const s in t)if(t[s]!==i[s])return!1;return!0}static copyPos(t,i,s=!1){return void 0!==i.x&&(t.x=i.x),void 0!==i.y&&(t.y=i.y),void 0!==i.w&&(t.w=i.w),void 0!==i.h&&(t.h=i.h),s&&(i.minW&&(t.minW=i.minW),i.minH&&(t.minH=i.minH),i.maxW&&(t.maxW=i.maxW),i.maxH&&(t.maxH=i.maxH)),t}static samePos(t,i){return t&&i&&t.x===i.x&&t.y===i.y&&(t.w||1)===(i.w||1)&&(t.h||1)===(i.h||1)}static sanitizeMinMax(t){t.minW||delete t.minW,t.minH||delete t.minH,t.maxW||delete t.maxW,t.maxH||delete t.maxH}static removeInternalAndSame(t,i){if("object"==typeof t&&"object"==typeof i&&!Array.isArray(t)&&!Array.isArray(i))for(let s in t){const e=t[s],r=i[s];"_"===s[0]||e===r?delete t[s]:e&&"object"==typeof e&&void 0!==r&&(h.removeInternalAndSame(e,r),Object.keys(e).length||delete t[s])}}static removeInternalForSave(t,i=!0){for(let i in t)"_"!==i[0]&&null!=t[i]||delete t[i];delete t.grid,i&&delete t.el,t.autoPosition||delete t.autoPosition,t.noResize||delete t.noResize,t.noMove||delete t.noMove,t.locked||delete t.locked,1!==t.w&&t.w!==t.minW||delete t.w,1!==t.h&&t.h!==t.minH||delete t.h}static throttle(t,i){let s=!1;return(...e)=>{s||(s=!0,setTimeout((()=>{t(...e),s=!1}),i))}}static removePositioningStyles(t){const i=t.style;i.position&&i.removeProperty("position"),i.left&&i.removeProperty("left"),i.top&&i.removeProperty("top"),i.width&&i.removeProperty("width"),i.height&&i.removeProperty("height")}static getScrollElement(t){if(!t)return document.scrollingElement||document.documentElement;const i=getComputedStyle(t);return/(auto|scroll)/.test(i.overflow+i.overflowY)?t:h.getScrollElement(t.parentElement)}static updateScrollPosition(t,i,s){const e=h.getScrollElement(t);if(!e)return;const r=t.getBoundingClientRect(),n=e.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight,a=r.bottom-Math.min(n.bottom,o),d=r.top-Math.max(n.top,0),l=e.scrollTop;d<0&&s<0?e.scrollTop+=t.offsetHeight>n.height||Math.abs(d)>Math.abs(s)?s:d:a>0&&s>0&&(e.scrollTop+=t.offsetHeight>n.height||a>s?s:a),i.top+=e.scrollTop-l}static updateScrollResize(t,i,s){const e=h.getScrollElement(i),r=e.clientHeight,n=e===h.getScrollElement()?0:e.getBoundingClientRect().top,o=t.clientY-n,a=o>r-s;o<s?e.scrollBy({behavior:"smooth",top:o-s}):a&&e.scrollBy({behavior:"smooth",top:s-(r-o)})}static clone(t){return null==t||"object"!=typeof t?t:t instanceof Array?[...t]:{...t}}static cloneDeep(t){const i=["parentGrid","el","grid","subGrid","engine"],s=h.clone(t);for(const e in s)s.hasOwnProperty(e)&&"object"==typeof s[e]&&"__"!==e.substring(0,2)&&!i.find((t=>t===e))&&(s[e]=h.cloneDeep(t[e]));return s}static cloneNode(t){const i=t.cloneNode(!0);return i.removeAttribute("id"),i}static appendTo(t,i){let s;s="string"==typeof i?h.getElement(i):i,s&&s.appendChild(t)}static addElStyles(t,i){if(i instanceof Object)for(const s in i)i.hasOwnProperty(s)&&(Array.isArray(i[s])?i[s].forEach((i=>{t.style[s]=i})):t.style[s]=i[s])}static initEvent(t,i){const s={type:i.type},e={button:0,which:0,buttons:1,bubbles:!0,cancelable:!0,target:i.target?i.target:t.target};return["altKey","ctrlKey","metaKey","shiftKey"].forEach((i=>s[i]=t[i])),["pageX","pageY","clientX","clientY","screenX","screenY"].forEach((i=>s[i]=t[i])),{...s,...e}}static simulateMouseEvent(t,i,s){const e=new MouseEvent(i,{bubbles:!0,composed:!0,cancelable:!0,view:window,detail:1,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:t.ctrlKey??!1,altKey:t.altKey??!1,shiftKey:t.shiftKey??!1,metaKey:t.metaKey??!1,button:0,relatedTarget:t.target});(s||t.target).dispatchEvent(e)}static getValuesFromTransformedElement(t){const i=document.createElement("div");h.addElStyles(i,{opacity:"0",position:"fixed",top:"0px",left:"0px",width:"1px",height:"1px",zIndex:"-999999"}),t.appendChild(i);const s=i.getBoundingClientRect();return t.removeChild(i),i.remove(),{xScale:1/s.width,yScale:1/s.height,xOffset:s.left,yOffset:s.top}}static swap(t,i,s){if(!t)return;const e=t[i];t[i]=t[s],t[s]=e}static canBeRotated(t){return!(!t||t.w===t.h||t.locked||t.noResize||t.grid?.opts.disableResize||t.minW&&t.minW===t.maxW||t.minH&&t.minH===t.maxH)}}class r{constructor(t={}){this.addedNodes=[],this.removedNodes=[],this.defaultColumn=12,this.column=t.column||this.defaultColumn,this.column>this.defaultColumn&&(this.defaultColumn=this.column),this.maxRow=t.maxRow,this._float=t.float,this.nodes=t.nodes||[],this.onChange=t.onChange}batchUpdate(t=!0,i=!0){return!!this.batchMode===t||(this.batchMode=t,t?(this._prevFloat=this._float,this._float=!0,this.cleanNodes(),this.saveInitial()):(this._float=this._prevFloat,delete this._prevFloat,i&&this._packNodes(),this._notify())),this}_useEntireRowArea(t,i){return(!this.float||this.batchMode&&!this._prevFloat)&&!this._hasLocked&&(!t._moving||t._skipDown||i.y<=t.y)}_fixCollisions(t,i=t,s,e={}){if(this.sortNodes(-1),!(s=s||this.collide(t,i)))return!1;if(t._moving&&!e.nested&&!this.float&&this.swap(t,s))return!0;let r=i;!this._loading&&this._useEntireRowArea(t,i)&&(r={x:0,w:this.column,y:i.y,h:i.h},s=this.collide(t,r,e.skip));let n=!1;const o={nested:!0,pack:!1};let a=0;for(;s=s||this.collide(t,r,e.skip);){if(a++>2*this.nodes.length)throw new Error("Infinite collide check");let r;if(s.locked||this._loading||t._moving&&!t._skipDown&&i.y>t.y&&!this.float&&(!this.collide(s,{...s,y:t.y},t)||!this.collide(s,{...s,y:i.y-s.h},t))){t._skipDown=t._skipDown||i.y>t.y;const a={...i,y:s.y+s.h,...o};r=!(!this._loading||!h.samePos(t,a))||this.moveNode(t,a),(s.locked||this._loading)&&r?h.copyPos(i,t):!s.locked&&r&&e.pack&&(this._packNodes(),i.y=s.y+s.h,h.copyPos(t,i)),n=n||r}else r=this.moveNode(s,{...s,y:i.y+i.h,skip:t,...o});if(!r)return n;s=void 0}return n}collide(t,i=t,s){const e=t._id,r=s?._id;return this.nodes.find((t=>t._id!==e&&t._id!==r&&h.isIntercepted(t,i)))}collideAll(t,i=t,s){const e=t._id,r=s?._id;return this.nodes.filter((t=>t._id!==e&&t._id!==r&&h.isIntercepted(t,i)))}directionCollideCoverage(t,i,s){if(!i.rect||!t._rect)return;const e=t._rect,h={...i.rect};let r;h.y>e.y?(h.h+=h.y-e.y,h.y=e.y):h.h+=e.y-h.y,h.x>e.x?(h.w+=h.x-e.x,h.x=e.x):h.w+=e.x-h.x;let n=.5;for(let t of s){if(t.locked||!t._rect)break;const i=t._rect;let s=Number.MAX_VALUE,o=Number.MAX_VALUE;e.y<i.y?s=(h.y+h.h-i.y)/i.h:e.y+e.h>i.y+i.h&&(s=(i.y+i.h-h.y)/i.h),e.x<i.x?o=(h.x+h.w-i.x)/i.w:e.x+e.w>i.x+i.w&&(o=(i.x+i.w-h.x)/i.w);const a=Math.min(o,s);a>n&&(n=a,r=t)}return i.collide=r,r}cacheRects(t,i,s,e,h,r){return this.nodes.forEach((n=>n._rect={y:n.y*i+s,x:n.x*t+r,w:n.w*t-r-e,h:n.h*i-s-h})),this}swap(t,i){if(!i||i.locked||!t||t.locked)return!1;function s(){const s=i.x,e=i.y;return i.x=t.x,i.y=t.y,t.h!=i.h?(t.x=s,t.y=i.y+i.h):t.w!=i.w?(t.x=i.x+i.w,t.y=e):(t.x=s,t.y=e),t._dirty=i._dirty=!0,!0}let e;if(t.w===i.w&&t.h===i.h&&(t.x===i.x||t.y===i.y)&&(e=h.isTouching(t,i)))return s();if(!1!==e){if(t.w===i.w&&t.x===i.x&&(e||(e=h.isTouching(t,i)))){if(i.y<t.y){const s=t;t=i,i=s}return s()}if(!1!==e){if(t.h===i.h&&t.y===i.y&&(e||(e=h.isTouching(t,i)))){if(i.x<t.x){const s=t;t=i,i=s}return s()}return!1}}}isAreaEmpty(t,i,s,e){return!this.collide({x:t||0,y:i||0,w:s||1,h:e||1})}compact(t="compact",i=!0){if(0===this.nodes.length)return this;i&&this.sortNodes();const s=this.batchMode;s||this.batchUpdate();const e=this._inColumnResize;e||(this._inColumnResize=!0);const h=this.nodes;return this.nodes=[],h.forEach(((i,s,e)=>{let h;i.locked||(i.autoPosition=!0,"list"===t&&s&&(h=e[s-1])),this.addNode(i,!1,h)})),e||delete this._inColumnResize,s||this.batchUpdate(!1),this}set float(t){this._float!==t&&(this._float=t||!1,t||this._packNodes()._notify())}get float(){return this._float||!1}sortNodes(t=1){return this.nodes=h.sort(this.nodes,t),this}_packNodes(){return this.batchMode||(this.sortNodes(),this.nodes.forEach(this.float?t=>{if(t._updating||void 0===t._orig||t.y===t._orig.y)return;let i=t.y;for(;i>t._orig.y;)--i,this.collide(t,{x:t.x,y:i,w:t.w,h:t.h})||(t._dirty=!0,t.y=i)}:(t,i)=>{if(!t.locked)for(;t.y>0;){const s=0===i?0:t.y-1;if(0!==i&&this.collide(t,{x:t.x,y:s,w:t.w,h:t.h}))break;t._dirty=t.y!==s,t.y=s}})),this}prepareNode(t,i){t._id=t._id??r._idSeq++;const s=t.id;if(s){let i=1;for(;this.nodes.find((i=>i.id===t.id&&i!==t));)t.id=s+"_"+i++}void 0!==t.x&&void 0!==t.y&&null!==t.x&&null!==t.y||(t.autoPosition=!0);const e={x:0,y:0,w:1,h:1};return h.defaults(t,e),t.autoPosition||delete t.autoPosition,t.noResize||delete t.noResize,t.noMove||delete t.noMove,h.sanitizeMinMax(t),"string"==typeof t.x&&(t.x=Number(t.x)),"string"==typeof t.y&&(t.y=Number(t.y)),"string"==typeof t.w&&(t.w=Number(t.w)),"string"==typeof t.h&&(t.h=Number(t.h)),isNaN(t.x)&&(t.x=e.x,t.autoPosition=!0),isNaN(t.y)&&(t.y=e.y,t.autoPosition=!0),isNaN(t.w)&&(t.w=e.w),isNaN(t.h)&&(t.h=e.h),this.nodeBoundFix(t,i),t}nodeBoundFix(t,i){const s=t._orig||h.copyPos({},t);if(t.maxW&&(t.w=Math.min(t.w||1,t.maxW)),t.maxH&&(t.h=Math.min(t.h||1,t.maxH)),t.minW&&(t.w=Math.max(t.w||1,t.minW)),t.minH&&(t.h=Math.max(t.h||1,t.minH)),(t.x||0)+(t.w||1)>this.column&&this.column<this.defaultColumn&&!this._inColumnResize&&!this.skipCacheUpdate&&null!=t._id&&-1===this.findCacheLayout(t,this.defaultColumn)){const i={...t};i.autoPosition||void 0===i.x?(delete i.x,delete i.y):i.x=Math.min(this.defaultColumn-1,i.x),i.w=Math.min(this.defaultColumn,i.w||1),this.cacheOneLayout(i,this.defaultColumn)}return t.w>this.column?t.w=this.column:t.w<1&&(t.w=1),this.maxRow&&t.h>this.maxRow?t.h=this.maxRow:t.h<1&&(t.h=1),t.x<0&&(t.x=0),t.y<0&&(t.y=0),t.x+t.w>this.column&&(i?t.w=this.column-t.x:t.x=this.column-t.w),this.maxRow&&t.y+t.h>this.maxRow&&(i?t.h=this.maxRow-t.y:t.y=this.maxRow-t.h),h.samePos(t,s)||(t._dirty=!0),this}getDirtyNodes(t){return this.nodes.filter(t?t=>t._dirty&&!h.samePos(t,t._orig):t=>t._dirty)}_notify(t){if(this.batchMode||!this.onChange)return this;const i=(t||[]).concat(this.getDirtyNodes());return this.onChange(i),this}cleanNodes(){return this.batchMode||this.nodes.forEach((t=>{delete t._dirty,delete t._lastTried})),this}saveInitial(){return this.nodes.forEach((t=>{t._orig=h.copyPos({},t),delete t._dirty})),this._hasLocked=this.nodes.some((t=>t.locked)),this}restoreInitial(){return this.nodes.forEach((t=>{t._orig&&!h.samePos(t,t._orig)&&(h.copyPos(t,t._orig),t._dirty=!0)})),this._notify(),this}findEmptyPosition(t,i=this.nodes,s=this.column,e){let r=!1;for(let n=e?e.y*s+(e.x+e.w):0;!r;++n){const e=n%s,o=Math.floor(n/s);if(e+t.w>s)continue;const a={x:e,y:o,w:t.w,h:t.h};i.find((t=>h.isIntercepted(a,t)))||(t.x===e&&t.y===o||(t._dirty=!0),t.x=e,t.y=o,delete t.autoPosition,r=!0)}return r}addNode(t,i=!1,s){const e=this.nodes.find((i=>i._id===t._id));if(e)return e;let h;return this._inColumnResize?this.nodeBoundFix(t):this.prepareNode(t),delete t._temporaryRemoved,delete t._removeDOM,t.autoPosition&&this.findEmptyPosition(t,this.nodes,this.column,s)&&(delete t.autoPosition,h=!0),this.nodes.push(t),i&&this.addedNodes.push(t),h||this._fixCollisions(t),this.batchMode||this._packNodes()._notify(),t}removeNode(t,i=!0,s=!1){return this.nodes.find((i=>i._id===t._id))?(s&&this.removedNodes.push(t),i&&(t._removeDOM=!0),this.nodes=this.nodes.filter((i=>i._id!==t._id)),t._isAboutToRemove||this._packNodes(),this._notify([t]),this):this}removeAll(t=!0,i=!0){if(delete this._layouts,!this.nodes.length)return this;t&&this.nodes.forEach((t=>t._removeDOM=!0));const s=this.nodes;return this.removedNodes=i?s:[],this.nodes=[],this._notify(s)}moveNodeCheck(t,i){if(!this.changedPosConstrain(t,i))return!1;if(i.pack=!0,!this.maxRow)return this.moveNode(t,i);let s;const e=new r({column:this.column,float:this.float,nodes:this.nodes.map((i=>i._id===t._id?(s={...i},s):{...i}))});if(!s)return!1;const n=e.moveNode(s,i)&&e.getRow()<=Math.max(this.getRow(),this.maxRow);return!n&&!i.resizing&&i.collide&&this.swap(t,i.collide.el.gridstackNode)?(this._notify(),!0):!!n&&(e.nodes.filter((t=>t._dirty)).forEach((t=>{const i=this.nodes.find((i=>i._id===t._id));i&&(h.copyPos(i,t),i._dirty=!0)})),this._notify(),!0)}willItFit(t){if(delete t._willFitPos,!this.maxRow)return!0;const i=new r({column:this.column,float:this.float,nodes:this.nodes.map((t=>({...t})))}),s={...t};return this.cleanupNode(s),delete s.el,delete s._id,delete s.content,delete s.grid,i.addNode(s),i.getRow()<=this.maxRow&&(t._willFitPos=h.copyPos({},s),!0)}changedPosConstrain(t,i){return i.w=i.w||t.w,i.h=i.h||t.h,t.x!==i.x||t.y!==i.y||(t.maxW&&(i.w=Math.min(i.w,t.maxW)),t.maxH&&(i.h=Math.min(i.h,t.maxH)),t.minW&&(i.w=Math.max(i.w,t.minW)),t.minH&&(i.h=Math.max(i.h,t.minH)),t.w!==i.w||t.h!==i.h)}moveNode(t,i){if(!t||!i)return!1;let s;void 0!==i.pack||this.batchMode||(s=i.pack=!0),"number"!=typeof i.x&&(i.x=t.x),"number"!=typeof i.y&&(i.y=t.y),"number"!=typeof i.w&&(i.w=t.w),"number"!=typeof i.h&&(i.h=t.h);const e=t.w!==i.w||t.h!==i.h,r=h.copyPos({},t,!0);if(h.copyPos(r,i),this.nodeBoundFix(r,e),h.copyPos(i,r),!i.forceCollide&&h.samePos(t,i))return!1;const n=h.copyPos({},t),o=this.collideAll(t,r,i.skip);let a=!0;if(o.length){const e=t._moving&&!i.nested;let n=e?this.directionCollideCoverage(t,i,o):o[0];if(e&&n&&t.grid?.opts?.subGridDynamic&&!t.grid._isTemp){const s=h.areaIntercept(i.rect,n._rect),e=h.area(i.rect),r=h.area(n._rect);s/(e<r?e:r)>.8&&(n.grid.makeSubGrid(n.el,void 0,t),n=void 0)}n?a=!this._fixCollisions(t,r,n,i):(a=!1,s&&delete i.pack)}return a&&!h.samePos(t,r)&&(t._dirty=!0,h.copyPos(t,r)),i.pack&&this._packNodes()._notify(),!h.samePos(t,n)}getRow(){return this.nodes.reduce(((t,i)=>Math.max(t,i.y+i.h)),0)}beginUpdate(t){return t._updating||(t._updating=!0,delete t._skipDown,this.batchMode||this.saveInitial()),this}endUpdate(){const t=this.nodes.find((t=>t._updating));return t&&(delete t._updating,delete t._skipDown),this}save(t=!0,i,s){const e=this._layouts?.length||0;let r;e&&(s?s!==this.column&&(r=this._layouts[s]):this.column!==e-1&&(r=this._layouts[e-1]));const n=[];return this.sortNodes(),this.nodes.forEach((s=>{const e=r?.find((t=>t._id===s._id)),o={...s,...e||{}};h.removeInternalForSave(o,!t),i&&i(s,o),n.push(o)})),n}layoutsNodesChange(t){return!this._layouts||this._inColumnResize||this._layouts.forEach(((i,s)=>{if(!i||s===this.column)return this;if(s<this.column)this._layouts[s]=void 0;else{const e=s/this.column;t.forEach((t=>{if(!t._orig)return;const s=i.find((i=>i._id===t._id));s&&(s.y>=0&&t.y!==t._orig.y&&(s.y+=t.y-t._orig.y,s.y<0&&(s.y=0)),t.x!==t._orig.x&&(s.x=Math.round(t.x*e),s.x<0&&(s.x=0)),t.w!==t._orig.w&&(s.w=Math.round(t.w*e),s.w<1&&(s.w=1)))}))}})),this}columnChanged(t,i,s="moveScale"){if(!this.nodes.length||!i||t===i)return this;const e="compact"===s||"list"===s;e&&this.sortNodes(1),i<t&&this.cacheLayout(this.nodes,t),this.batchUpdate();let r=[],n=e?this.nodes:h.sort(this.nodes,-1);if(i>t&&this._layouts){const s=this._layouts[i]||[],h=this._layouts.length-1;!s.length&&t!==h&&this._layouts[h]?.length&&(t=h,this._layouts[h].forEach((t=>{const i=n.find((i=>i._id===t._id));i&&(e||t.autoPosition||(i.x=t.x??i.x,i.y=t.y??i.y),i.w=t.w??i.w,null!=t.x&&void 0!==t.y||(i.autoPosition=!0))}))),s.forEach((t=>{const i=n.findIndex((i=>i._id===t._id));if(-1!==i){const s=n[i];if(e)return void(s.w=t.w);(t.autoPosition||isNaN(t.x)||isNaN(t.y))&&this.findEmptyPosition(t,r),t.autoPosition||(s.x=t.x??s.x,s.y=t.y??s.y,s.w=t.w??s.w,r.push(s)),n.splice(i,1)}}))}if(e)this.compact(s,!1);else{if(n.length)if("function"==typeof s)s(i,t,r,n);else{const h=e||"none"===s?1:i/t,o="move"===s||"moveScale"===s,a="scale"===s||"moveScale"===s;n.forEach((s=>{s.x=1===i?0:o?Math.round(s.x*h):Math.min(s.x,i-1),s.w=1===i||1===t?1:a?Math.round(s.w*h)||1:Math.min(s.w,i),r.push(s)})),n=[]}r=h.sort(r,-1),this._inColumnResize=!0,this.nodes=[],r.forEach((t=>{this.addNode(t,!1),delete t._orig}))}return this.nodes.forEach((t=>delete t._orig)),this.batchUpdate(!1,!e),delete this._inColumnResize,this}cacheLayout(t,i,s=!1){const e=[];return t.forEach(((t,i)=>{if(void 0===t._id){const i=t.id?this.nodes.find((i=>i.id===t.id)):void 0;t._id=i?._id??r._idSeq++}e[i]={x:t.x,y:t.y,w:t.w,_id:t._id}})),this._layouts=s?[]:this._layouts||[],this._layouts[i]=e,this}cacheOneLayout(t,i){t._id=t._id??r._idSeq++;const s={x:t.x,y:t.y,w:t.w,_id:t._id};(t.autoPosition||void 0===t.x)&&(delete s.x,delete s.y,t.autoPosition&&(s.autoPosition=!0)),this._layouts=this._layouts||[],this._layouts[i]=this._layouts[i]||[];const e=this.findCacheLayout(t,i);return-1===e?this._layouts[i].push(s):this._layouts[i][e]=s,this}findCacheLayout(t,i){return this._layouts?.[i]?.findIndex((i=>i._id===t._id))??-1}removeNodeFromLayoutCache(t){if(this._layouts)for(let i=0;i<this._layouts.length;i++){const s=this.findCacheLayout(t,i);-1!==s&&this._layouts[i].splice(s,1)}}cleanupNode(t){for(const i in t)"_"===i[0]&&"_id"!==i&&delete t[i];return this}}r._idSeq=0;const n={alwaysShowResizeHandle:"mobile",animate:!0,auto:!0,cellHeight:"auto",cellHeightThrottle:100,cellHeightUnit:"px",column:12,draggable:{handle:".grid-stack-item-content",appendTo:"body",scroll:!0},handle:".grid-stack-item-content",itemClass:"grid-stack-item",margin:10,marginUnit:"px",maxRow:0,minRow:0,placeholderClass:"grid-stack-placeholder",placeholderText:"",removableOptions:{accept:"grid-stack-item",decline:"grid-stack-non-removable"},resizable:{handles:"se"},rtl:"auto"};class o{}const a="undefined"!=typeof window&&"undefined"!=typeof document&&("ontouchstart"in document||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);class d{}function l(t,i){t.touches.length>1||(t.cancelable&&t.preventDefault(),h.simulateMouseEvent(t.changedTouches[0],i))}function c(t,i){t.cancelable&&t.preventDefault(),h.simulateMouseEvent(t,i)}function u(t){d.touchHandled||(d.touchHandled=!0,l(t,"mousedown"))}function g(t){d.touchHandled&&l(t,"mousemove")}function m(t){if(!d.touchHandled)return;d.pointerLeaveTimeout&&(window.clearTimeout(d.pointerLeaveTimeout),delete d.pointerLeaveTimeout);const i=!!o.dragElement;l(t,"mouseup"),i||l(t,"click"),d.touchHandled=!1}function p(t){"mouse"!==t.pointerType&&t.target.releasePointerCapture(t.pointerId)}function f(t){o.dragElement&&"mouse"!==t.pointerType&&c(t,"mouseenter")}function b(t){o.dragElement&&"mouse"!==t.pointerType&&(d.pointerLeaveTimeout=window.setTimeout((()=>{delete d.pointerLeaveTimeout,c(t,"mouseleave")}),10))}class v{constructor(t,i,s){this.host=t,this.dir=i,this.option=s,this.moving=!1,this._mouseDown=this._mouseDown.bind(this),this._mouseMove=this._mouseMove.bind(this),this._mouseUp=this._mouseUp.bind(this),this._keyEvent=this._keyEvent.bind(this),this._init()}_init(){if(this.option.element)try{this.el=this.option.element instanceof HTMLElement?this.option.element:this.host.querySelector(this.option.element)}catch(t){this.option.element=void 0,console.error("Query for resizeable handle failed, falling back",t)}return this.el||(this.el=document.createElement("div"),this.host.appendChild(this.el)),this.el.classList.add("ui-resizable-handle"),this.el.classList.add(`${v.prefix}${this.dir}`),this.el.style.zIndex="100",this.el.style.userSelect="none",this.el.addEventListener("mousedown",this._mouseDown),a&&(this.el.addEventListener("touchstart",u),this.el.addEventListener("pointerdown",p)),this}destroy(){return this.moving&&this._mouseUp(this.mouseDownEvent),this.el.removeEventListener("mousedown",this._mouseDown),a&&(this.el.removeEventListener("touchstart",u),this.el.removeEventListener("pointerdown",p)),this.option.element||this.host.removeChild(this.el),delete this.el,delete this.host,this}_mouseDown(t){this.mouseDownEvent=t,document.addEventListener("mousemove",this._mouseMove,{capture:!0,passive:!0}),document.addEventListener("mouseup",this._mouseUp,!0),a&&(this.el.addEventListener("touchmove",g),this.el.addEventListener("touchend",m)),t.stopPropagation(),t.preventDefault()}_mouseMove(t){const i=this.mouseDownEvent;this.moving?this._triggerEvent("move",t):Math.abs(t.x-i.x)+Math.abs(t.y-i.y)>2&&(this.moving=!0,this._triggerEvent("start",this.mouseDownEvent),this._triggerEvent("move",t),document.addEventListener("keydown",this._keyEvent)),t.stopPropagation()}_mouseUp(t){this.moving&&(this._triggerEvent("stop",t),document.removeEventListener("keydown",this._keyEvent)),document.removeEventListener("mousemove",this._mouseMove,!0),document.removeEventListener("mouseup",this._mouseUp,!0),a&&(this.el.removeEventListener("touchmove",g),this.el.removeEventListener("touchend",m)),delete this.moving,delete this.mouseDownEvent,t.stopPropagation(),t.preventDefault()}_keyEvent(t){"Escape"===t.key&&(this.host.gridstackNode?.grid?.engine.restoreInitial(),this._mouseUp(this.mouseDownEvent))}_triggerEvent(t,i){return this.option[t]&&this.option[t](i),this}}v.prefix="ui-resizable-";class w{constructor(){this._eventRegister={}}get disabled(){return this._disabled}on(t,i){this._eventRegister[t]=i}off(t){delete this._eventRegister[t]}enable(){this._disabled=!1}disable(){this._disabled=!0}destroy(){delete this._eventRegister}triggerEvent(t,i){if(!this.disabled&&this._eventRegister&&this._eventRegister[t])return this._eventRegister[t](i)}}class y extends w{constructor(t,i={}){super(),this.el=t,this.option=i,this.rectScale={x:1,y:1},this._ui=()=>{const t=this.el.parentElement.getBoundingClientRect(),i=this.temporalRect||{width:this.originalRect.width,height:this.originalRect.height+this.scrolled,left:this.originalRect.left,top:this.originalRect.top-this.scrolled};return{position:{left:(i.left-t.left)*this.rectScale.x,top:(i.top-t.top)*this.rectScale.y},size:{width:i.width*this.rectScale.x,height:i.height*this.rectScale.y}}},this._mouseOver=this._mouseOver.bind(this),this._mouseOut=this._mouseOut.bind(this),this.enable(),this._setupAutoHide(this.option.autoHide),this._setupHandlers()}on(t,i){super.on(t,i)}off(t){super.off(t)}enable(){super.enable(),this.el.classList.remove("ui-resizable-disabled"),this._setupAutoHide(this.option.autoHide)}disable(){super.disable(),this.el.classList.add("ui-resizable-disabled"),this._setupAutoHide(!1)}destroy(){this._removeHandlers(),this._setupAutoHide(!1),delete this.el,super.destroy()}updateOption(t){const i=t.handles&&t.handles!==this.option.handles,s=t.autoHide&&t.autoHide!==this.option.autoHide;return Object.keys(t).forEach((i=>this.option[i]=t[i])),i&&(this._removeHandlers(),this._setupHandlers()),s&&this._setupAutoHide(this.option.autoHide),this}_setupAutoHide(t){return t?(this.el.classList.add("ui-resizable-autohide"),this.el.addEventListener("mouseover",this._mouseOver),this.el.addEventListener("mouseout",this._mouseOut)):(this.el.classList.remove("ui-resizable-autohide"),this.el.removeEventListener("mouseover",this._mouseOver),this.el.removeEventListener("mouseout",this._mouseOut),o.overResizeElement===this&&delete o.overResizeElement),this}_mouseOver(t){o.overResizeElement||o.dragElement||(o.overResizeElement=this,this.el.classList.remove("ui-resizable-autohide"))}_mouseOut(t){o.overResizeElement===this&&(delete o.overResizeElement,this.el.classList.add("ui-resizable-autohide"))}_setupHandlers(){return this.handlers=this.option.handles.split(",").map((t=>t.trim())).map((t=>new v(this.el,t,{element:this.option.element,start:t=>this._resizeStart(t),stop:t=>this._resizeStop(t),move:i=>this._resizing(i,t)}))),this}_resizeStart(t){this.sizeToContent=h.shouldSizeToContent(this.el.gridstackNode,!0),this.originalRect=this.el.getBoundingClientRect(),this.scrollEl=h.getScrollElement(this.el),this.scrollY=this.scrollEl.scrollTop,this.scrolled=0,this.startEvent=t,this._setupHelper(),this._applyChange();const i=h.initEvent(t,{type:"resizestart",target:this.el});return this.option.start&&this.option.start(i,this._ui()),this.el.classList.add("ui-resizable-resizing"),this.triggerEvent("resizestart",i),this}_resizing(t,i){this.scrolled=this.scrollEl.scrollTop-this.scrollY,this.temporalRect=this._getChange(t,i),this._applyChange();const s=h.initEvent(t,{type:"resize",target:this.el});return this.option.resize&&this.option.resize(s,this._ui()),this.triggerEvent("resize",s),this}_resizeStop(t){const i=h.initEvent(t,{type:"resizestop",target:this.el});return this._cleanHelper(),this.option.stop&&this.option.stop(i),this.el.classList.remove("ui-resizable-resizing"),this.triggerEvent("resizestop",i),delete this.startEvent,delete this.originalRect,delete this.temporalRect,delete this.scrollY,delete this.scrolled,this}_setupHelper(){this.elOriginStyleVal=y._originStyleProp.map((t=>this.el.style[t])),this.parentOriginStylePosition=this.el.parentElement.style.position;const t=h.getValuesFromTransformedElement(this.el.parentElement);return this.rectScale={x:t.xScale,y:t.yScale},getComputedStyle(this.el.parentElement).position.match(/static/)&&(this.el.parentElement.style.position="relative"),this.el.style.position="absolute",this.el.style.opacity="0.8",this}_cleanHelper(){return y._originStyleProp.forEach(((t,i)=>{this.el.style[t]=this.elOriginStyleVal[i]||null})),this.el.parentElement.style.position=this.parentOriginStylePosition||null,this}_getChange(t,i){const s=this.startEvent,e={width:this.originalRect.width,height:this.originalRect.height+this.scrolled,left:this.originalRect.left,top:this.originalRect.top-this.scrolled},h=t.clientX-s.clientX,r=this.sizeToContent?0:t.clientY-s.clientY;let n,o;i.indexOf("e")>-1?e.width+=h:i.indexOf("w")>-1&&(e.width-=h,e.left+=h,n=!0),i.indexOf("s")>-1?e.height+=r:i.indexOf("n")>-1&&(e.height-=r,e.top+=r,o=!0);const a=this._constrainSize(e.width,e.height,n,o);return Math.round(e.width)!==Math.round(a.width)&&(i.indexOf("w")>-1&&(e.left+=e.width-a.width),e.width=a.width),Math.round(e.height)!==Math.round(a.height)&&(i.indexOf("n")>-1&&(e.top+=e.height-a.height),e.height=a.height),e}_constrainSize(t,i,s,e){const h=this.option,r=(e?h.maxHeightMoveUp:h.maxHeight)||Number.MAX_SAFE_INTEGER,n=h.minHeight/this.rectScale.y||i;return{width:Math.min((s?h.maxWidthMoveLeft:h.maxWidth)||Number.MAX_SAFE_INTEGER,Math.max(h.minWidth/this.rectScale.x||t,t)),height:Math.min(r,Math.max(n,i))}}_applyChange(){let t={left:0,top:0,width:0,height:0};if("absolute"===this.el.style.position){const i=this.el.parentElement,{left:s,top:e}=i.getBoundingClientRect();t={left:s,top:e,width:0,height:0}}return this.temporalRect?(Object.keys(this.temporalRect).forEach((i=>{this.el.style[i]=(this.temporalRect[i]-t[i])*("width"===i||"left"===i?this.rectScale.x:"height"===i||"top"===i?this.rectScale.y:1)+"px"})),this):this}_removeHandlers(){return this.handlers.forEach((t=>t.destroy())),delete this.handlers,this}}y._originStyleProp=["width","height","position","left","top","opacity","zIndex"];class k extends w{constructor(t,i={}){super(),this.el=t,this.option=i,this.dragTransform={xScale:1,yScale:1,xOffset:0,yOffset:0};const s=i?.handle?.substring(1),e=t.gridstackNode;this.dragEls=!s||t.classList.contains(s)?[t]:e?.subGrid?[t.querySelector(i.handle)||t]:Array.from(t.querySelectorAll(i.handle)),0===this.dragEls.length&&(this.dragEls=[t]),this._mouseDown=this._mouseDown.bind(this),this._mouseMove=this._mouseMove.bind(this),this._mouseUp=this._mouseUp.bind(this),this._keyEvent=this._keyEvent.bind(this),this.enable()}on(t,i){super.on(t,i)}off(t){super.off(t)}enable(){!1!==this.disabled&&(super.enable(),this.dragEls.forEach((t=>{t.addEventListener("mousedown",this._mouseDown),a&&(t.addEventListener("touchstart",u),t.addEventListener("pointerdown",p))})),this.el.classList.remove("ui-draggable-disabled"))}disable(t=!1){!0!==this.disabled&&(super.disable(),this.dragEls.forEach((t=>{t.removeEventListener("mousedown",this._mouseDown),a&&(t.removeEventListener("touchstart",u),t.removeEventListener("pointerdown",p))})),t||this.el.classList.add("ui-draggable-disabled"))}destroy(){this.dragTimeout&&window.clearTimeout(this.dragTimeout),delete this.dragTimeout,this.mouseDownEvent&&this._mouseUp(this.mouseDownEvent),this.disable(!0),delete this.el,delete this.helper,delete this.option,super.destroy()}updateOption(t){return Object.keys(t).forEach((i=>this.option[i]=t[i])),this}_mouseDown(t){if(!o.mouseHandled)return 0!==t.button||!this.dragEls.find((i=>i===t.target))&&t.target.closest('input,textarea,button,select,option,[contenteditable="true"],.ui-resizable-handle')||this.option.cancel&&t.target.closest(this.option.cancel)||(this.mouseDownEvent=t,delete this.dragging,delete o.dragElement,delete o.dropElement,document.addEventListener("mousemove",this._mouseMove,{capture:!0,passive:!0}),document.addEventListener("mouseup",this._mouseUp,!0),a&&(t.currentTarget.addEventListener("touchmove",g),t.currentTarget.addEventListener("touchend",m)),t.preventDefault(),document.activeElement&&document.activeElement.blur(),o.mouseHandled=!0),!0}_callDrag(t){if(!this.dragging)return;const i=h.initEvent(t,{target:this.el,type:"drag"});this.option.drag&&this.option.drag(i,this.ui()),this.triggerEvent("drag",i)}_mouseMove(t){const i=this.mouseDownEvent;if(this.lastDrag=t,this.dragging)if(this._dragFollow(t),o.pauseDrag){const i=Number.isInteger(o.pauseDrag)?o.pauseDrag:100;this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout((()=>this._callDrag(t)),i)}else this._callDrag(t);else if(Math.abs(t.x-i.x)+Math.abs(t.y-i.y)>3){this.dragging=!0,o.dragElement=this;const i=this.el.gridstackNode?.grid;i?o.dropElement=i.el.ddElement.ddDroppable:delete o.dropElement,this.helper=this._createHelper(),this._setupHelperContainmentStyle(),this.dragTransform=h.getValuesFromTransformedElement(this.helperContainment),this.dragOffset=this._getDragOffset(t,this.el,this.helperContainment),this._setupHelperStyle(t);const s=h.initEvent(t,{target:this.el,type:"dragstart"});this.option.start&&this.option.start(s,this.ui()),this.triggerEvent("dragstart",s),document.addEventListener("keydown",this._keyEvent)}return!0}_mouseUp(t){if(document.removeEventListener("mousemove",this._mouseMove,!0),document.removeEventListener("mouseup",this._mouseUp,!0),a&&t.currentTarget&&(t.currentTarget.removeEventListener("touchmove",g,!0),t.currentTarget.removeEventListener("touchend",m,!0)),this.dragging){delete this.dragging,delete this.el.gridstackNode?._origRotate,document.removeEventListener("keydown",this._keyEvent),o.dropElement?.el===this.el.parentElement&&delete o.dropElement,this.helperContainment.style.position=this.parentOriginStylePosition||null,this.helper!==this.el&&this.helper.remove(),this._removeHelperStyle();const i=h.initEvent(t,{target:this.el,type:"dragstop"});this.option.stop&&this.option.stop(i),this.triggerEvent("dragstop",i),o.dropElement&&o.dropElement.drop(t)}delete this.helper,delete this.mouseDownEvent,delete o.dragElement,delete o.dropElement,delete o.mouseHandled,t.preventDefault()}_keyEvent(t){const i=this.el.gridstackNode,s=i?.grid||o.dropElement?.el?.gridstack;if("Escape"===t.key)i&&i._origRotate&&(i._orig=i._origRotate,delete i._origRotate),s?.cancelDrag(),this._mouseUp(this.mouseDownEvent);else if(i&&s&&("r"===t.key||"R"===t.key)){if(!h.canBeRotated(i))return;i._origRotate=i._origRotate||{...i._orig},delete i._moving,s.setAnimation(!1).rotate(i.el,{top:-this.dragOffset.offsetTop,left:-this.dragOffset.offsetLeft}).setAnimation(),i._moving=!0,this.dragOffset=this._getDragOffset(this.lastDrag,i.el,this.helperContainment),this.helper.style.width=this.dragOffset.width+"px",this.helper.style.height=this.dragOffset.height+"px",h.swap(i._orig,"w","h"),delete i._rect,this._mouseMove(this.lastDrag)}}_createHelper(){let t=this.el;return"function"==typeof this.option.helper?t=this.option.helper(this.el):"clone"===this.option.helper&&(t=h.cloneNode(this.el)),t.parentElement||h.appendTo(t,"parent"===this.option.appendTo?this.el.parentElement:this.option.appendTo),this.dragElementOriginStyle=k.originStyleProp.map((t=>this.el.style[t])),t}_setupHelperStyle(t){this.helper.classList.add("ui-draggable-dragging"),this.el.gridstackNode?.grid?.el.classList.add("grid-stack-dragging");const i=this.helper.style;return i.pointerEvents="none",i.width=this.dragOffset.width+"px",i.height=this.dragOffset.height+"px",i.willChange="left, top",i.position="fixed",this._dragFollow(t),i.transition="none",setTimeout((()=>{this.helper&&(i.transition=null)}),0),this}_removeHelperStyle(){this.helper.classList.remove("ui-draggable-dragging"),this.el.gridstackNode?.grid?.el.classList.remove("grid-stack-dragging");const t=this.helper?.gridstackNode;if(!t?._isAboutToRemove&&this.dragElementOriginStyle){const t=this.helper,i=this.dragElementOriginStyle.transition||null;t.style.transition=this.dragElementOriginStyle.transition="none",k.originStyleProp.forEach((i=>t.style[i]=this.dragElementOriginStyle[i]||null)),setTimeout((()=>t.style.transition=i),50)}return delete this.dragElementOriginStyle,this}_dragFollow(t){const i=this.helper.style,s=this.dragOffset;i.left=(t.clientX+s.offsetLeft-0)*this.dragTransform.xScale+"px",i.top=(t.clientY+s.offsetTop-0)*this.dragTransform.yScale+"px"}_setupHelperContainmentStyle(){return this.helperContainment=this.helper.parentElement,"fixed"!==this.helper.style.position&&(this.parentOriginStylePosition=this.helperContainment.style.position,getComputedStyle(this.helperContainment).position.match(/static/)&&(this.helperContainment.style.position="relative")),this}_getDragOffset(t,i,s){let e=0,h=0;s&&(e=this.dragTransform.xOffset,h=this.dragTransform.yOffset);const r=i.getBoundingClientRect();return{left:r.left,top:r.top,offsetLeft:-t.clientX+r.left-e,offsetTop:-t.clientY+r.top-h,width:r.width*this.dragTransform.xScale,height:r.height*this.dragTransform.yScale}}ui(){const t=this.el.parentElement.getBoundingClientRect(),i=this.helper.getBoundingClientRect();return{position:{top:(i.top-t.top)*this.dragTransform.yScale,left:(i.left-t.left)*this.dragTransform.xScale}}}}k.originStyleProp=["width","height","transform","transform-origin","transition","pointerEvents","position","left","top","minWidth","willChange"];class z extends w{constructor(t,i={}){super(),this.el=t,this.option=i,this._mouseEnter=this._mouseEnter.bind(this),this._mouseLeave=this._mouseLeave.bind(this),this.enable(),this._setupAccept()}on(t,i){super.on(t,i)}off(t){super.off(t)}enable(){!1!==this.disabled&&(super.enable(),this.el.classList.add("ui-droppable"),this.el.classList.remove("ui-droppable-disabled"),this.el.addEventListener("mouseenter",this._mouseEnter),this.el.addEventListener("mouseleave",this._mouseLeave),a&&(this.el.addEventListener("pointerenter",f),this.el.addEventListener("pointerleave",b)))}disable(t=!1){!0!==this.disabled&&(super.disable(),this.el.classList.remove("ui-droppable"),t||this.el.classList.add("ui-droppable-disabled"),this.el.removeEventListener("mouseenter",this._mouseEnter),this.el.removeEventListener("mouseleave",this._mouseLeave),a&&(this.el.removeEventListener("pointerenter",f),this.el.removeEventListener("pointerleave",b)))}destroy(){this.disable(!0),this.el.classList.remove("ui-droppable"),this.el.classList.remove("ui-droppable-disabled"),super.destroy()}updateOption(t){return Object.keys(t).forEach((i=>this.option[i]=t[i])),this._setupAccept(),this}_mouseEnter(t){if(!o.dragElement)return;if(a&&t.isTrusted)return;if(!this._canDrop(o.dragElement.el))return;t.preventDefault(),t.stopPropagation(),o.dropElement&&o.dropElement!==this&&o.dropElement._mouseLeave(t,!0),o.dropElement=this;const i=h.initEvent(t,{target:this.el,type:"dropover"});this.option.over&&this.option.over(i,this._ui(o.dragElement)),this.triggerEvent("dropover",i),this.el.classList.add("ui-droppable-over")}_mouseLeave(t,i=!1){if(!o.dragElement||o.dropElement!==this)return;t.preventDefault(),t.stopPropagation();const s=h.initEvent(t,{target:this.el,type:"dropout"});if(this.option.out&&this.option.out(s,this._ui(o.dragElement)),this.triggerEvent("dropout",s),o.dropElement===this&&(delete o.dropElement,!i)){let i,s=this.el.parentElement;for(;!i&&s;)i=s.ddElement?.ddDroppable,s=s.parentElement;i&&i._mouseEnter(t)}}drop(t){t.preventDefault();const i=h.initEvent(t,{target:this.el,type:"drop"});this.option.drop&&this.option.drop(i,this._ui(o.dragElement)),this.triggerEvent("drop",i)}_canDrop(t){return t&&(!this.accept||this.accept(t))}_setupAccept(){return this.option.accept?(this.accept="string"==typeof this.option.accept?t=>t.classList.contains(this.option.accept)||t.matches(this.option.accept):this.option.accept,this):this}_ui(t){return{draggable:t.el,...t.ui()}}}class x{static init(t){return t.ddElement||(t.ddElement=new x(t)),t.ddElement}constructor(t){this.el=t}on(t,i){return this.ddDraggable&&["drag","dragstart","dragstop"].indexOf(t)>-1?this.ddDraggable.on(t,i):this.ddDroppable&&["drop","dropover","dropout"].indexOf(t)>-1?this.ddDroppable.on(t,i):this.ddResizable&&["resizestart","resize","resizestop"].indexOf(t)>-1&&this.ddResizable.on(t,i),this}off(t){return this.ddDraggable&&["drag","dragstart","dragstop"].indexOf(t)>-1?this.ddDraggable.off(t):this.ddDroppable&&["drop","dropover","dropout"].indexOf(t)>-1?this.ddDroppable.off(t):this.ddResizable&&["resizestart","resize","resizestop"].indexOf(t)>-1&&this.ddResizable.off(t),this}setupDraggable(t){return this.ddDraggable?this.ddDraggable.updateOption(t):this.ddDraggable=new k(this.el,t),this}cleanDraggable(){return this.ddDraggable&&(this.ddDraggable.destroy(),delete this.ddDraggable),this}setupResizable(t){return this.ddResizable?this.ddResizable.updateOption(t):this.ddResizable=new y(this.el,t),this}cleanResizable(){return this.ddResizable&&(this.ddResizable.destroy(),delete this.ddResizable),this}setupDroppable(t){return this.ddDroppable?this.ddDroppable.updateOption(t):this.ddDroppable=new z(this.el,t),this}cleanDroppable(){return this.ddDroppable&&(this.ddDroppable.destroy(),delete this.ddDroppable),this}}
/*!
 * GridStack 12.4.1
 * https://gridstackjs.com/
 *
 * Copyright (c) 2021-2025  Alain Dumesny
 * see root license https://github.com/gridstack/gridstack.js/tree/master/LICENSE
 */
const M=new class{resizable(t,i,s,e){return this._getDDElements(t,i).forEach((t=>{if("disable"===i||"enable"===i)t.ddResizable&&t.ddResizable[i]();else if("destroy"===i)t.ddResizable&&t.cleanResizable();else if("option"===i)t.setupResizable({[s]:e});else{const s=t.el.gridstackNode.grid;let e=t.el.getAttribute("gs-resize-handles")||s.opts.resizable.handles||"e,s,se";"all"===e&&(e="n,e,s,w,se,sw,ne,nw"),t.setupResizable({...s.opts.resizable,handles:e,autoHide:!s.opts.alwaysShowResizeHandle,start:i.start,stop:i.stop,resize:i.resize})}})),this}draggable(t,i,s,e){return this._getDDElements(t,i).forEach((t=>{"disable"===i||"enable"===i?t.ddDraggable&&t.ddDraggable[i]():"destroy"===i?t.ddDraggable&&t.cleanDraggable():t.setupDraggable("option"===i?{[s]:e}:{...t.el.gridstackNode.grid.opts.draggable,start:i.start,stop:i.stop,drag:i.drag})})),this}dragIn(t,i){return this._getDDElements(t).forEach((t=>t.setupDraggable(i))),this}droppable(t,i,s,e){return"function"!=typeof i.accept||i._accept||(i._accept=i.accept,i.accept=t=>i._accept(t)),this._getDDElements(t,i).forEach((t=>{"disable"===i||"enable"===i?t.ddDroppable&&t.ddDroppable[i]():"destroy"===i?t.ddDroppable&&t.cleanDroppable():t.setupDroppable("option"===i?{[s]:e}:i)})),this}isDroppable(t){return!(!t?.ddElement?.ddDroppable||t.ddElement.ddDroppable.disabled)}isDraggable(t){return!(!t?.ddElement?.ddDraggable||t.ddElement.ddDraggable.disabled)}isResizable(t){return!(!t?.ddElement?.ddResizable||t.ddElement.ddResizable.disabled)}on(t,i,s){return this._getDDElements(t).forEach((t=>t.on(i,(t=>{s(t,o.dragElement?o.dragElement.el:t.target,o.dragElement?o.dragElement.helper:null)})))),this}off(t,i){return this._getDDElements(t).forEach((t=>t.off(i))),this}_getDDElements(t,i){const s=t.gridstack||"destroy"!==i&&"disable"!==i,e=h.getElements(t);return e.length?e.map((t=>t.ddElement||(s?x.init(t):null))).filter((t=>t)):[]}};class _{static init(t={},i=".grid-stack"){if("undefined"==typeof document)return null;const s=_.getGridElement(i);return s?(s.gridstack||(s.gridstack=new _(s,h.cloneDeep(t))),s.gridstack):("string"==typeof i?console.error('GridStack.initAll() no grid was found with selector "'+i+'" - element missing or wrong selector ?\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.'):console.error("GridStack.init() no grid element was passed."),null)}static initAll(t={},i=".grid-stack"){const s=[];return"undefined"==typeof document||(_.getGridElements(i).forEach((i=>{i.gridstack||(i.gridstack=new _(i,h.cloneDeep(t))),s.push(i.gridstack)})),0===s.length&&console.error('GridStack.initAll() no grid was found with selector "'+i+'" - element missing or wrong selector ?\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.')),s}static addGrid(t,i={}){if(!t)return null;let s=t;if(s.gridstack){const t=s.gridstack;return i&&(t.opts={...t.opts,...i}),void 0!==i.children&&t.load(i.children),t}return t.classList.contains("grid-stack")&&!_.addRemoveCB||(s=_.addRemoveCB?_.addRemoveCB(t,i,!0,!0):h.createDiv(["grid-stack",i.class],t)),_.init(i,s)}static registerEngine(t){_.engineClass=t}get placeholder(){if(!this._placeholder){this._placeholder=h.createDiv([this.opts.placeholderClass,n.itemClass,this.opts.itemClass]);const t=h.createDiv(["placeholder-content"],this._placeholder);this.opts.placeholderText&&(t.textContent=this.opts.placeholderText)}return this._placeholder}constructor(t,i={}){this.el=t,this.opts=i,this.animationDelay=310,this._gsEventHandler={},this._extraDragRow=0,this.dragTransform={xScale:1,yScale:1,xOffset:0,yOffset:0},t.gridstack=this,this.opts=i=i||{},t.classList.contains("grid-stack")||this.el.classList.add("grid-stack"),i.row&&(i.minRow=i.maxRow=i.row,delete i.row);const s=h.toNumber(t.getAttribute("gs-row"));"auto"===i.column&&delete i.column,void 0!==i.alwaysShowResizeHandle&&(i._alwaysShowResizeHandle=i.alwaysShowResizeHandle);const e=i.columnOpts;if(e){const t=e.breakpoints;e.columnWidth||t?.length?(e.columnMax=e.columnMax||12,t?.length>1&&t.sort(((t,i)=>(i.w||0)-(t.w||0)))):delete i.columnOpts}const d={...h.cloneDeep(n),column:h.toNumber(t.getAttribute("gs-column"))||n.column,minRow:s||h.toNumber(t.getAttribute("gs-min-row"))||n.minRow,maxRow:s||h.toNumber(t.getAttribute("gs-max-row"))||n.maxRow,staticGrid:h.toBool(t.getAttribute("gs-static"))||n.staticGrid,sizeToContent:h.toBool(t.getAttribute("gs-size-to-content"))||void 0,draggable:{handle:(i.handleClass?"."+i.handleClass:i.handle?i.handle:"")||n.draggable.handle},removableOptions:{accept:i.itemClass||n.removableOptions.accept,decline:n.removableOptions.decline}};t.getAttribute("gs-animate")&&(d.animate=h.toBool(t.getAttribute("gs-animate"))),i=h.defaults(i,d),this._initMargin(),this.checkDynamicColumn(),this._updateColumnVar(i),"auto"===i.rtl&&(i.rtl="rtl"===t.style.direction),i.rtl&&this.el.classList.add("grid-stack-rtl");const l=this.el.closest("."+n.itemClass),c=l?.gridstackNode;if(c&&(c.subGrid=this,this.parentGridNode=c,this.el.classList.add("grid-stack-nested"),c.el.classList.add("grid-stack-sub-grid")),this._isAutoCellHeight="auto"===i.cellHeight,this._isAutoCellHeight||"initial"===i.cellHeight)this.cellHeight(void 0);else{"number"==typeof i.cellHeight&&i.cellHeightUnit&&i.cellHeightUnit!==n.cellHeightUnit&&(i.cellHeight=i.cellHeight+i.cellHeightUnit,delete i.cellHeightUnit);const t=i.cellHeight;delete i.cellHeight,this.cellHeight(t)}if("mobile"===i.alwaysShowResizeHandle&&(i.alwaysShowResizeHandle=a),this._setStaticClass(),this.engine=new(i.engineClass||_.engineClass||r)({column:this.getColumn(),float:i.float,maxRow:i.maxRow,onChange:t=>{t.forEach((t=>{const i=t.el;i&&(t._removeDOM?(i&&i.remove(),delete t._removeDOM):this._writePosAttr(i,t))})),this._updateContainerHeight()}}),i.auto&&(this.batchUpdate(),this.engine._loading=!0,this.getGridItems().forEach((t=>this._prepareElement(t))),delete this.engine._loading,this.batchUpdate(!1)),i.children){const t=i.children;delete i.children,t.length&&this.load(t)}this.setAnimation(),i.subGridDynamic&&!o.pauseDrag&&(o.pauseDrag=!0),void 0!==i.draggable?.pause&&(o.pauseDrag=i.draggable.pause),this._setupRemoveDrop(),this._setupAcceptWidget(),this._updateResizeEvent()}_updateColumnVar(t=this.opts){this.el.classList.add("gs-"+t.column),"number"==typeof t.column&&this.el.style.setProperty("--gs-column-width",100/t.column+"%")}addWidget(t){if(!t)return;if("string"==typeof t)return void console.error("V11: GridStack.addWidget() does not support string anymore. see #2736");if(t.ELEMENT_NODE)return console.error("V11: GridStack.addWidget() does not support HTMLElement anymore. use makeWidget()"),this.makeWidget(t);let i,s=t;if(s.grid=this,i=s.el?s.el:_.addRemoveCB?_.addRemoveCB(this.el,t,!0,!1):this.createWidgetDivs(s),!i)return;if(s=i.gridstackNode,s&&i.parentElement===this.el&&this.engine.nodes.find((t=>t._id===s._id)))return i;const e=this._readAttr(i);return h.defaults(t,e),this.engine.prepareNode(t),this.el.appendChild(i),this.makeWidget(i,t),i}createWidgetDivs(t){const i=h.createDiv(["grid-stack-item",this.opts.itemClass]),s=h.createDiv(["grid-stack-item-content"],i);return h.lazyLoad(t)?t.visibleObservable||(t.visibleObservable=new IntersectionObserver((([i])=>{i.isIntersecting&&(t.visibleObservable?.disconnect(),delete t.visibleObservable,_.renderCB(s,t),t.grid?.prepareDragDrop(t.el))})),window.setTimeout((()=>t.visibleObservable?.observe(i)))):_.renderCB(s,t),i}makeSubGrid(t,i,s,e=!0){let r,n=t.gridstackNode;if(n||(n=this.makeWidget(t).gridstackNode),n.subGrid?.el)return n.subGrid;let o,a=this;for(;a&&!r;)r=a.opts?.subGridOpts,a=a.parentGridNode?.grid;i=h.cloneDeep({...this.opts,id:void 0,children:void 0,column:"auto",columnOpts:void 0,layout:"list",subGridOpts:void 0,...r||{},...i||n.subGridOpts||{}}),n.subGridOpts=i,"auto"===i.column&&(o=!0,i.column=Math.max(n.w||1,s?.w||1),delete i.columnOpts);let d,l,c=n.el.querySelector(".grid-stack-item-content");if(e&&(this._removeDD(n.el),l={...n,x:0,y:0},h.removeInternalForSave(l),delete l.subGridOpts,n.content&&(l.content=n.content,delete n.content),_.addRemoveCB?d=_.addRemoveCB(this.el,l,!0,!1):(d=h.createDiv(["grid-stack-item"]),d.appendChild(c),c=h.createDiv(["grid-stack-item-content"],n.el)),this.prepareDragDrop(n.el)),s){const t=o?i.column:n.w,e=n.h+s.h,h=n.el.style;h.transition="none",this.update(n.el,{w:t,h:e}),setTimeout((()=>h.transition=null))}const u=n.subGrid=_.addGrid(c,i);return s?._moving&&(u._isTemp=!0),o&&(u._autoColumn=!0),e&&u.makeWidget(d,l),s&&(s._moving?window.setTimeout((()=>h.simulateMouseEvent(s._event,"mouseenter",u.el)),0):u.makeWidget(n.el,n)),this.resizeToContentCheck(!1,n),u}removeAsSubGrid(t){const i=this.parentGridNode?.grid;i&&(i.batchUpdate(),i.removeWidget(this.parentGridNode.el,!0,!0),this.engine.nodes.forEach((t=>{t.x+=this.parentGridNode.x,t.y+=this.parentGridNode.y,i.makeWidget(t.el,t)})),i.batchUpdate(!1),this.parentGridNode&&delete this.parentGridNode.subGrid,delete this.parentGridNode,t&&window.setTimeout((()=>h.simulateMouseEvent(t._event,"mouseenter",i.el)),0))}save(t=!0,i=!1,s=_.saveCB,e){const r=this.engine.save(t,s,e);if(r.forEach((e=>{if(t&&e.el&&!e.subGrid&&!s){const t=e.el.querySelector(".grid-stack-item-content");e.content=t?.innerHTML,e.content||delete e.content}else if(t||s||delete e.content,e.subGrid?.el){const h=e.w||e.subGrid.getColumn(),r=e.subGrid.save(t,i,s,h);e.subGridOpts=i?r:{children:r},delete e.subGrid}delete e.el})),i){const t=h.cloneDeep(this.opts);t.marginBottom===t.marginTop&&t.marginRight===t.marginLeft&&t.marginTop===t.marginRight&&(t.margin=t.marginTop,delete t.marginTop,delete t.marginRight,delete t.marginBottom,delete t.marginLeft),t.rtl===("rtl"===this.el.style.direction)&&(t.rtl="auto"),this._isAutoCellHeight&&(t.cellHeight="auto"),this._autoColumn&&(t.column="auto");const i=t._alwaysShowResizeHandle;return delete t._alwaysShowResizeHandle,void 0!==i?t.alwaysShowResizeHandle=i:delete t.alwaysShowResizeHandle,h.removeInternalAndSame(t,n),t.children=r,t}return r}load(t,i=_.addRemoveCB||!0){t=h.cloneDeep(t);const s=this.getColumn();t.forEach((t=>{t.w=t.w||t.minW||1,t.h=t.h||t.minH||1})),t=h.sort(t),this.engine.skipCacheUpdate=this._ignoreLayoutsNodeChange=!0;let e=0;t.forEach((t=>{e=Math.max(e,(t.x||0)+t.w)})),e>this.engine.defaultColumn&&(this.engine.defaultColumn=e),e>s&&(0===this.engine.nodes.length&&this.responseLayout?(this.engine.nodes=t,this.engine.columnChanged(e,s,this.responseLayout),t=this.engine.nodes,this.engine.nodes=[],delete this.responseLayout):this.engine.cacheLayout(t,e,!0));const r=_.addRemoveCB;"function"==typeof i&&(_.addRemoveCB=i);const n=[];this.batchUpdate();const o=!this.engine.nodes.length,a=o&&this.opts.animate;a&&this.setAnimation(!1),!o&&i&&[...this.engine.nodes].forEach((i=>{i.id&&(h.find(t,i.id)||(_.addRemoveCB&&_.addRemoveCB(this.el,i,!1,!1),n.push(i),this.removeWidget(i.el,!0,!1)))})),this.engine._loading=!0;const d=[];return this.engine.nodes=this.engine.nodes.filter((i=>!h.find(t,i.id)||(d.push(i),!1))),t.forEach((t=>{const s=h.find(d,t.id);if(s){if(h.shouldSizeToContent(s)&&(t.h=s.h),this.engine.nodeBoundFix(t),(t.autoPosition||void 0===t.x||void 0===t.y)&&(t.w=t.w||s.w,t.h=t.h||s.h,this.engine.findEmptyPosition(t)),this.engine.nodes.push(s),h.samePos(s,t)&&this.engine.nodes.length>1&&(this.moveNode(s,{...t,forceCollide:!0}),h.copyPos(t,s)),this.update(s.el,t),t.subGridOpts?.children){const i=s.el.querySelector(".grid-stack");i&&i.gridstack&&i.gridstack.load(t.subGridOpts.children)}}else i&&this.addWidget(t)})),delete this.engine._loading,this.engine.removedNodes=n,this.batchUpdate(!1),delete this._ignoreLayoutsNodeChange,delete this.engine.skipCacheUpdate,r?_.addRemoveCB=r:delete _.addRemoveCB,a&&this.setAnimation(!0,!0),this}batchUpdate(t=!0){return this.engine.batchUpdate(t),t||(this._updateContainerHeight(),this._triggerRemoveEvent(),this._triggerAddEvent(),this._triggerChangeEvent()),this}getCellHeight(t=!1){if(this.opts.cellHeight&&"auto"!==this.opts.cellHeight&&(!t||!this.opts.cellHeightUnit||"px"===this.opts.cellHeightUnit))return this.opts.cellHeight;if("rem"===this.opts.cellHeightUnit)return this.opts.cellHeight*parseFloat(getComputedStyle(document.documentElement).fontSize);if("em"===this.opts.cellHeightUnit)return this.opts.cellHeight*parseFloat(getComputedStyle(this.el).fontSize);if("cm"===this.opts.cellHeightUnit)return this.opts.cellHeight*(96/2.54);if("mm"===this.opts.cellHeightUnit)return this.opts.cellHeight*(96/2.54)/10;const i=this.el.querySelector("."+this.opts.itemClass);if(i){const t=h.toNumber(i.getAttribute("gs-h"))||1;return Math.round(i.offsetHeight/t)}const s=parseInt(this.el.getAttribute("gs-current-row"));return s?Math.round(this.el.getBoundingClientRect().height/s):this.opts.cellHeight}cellHeight(t){if(void 0!==t&&this._isAutoCellHeight!==("auto"===t)&&(this._isAutoCellHeight="auto"===t,this._updateResizeEvent()),"initial"!==t&&"auto"!==t||(t=void 0),void 0===t){const i=-this.opts.marginRight-this.opts.marginLeft+this.opts.marginTop+this.opts.marginBottom;t=this.cellWidth()+i}const i=h.parseHeight(t);return this.opts.cellHeightUnit===i.unit&&this.opts.cellHeight===i.h||(this.opts.cellHeightUnit=i.unit,this.opts.cellHeight=i.h,this.el.style.setProperty("--gs-cell-height",`${this.opts.cellHeight}${this.opts.cellHeightUnit}`),this._updateContainerHeight(),this.resizeToContentCheck()),this}cellWidth(){return this._widthOrContainer()/this.getColumn()}_widthOrContainer(t=!1){return t&&this.opts.columnOpts?.breakpointForWindow?window.innerWidth:this.el.clientWidth||this.el.parentElement.clientWidth||window.innerWidth}checkDynamicColumn(){const t=this.opts.columnOpts;if(!t||!t.columnWidth&&!t.breakpoints?.length)return!1;const i=this.getColumn();let s=i;const e=this._widthOrContainer(!0);if(t.columnWidth)s=Math.min(Math.round(e/t.columnWidth)||1,t.columnMax);else{s=t.columnMax;let h=0;for(;h<t.breakpoints.length&&e<=t.breakpoints[h].w;)s=t.breakpoints[h++].c||i}if(s!==i){const i=t.breakpoints?.find((t=>t.c===s));return this.column(s,i?.layout||t.layout),!0}return!1}compact(t="compact",i=!0){return this.engine.compact(t,i),this._triggerChangeEvent(),this}column(t,i="moveScale"){if(!t||t<1||this.opts.column===t)return this;const s=this.getColumn();return this.opts.column=t,this.engine?(this.engine.column=t,this.el.classList.remove("gs-"+s),this._updateColumnVar(),this.engine.columnChanged(s,t,i),this._isAutoCellHeight&&this.cellHeight(),this.resizeToContentCheck(!0),this._ignoreLayoutsNodeChange=!0,this._triggerChangeEvent(),delete this._ignoreLayoutsNodeChange,this):(this.responseLayout=i,this)}getColumn(){return this.opts.column}getGridItems(){return Array.from(this.el.children).filter((t=>t.matches("."+this.opts.itemClass)&&!t.matches("."+this.opts.placeholderClass)))}isIgnoreChangeCB(){return this._ignoreLayoutsNodeChange}destroy(t=!0){if(this.el)return this.offAll(),this._updateResizeEvent(!0),this.setStatic(!0,!1),this.setAnimation(!1),t?this.el.parentNode.removeChild(this.el):(this.removeAll(t),this.el.removeAttribute("gs-current-row")),this.parentGridNode&&delete this.parentGridNode.subGrid,delete this.parentGridNode,delete this.opts,delete this._placeholder?.gridstackNode,delete this._placeholder,delete this.engine,delete this.el.gridstack,delete this.el,this}float(t){return this.opts.float!==t&&(this.opts.float=this.engine.float=t,this._triggerChangeEvent()),this}getFloat(){return this.engine.float}getCellFromPixel(t,i=!1){const s=this.el.getBoundingClientRect();let e;e=i?{top:s.top+document.documentElement.scrollTop,left:s.left}:{top:this.el.offsetTop,left:this.el.offsetLeft};const h=t.left-e.left,r=t.top-e.top,n=s.width/this.getColumn(),o=s.height/parseInt(this.el.getAttribute("gs-current-row"));return{x:Math.floor(h/n),y:Math.floor(r/o)}}getRow(){return Math.max(this.engine.getRow(),this.opts.minRow||0)}isAreaEmpty(t,i,s,e){return this.engine.isAreaEmpty(t,i,s,e)}makeWidget(t,i){const s=_.getElement(t);if(!s||s.gridstackNode)return s;s.parentElement||this.el.appendChild(s),this._prepareElement(s,!0,i);const e=s.gridstackNode;let h;return this._updateContainerHeight(),e.subGridOpts&&this.makeSubGrid(s,e.subGridOpts,void 0,!1),1!==this.opts.column||this._ignoreLayoutsNodeChange||(h=this._ignoreLayoutsNodeChange=!0),this._triggerAddEvent(),this._triggerChangeEvent(),h&&delete this._ignoreLayoutsNodeChange,s}on(t,i){return-1!==t.indexOf(" ")?(t.split(" ").forEach((t=>this.on(t,i))),this):("change"===t||"added"===t||"removed"===t||"enable"===t||"disable"===t?(this._gsEventHandler[t]="enable"===t||"disable"===t?t=>i(t):t=>{t.detail&&i(t,t.detail)},this.el.addEventListener(t,this._gsEventHandler[t])):"drag"===t||"dragstart"===t||"dragstop"===t||"resizestart"===t||"resize"===t||"resizestop"===t||"dropped"===t||"resizecontent"===t?this._gsEventHandler[t]=i:console.error("GridStack.on("+t+") event not supported"),this)}off(t){return-1!==t.indexOf(" ")?(t.split(" ").forEach((t=>this.off(t))),this):("change"!==t&&"added"!==t&&"removed"!==t&&"enable"!==t&&"disable"!==t||this._gsEventHandler[t]&&this.el.removeEventListener(t,this._gsEventHandler[t]),delete this._gsEventHandler[t],this)}offAll(){return Object.keys(this._gsEventHandler).forEach((t=>this.off(t))),this}removeWidget(t,i=!0,s=!0){return t?(_.getElements(t).forEach((t=>{if(t.parentElement&&t.parentElement!==this.el)return;let e=t.gridstackNode;e||(e=this.engine.nodes.find((i=>t===i.el))),e&&(i&&_.addRemoveCB&&_.addRemoveCB(this.el,e,!1,!1),delete t.gridstackNode,this._removeDD(t),this.engine.removeNode(e,i,s),i&&t.parentElement&&t.remove())})),s&&(this._triggerRemoveEvent(),this._triggerChangeEvent()),this):(console.error("Error: GridStack.removeWidget(undefined) called"),this)}removeAll(t=!0,i=!0){return this.engine.nodes.forEach((i=>{t&&_.addRemoveCB&&_.addRemoveCB(this.el,i,!1,!1),delete i.el.gridstackNode,this.opts.staticGrid||this._removeDD(i.el)})),this.engine.removeAll(t,i),i&&this._triggerRemoveEvent(),this}setAnimation(t=this.opts.animate,i){return i?setTimeout((()=>{this.opts&&this.setAnimation(t)})):t?this.el.classList.add("grid-stack-animate"):this.el.classList.remove("grid-stack-animate"),this.opts.animate=t,this}hasAnimationCSS(){return this.el.classList.contains("grid-stack-animate")}setStatic(t,i=!0,s=!0){return!!this.opts.staticGrid===t||(t?this.opts.staticGrid=!0:delete this.opts.staticGrid,this._setupRemoveDrop(),this._setupAcceptWidget(),this.engine.nodes.forEach((e=>{this.prepareDragDrop(e.el),e.subGrid&&s&&e.subGrid.setStatic(t,i,s)})),i&&this._setStaticClass()),this}updateOptions(t){const i=this.opts;return t===i||(void 0!==t.acceptWidgets&&(i.acceptWidgets=t.acceptWidgets,this._setupAcceptWidget()),void 0!==t.animate&&this.setAnimation(t.animate),t.cellHeight&&this.cellHeight(t.cellHeight),void 0!==t.class&&t.class!==i.class&&(i.class&&this.el.classList.remove(i.class),t.class&&this.el.classList.add(t.class)),t.columnOpts?(this.opts.columnOpts=t.columnOpts,this.checkDynamicColumn()):null===t.columnOpts&&this.opts.columnOpts?(delete this.opts.columnOpts,this._updateResizeEvent()):"number"==typeof t.column&&this.column(t.column),void 0!==t.margin&&this.margin(t.margin),void 0!==t.staticGrid&&this.setStatic(t.staticGrid),void 0===t.disableDrag||t.staticGrid||this.enableMove(!t.disableDrag),void 0===t.disableResize||t.staticGrid||this.enableResize(!t.disableResize),void 0!==t.float&&this.float(t.float),void 0!==t.row?(i.minRow=i.maxRow=i.row=t.row,this._updateContainerHeight()):(void 0!==t.minRow&&(i.minRow=t.minRow,this._updateContainerHeight()),void 0!==t.maxRow&&(i.maxRow=t.maxRow)),void 0!==t.lazyLoad&&(i.lazyLoad=t.lazyLoad),t.children?.length&&this.load(t.children)),this}update(t,i){return _.getElements(t).forEach((t=>{const s=t?.gridstackNode;if(!s)return;const e={...h.copyPos({},s),...h.cloneDeep(i)};this.engine.nodeBoundFix(e),delete e.autoPosition;const r=["x","y","w","h"];let n;if(r.some((t=>void 0!==e[t]&&e[t]!==s[t]))&&(n={},r.forEach((t=>{n[t]=void 0!==e[t]?e[t]:s[t],delete e[t]}))),!n&&(e.minW||e.minH||e.maxW||e.maxH)&&(n={}),void 0!==e.content){const i=t.querySelector(".grid-stack-item-content");i&&i.textContent!==e.content&&(s.content=e.content,_.renderCB(i,e),s.subGrid?.el&&(i.appendChild(s.subGrid.el),s.subGrid._updateContainerHeight())),delete e.content}let o=!1,a=!1;for(const t in e)"_"!==t[0]&&s[t]!==e[t]&&(s[t]=e[t],o=!0,a=a||!this.opts.staticGrid&&("noResize"===t||"noMove"===t||"locked"===t));if(h.sanitizeMinMax(s),n){const t=void 0!==n.w&&n.w!==s.w;this.moveNode(s,n),t&&s.subGrid?s.subGrid.onResize(this.hasAnimationCSS()?s.w:void 0):this.resizeToContentCheck(t,s),delete s._orig}(n||o)&&this._writeAttr(t,s),a&&this.prepareDragDrop(s.el),_.updateCB&&_.updateCB(s)})),this}moveNode(t,i){const s=t._updating;s||this.engine.cleanNodes().beginUpdate(t),this.engine.moveNode(t,i),this._updateContainerHeight(),s||(this._triggerChangeEvent(),this.engine.endUpdate())}resizeToContent(t){if(!t)return;if(t.classList.remove("size-to-content-max"),!t.clientHeight)return;const i=t.gridstackNode;if(!i)return;const s=i.grid;if(!s||t.parentElement!==s.el)return;const e=s.getCellHeight(!0);if(!e)return;let h,r=i.h?i.h*e:t.clientHeight;if(i.resizeToContentParent&&(h=t.querySelector(i.resizeToContentParent)),h||(h=t.querySelector(_.resizeToContentParent)),!h)return;const n=i.h?i.h*e-(t.clientHeight-h.clientHeight):h.clientHeight;let o;if(i.subGrid){o=i.subGrid.getRow()*i.subGrid.getCellHeight(!0);const s=i.subGrid.el.getBoundingClientRect(),e=t.getBoundingClientRect();o+=s.top-e.top}else{if(i.subGridOpts?.children?.length)return;{const t=h.firstElementChild;if(!t)return void console.error(`Error: GridStack.resizeToContent() widget id:${i.id} '${_.resizeToContentParent}'.firstElementChild is null, make sure to have a div like container. Skipping sizing.`);o=t.getBoundingClientRect().height||n}}if(n===o)return;r+=o-n;let a=Math.ceil(r/e);const d=Number.isInteger(i.sizeToContent)?i.sizeToContent:0;d&&a>d&&(a=d,t.classList.add("size-to-content-max")),i.minH&&a<i.minH?a=i.minH:i.maxH&&a>i.maxH&&(a=i.maxH),a!==i.h&&(s._ignoreLayoutsNodeChange=!0,s.moveNode(i,{h:a}),delete s._ignoreLayoutsNodeChange)}resizeToContentCBCheck(t){_.resizeToContentCB?_.resizeToContentCB(t):this.resizeToContent(t)}rotate(t,i){return _.getElements(t).forEach((t=>{const s=t.gridstackNode;if(!h.canBeRotated(s))return;const e={w:s.h,h:s.w,minH:s.minW,minW:s.minH,maxH:s.maxW,maxW:s.maxH};if(i){const t=i.left>0?Math.floor(i.left/this.cellWidth()):0,h=i.top>0?Math.floor(i.top/this.opts.cellHeight):0;e.x=s.x+t-(s.h-(h+1)),e.y=s.y+h-t}Object.keys(e).forEach((t=>{void 0===e[t]&&delete e[t]}));const r=s._orig;this.update(t,e),s._orig=r})),this}margin(t){if(!("string"==typeof t&&t.split(" ").length>1)){const i=h.parseHeight(t);if(this.opts.marginUnit===i.unit&&this.opts.margin===i.h)return}return this.opts.margin=t,this.opts.marginTop=this.opts.marginBottom=this.opts.marginLeft=this.opts.marginRight=void 0,this._initMargin(),this}getMargin(){return this.opts.margin}willItFit(t){return this.engine.willItFit(t)}_triggerChangeEvent(){if(this.engine.batchMode)return this;const t=this.engine.getDirtyNodes(!0);return t&&t.length&&(this._ignoreLayoutsNodeChange||this.engine.layoutsNodesChange(t),this._triggerEvent("change",t)),this.engine.saveInitial(),this}_triggerAddEvent(){if(this.engine.batchMode)return this;if(this.engine.addedNodes?.length){this._ignoreLayoutsNodeChange||this.engine.layoutsNodesChange(this.engine.addedNodes),this.engine.addedNodes.forEach((t=>{delete t._dirty}));const t=[...this.engine.addedNodes];this.engine.addedNodes=[],this._triggerEvent("added",t)}return this}_triggerRemoveEvent(){if(this.engine.batchMode)return this;if(this.engine.removedNodes?.length){const t=[...this.engine.removedNodes];this.engine.removedNodes=[],this._triggerEvent("removed",t)}return this}_triggerEvent(t,i){const s=i?new CustomEvent(t,{bubbles:!1,detail:i}):new Event(t);let e=this;for(;e.parentGridNode;)e=e.parentGridNode.grid;return e.el.dispatchEvent(s),this}_updateContainerHeight(){if(!this.engine||this.engine.batchMode)return this;const t=this.parentGridNode;let i=this.getRow()+this._extraDragRow;const s=this.opts.cellHeight,e=this.opts.cellHeightUnit;if(!s)return this;if(!t&&!this.opts.minRow){const t=h.parseHeight(getComputedStyle(this.el).minHeight);if(t.h>0&&t.unit===e){const e=Math.floor(t.h/s);i<e&&(i=e)}}return this.el.setAttribute("gs-current-row",String(i)),this.el.style.removeProperty("min-height"),this.el.style.removeProperty("height"),i&&(this.el.style[t?"minHeight":"height"]=i*s+e),t&&h.shouldSizeToContent(t)&&t.grid.resizeToContentCBCheck(t.el),this}_prepareElement(t,i=!1,s){s=s||this._readAttr(t),t.gridstackNode=s,s.el=t,s.grid=this,s=this.engine.addNode(s,i),this._writeAttr(t,s),t.classList.add(n.itemClass,this.opts.itemClass);const e=h.shouldSizeToContent(s);return e?t.classList.add("size-to-content"):t.classList.remove("size-to-content"),e&&this.resizeToContentCheck(!1,s),h.lazyLoad(s)||this.prepareDragDrop(s.el),this}_writePosAttr(t,i){return(i._moving||i._resizing)&&this._placeholder!==t||(t.style.top=i.y?1===i.y?"var(--gs-cell-height)":`calc(${i.y} * var(--gs-cell-height))`:null,t.style.left=i.x?1===i.x?"var(--gs-column-width)":`calc(${i.x} * var(--gs-column-width))`:null,t.style.width=i.w>1?`calc(${i.w} * var(--gs-column-width))`:null,t.style.height=i.h>1?`calc(${i.h} * var(--gs-cell-height))`:null),t.setAttribute("gs-x",String(i.x)),t.setAttribute("gs-y",String(i.y)),i.w>1?t.setAttribute("gs-w",String(i.w)):t.removeAttribute("gs-w"),i.h>1?t.setAttribute("gs-h",String(i.h)):t.removeAttribute("gs-h"),this}_writeAttr(t,i){if(!i)return this;this._writePosAttr(t,i);const s={noResize:"gs-no-resize",noMove:"gs-no-move",locked:"gs-locked",id:"gs-id",sizeToContent:"gs-size-to-content"};for(const e in s)i[e]?t.setAttribute(s[e],String(i[e])):t.removeAttribute(s[e]);return this}_readAttr(t,i=!0){const s={};s.x=h.toNumber(t.getAttribute("gs-x")),s.y=h.toNumber(t.getAttribute("gs-y")),s.w=h.toNumber(t.getAttribute("gs-w")),s.h=h.toNumber(t.getAttribute("gs-h")),s.autoPosition=h.toBool(t.getAttribute("gs-auto-position")),s.noResize=h.toBool(t.getAttribute("gs-no-resize")),s.noMove=h.toBool(t.getAttribute("gs-no-move")),s.locked=h.toBool(t.getAttribute("gs-locked"));const e=t.getAttribute("gs-size-to-content");e&&(s.sizeToContent="true"===e||"false"===e?h.toBool(e):parseInt(e,10)),s.id=t.getAttribute("gs-id"),s.maxW=h.toNumber(t.getAttribute("gs-max-w")),s.minW=h.toNumber(t.getAttribute("gs-min-w")),s.maxH=h.toNumber(t.getAttribute("gs-max-h")),s.minH=h.toNumber(t.getAttribute("gs-min-h")),i&&(1===s.w&&t.removeAttribute("gs-w"),1===s.h&&t.removeAttribute("gs-h"),s.maxW&&t.removeAttribute("gs-max-w"),s.minW&&t.removeAttribute("gs-min-w"),s.maxH&&t.removeAttribute("gs-max-h"),s.minH&&t.removeAttribute("gs-min-h"));for(const t in s){if(!s.hasOwnProperty(t))return;s[t]||0===s[t]||"sizeToContent"===t||delete s[t]}return s}_setStaticClass(){const t=["grid-stack-static"];return this.opts.staticGrid?(this.el.classList.add(...t),this.el.setAttribute("gs-static","true")):(this.el.classList.remove(...t),this.el.removeAttribute("gs-static")),this}onResize(t=this.el?.clientWidth){if(!t)return;if(this.prevWidth===t)return;this.prevWidth=t,this.batchUpdate();let i=!1;return this._autoColumn&&this.parentGridNode?this.opts.column!==this.parentGridNode.w&&(this.column(this.parentGridNode.w,this.opts.layout||"list"),i=!0):i=this.checkDynamicColumn(),this._isAutoCellHeight&&this.cellHeight(),this.engine.nodes.forEach((t=>{t.subGrid&&t.subGrid.onResize()})),this._skipInitialResize||this.resizeToContentCheck(i),delete this._skipInitialResize,this.batchUpdate(!1),this}resizeToContentCheck(t=!1,i){if(this.engine){if(t&&this.hasAnimationCSS())return setTimeout((()=>this.resizeToContentCheck(!1,i)),this.animationDelay);if(i)h.shouldSizeToContent(i)&&this.resizeToContentCBCheck(i.el);else if(this.engine.nodes.some((t=>h.shouldSizeToContent(t)))){const t=[...this.engine.nodes];this.batchUpdate(),t.forEach((t=>{h.shouldSizeToContent(t)&&this.resizeToContentCBCheck(t.el)})),this._ignoreLayoutsNodeChange=!0,this.batchUpdate(!1),this._ignoreLayoutsNodeChange=!1}this._gsEventHandler.resizecontent&&this._gsEventHandler.resizecontent(null,i?[i]:this.engine.nodes)}}_updateResizeEvent(t=!1){const i=!this.parentGridNode&&(this._isAutoCellHeight||this.opts.sizeToContent||this.opts.columnOpts||this.engine.nodes.find((t=>t.sizeToContent)));return t||!i||this.resizeObserver?!t&&i||!this.resizeObserver||(this.resizeObserver.disconnect(),delete this.resizeObserver,delete this._sizeThrottle):(this._sizeThrottle=h.throttle((()=>this.onResize()),this.opts.cellHeightThrottle),this.resizeObserver=new ResizeObserver((()=>this._sizeThrottle())),this.resizeObserver.observe(this.el),this._skipInitialResize=!0),this}static getElement(t=".grid-stack-item"){return h.getElement(t)}static getElements(t=".grid-stack-item"){return h.getElements(t)}static getGridElement(t){return _.getElement(t)}static getGridElements(t){return h.getElements(t)}_initMargin(){let t,i=0,s=[];"string"==typeof this.opts.margin&&(s=this.opts.margin.split(" ")),2===s.length?(this.opts.marginTop=this.opts.marginBottom=s[0],this.opts.marginLeft=this.opts.marginRight=s[1]):4===s.length?(this.opts.marginTop=s[0],this.opts.marginRight=s[1],this.opts.marginBottom=s[2],this.opts.marginLeft=s[3]):(t=h.parseHeight(this.opts.margin),this.opts.marginUnit=t.unit,i=this.opts.margin=t.h),["marginTop","marginRight","marginBottom","marginLeft"].forEach((s=>{void 0===this.opts[s]?this.opts[s]=i:(t=h.parseHeight(this.opts[s]),this.opts[s]=t.h,delete this.opts.margin)})),this.opts.marginUnit=t.unit,this.opts.marginTop===this.opts.marginBottom&&this.opts.marginLeft===this.opts.marginRight&&this.opts.marginTop===this.opts.marginRight&&(this.opts.margin=this.opts.marginTop);const e=this.el.style;return e.setProperty("--gs-item-margin-top",`${this.opts.marginTop}${this.opts.marginUnit}`),e.setProperty("--gs-item-margin-bottom",`${this.opts.marginBottom}${this.opts.marginUnit}`),e.setProperty("--gs-item-margin-right",`${this.opts.marginRight}${this.opts.marginUnit}`),e.setProperty("--gs-item-margin-left",`${this.opts.marginLeft}${this.opts.marginUnit}`),this}static getDD(){return M}static setupDragIn(t,i,s,e=document){void 0!==i?.pause&&(o.pauseDrag=i.pause),i={appendTo:"body",helper:"clone",...i||{}},("string"==typeof t?h.getElements(t,e):t).forEach(((t,e)=>{M.isDraggable(t)||M.dragIn(t,i),s?.[e]&&(t.gridstackNode=s[e])}))}movable(t,i){return this.opts.staticGrid||_.getElements(t).forEach((t=>{const s=t.gridstackNode;s&&(i?delete s.noMove:s.noMove=!0,this.prepareDragDrop(s.el))})),this}resizable(t,i){return this.opts.staticGrid||_.getElements(t).forEach((t=>{const s=t.gridstackNode;s&&(i?delete s.noResize:s.noResize=!0,this.prepareDragDrop(s.el))})),this}disable(t=!0){if(!this.opts.staticGrid)return this.enableMove(!1,t),this.enableResize(!1,t),this._triggerEvent("disable"),this}enable(t=!0){if(!this.opts.staticGrid)return this.enableMove(!0,t),this.enableResize(!0,t),this._triggerEvent("enable"),this}enableMove(t,i=!0){return this.opts.staticGrid||(t?delete this.opts.disableDrag:this.opts.disableDrag=!0,this.engine.nodes.forEach((s=>{this.prepareDragDrop(s.el),s.subGrid&&i&&s.subGrid.enableMove(t,i)}))),this}enableResize(t,i=!0){return this.opts.staticGrid||(t?delete this.opts.disableResize:this.opts.disableResize=!0,this.engine.nodes.forEach((s=>{this.prepareDragDrop(s.el),s.subGrid&&i&&s.subGrid.enableResize(t,i)}))),this}cancelDrag(){const t=this._placeholder?.gridstackNode;t&&(t._isExternal?(t._isAboutToRemove=!0,this.engine.removeNode(t)):t._isAboutToRemove&&_._itemRemoving(t.el,!1),this.engine.restoreInitial())}_removeDD(t){return M.draggable(t,"destroy").resizable(t,"destroy"),t.gridstackNode&&delete t.gridstackNode._initDD,delete t.ddElement,this}_setupAcceptWidget(){if(this.opts.staticGrid||!this.opts.acceptWidgets&&!this.opts.removable)return M.droppable(this.el,"destroy"),this;let t,i;const s=(s,e,r)=>{const n=(r=r||e).gridstackNode;if(!n)return;if(!n.grid?.el){r.style.transform=`scale(${1/this.dragTransform.xScale},${1/this.dragTransform.yScale})`;const t=r.getBoundingClientRect();r.style.left=t.x+(this.dragTransform.xScale-1)*(s.clientX-t.x)/this.dragTransform.xScale+"px",r.style.top=t.y+(this.dragTransform.yScale-1)*(s.clientY-t.y)/this.dragTransform.yScale+"px",r.style.transformOrigin="0px 0px"}let{top:o,left:a}=r.getBoundingClientRect();const d=this.el.getBoundingClientRect();a-=d.left,o-=d.top;const l={position:{top:o*this.dragTransform.xScale,left:a*this.dragTransform.yScale}};if(n._temporaryRemoved){if(n.x=Math.max(0,Math.round(a/i)),n.y=Math.max(0,Math.round(o/t)),delete n.autoPosition,this.engine.nodeBoundFix(n),!this.engine.willItFit(n)){if(n.autoPosition=!0,!this.engine.willItFit(n))return void M.off(e,"drag");n._willFitPos&&(h.copyPos(n,n._willFitPos),delete n._willFitPos)}this._onStartMoving(r,s,l,n,i,t)}else this._dragOrResize(r,s,l,n,i,t)};return M.droppable(this.el,{accept:t=>{const i=t.gridstackNode||this._readAttr(t,!1);if(i?.grid===this)return!0;if(!this.opts.acceptWidgets)return!1;let s=!0;return s="function"==typeof this.opts.acceptWidgets?this.opts.acceptWidgets(t):t.matches(!0===this.opts.acceptWidgets?".grid-stack-item":this.opts.acceptWidgets),s&&i&&this.opts.maxRow&&(s=this.engine.willItFit({w:i.w,h:i.h,minW:i.minW,minH:i.minH})),s}}).on(this.el,"dropover",((e,h,r)=>{let n=r?.gridstackNode||h.gridstackNode;if(n?.grid===this&&!n._temporaryRemoved)return!1;if(n?._sidebarOrig&&(n.w=n._sidebarOrig.w,n.h=n._sidebarOrig.h),n?.grid&&n.grid!==this&&!n._temporaryRemoved&&n.grid._leave(h,r),r=r||h,i=this.cellWidth(),t=this.getCellHeight(!0),!n){const t=r.getAttribute("data-gs-widget")||r.getAttribute("gridstacknode");if(t){try{n=JSON.parse(t)}catch(i){console.error("Gridstack dropover: Bad JSON format: ",t)}r.removeAttribute("data-gs-widget"),r.removeAttribute("gridstacknode")}n||(n=this._readAttr(r)),n._sidebarOrig={w:n.w,h:n.h}}n.grid||(n.el||(n={...n}),n._isExternal=!0,r.gridstackNode=n);const o=n.w||Math.round(r.offsetWidth/i)||1,a=n.h||Math.round(r.offsetHeight/t)||1;return n.grid&&n.grid!==this?(h._gridstackNodeOrig||(h._gridstackNodeOrig=n),h.gridstackNode=n={...n,w:o,h:a,grid:this},delete n.x,delete n.y,this.engine.cleanupNode(n).nodeBoundFix(n),n._initDD=n._isExternal=n._temporaryRemoved=!0):(n.w=o,n.h=a,n._temporaryRemoved=!0),_._itemRemoving(n.el,!1),M.on(h,"drag",s),s(e,h,r),!1})).on(this.el,"dropout",((t,i,s)=>{const e=s?.gridstackNode||i.gridstackNode;return!!e&&(e.grid&&e.grid!==this||(this._leave(i,s),this._isTemp&&this.removeAsSubGrid(e)),!1)})).on(this.el,"drop",((t,i,s)=>{const e=s?.gridstackNode||i.gridstackNode;if(e?.grid===this&&!e._isExternal)return!1;const r=!!this.placeholder.parentElement,n=i!==s;this.placeholder.remove(),delete this.placeholder.gridstackNode,r&&this.opts.animate&&(this.setAnimation(!1),this.setAnimation(!0,!0));const o=i._gridstackNodeOrig;if(delete i._gridstackNodeOrig,r&&o?.grid&&o.grid!==this){const t=o.grid;t.engine.removeNodeFromLayoutCache(o),t.engine.removedNodes.push(o),t._triggerRemoveEvent()._triggerChangeEvent(),t.parentGridNode&&!t.engine.nodes.length&&t.opts.subGridDynamic&&t.removeAsSubGrid()}if(!e)return!1;if(r&&(this.engine.cleanupNode(e),e.grid=this),delete e.grid?._isTemp,M.off(i,"drag"),s!==i?(s.remove(),i=s):i.remove(),this._removeDD(i),!r)return!1;const a=e.subGrid?.el?.gridstack;return h.copyPos(e,this._readAttr(this.placeholder)),h.removePositioningStyles(i),n&&(e.content||e.subGridOpts||_.addRemoveCB)?(delete e.el,i=this.addWidget(e)):(this._prepareElement(i,!0,e),this.el.appendChild(i),this.resizeToContentCheck(!1,e),a&&(a.parentGridNode=e),this._updateContainerHeight()),this.engine.addedNodes.push(e),this._triggerAddEvent(),this._triggerChangeEvent(),this.engine.endUpdate(),this._gsEventHandler.dropped&&this._gsEventHandler.dropped({...t,type:"dropped"},o&&o.grid?o:void 0,e),!1})),this}static _itemRemoving(t,i){if(!t)return;const s=t?t.gridstackNode:void 0;s?.grid&&!t.classList.contains(s.grid.opts.removableOptions.decline)&&(i?s._isAboutToRemove=!0:delete s._isAboutToRemove,i?t.classList.add("grid-stack-item-removing"):t.classList.remove("grid-stack-item-removing"))}_setupRemoveDrop(){if("string"!=typeof this.opts.removable)return this;const t=document.querySelector(this.opts.removable);return t?(this.opts.staticGrid||M.isDroppable(t)||M.droppable(t,this.opts.removableOptions).on(t,"dropover",((t,i)=>_._itemRemoving(i,!0))).on(t,"dropout",((t,i)=>_._itemRemoving(i,!1))),this):this}prepareDragDrop(t,i=!1){const s=t?.gridstackNode;if(!s)return;const e=s.noMove||this.opts.disableDrag,r=s.noResize||this.opts.disableResize,n=this.opts.staticGrid||e&&r;if((i||n)&&(s._initDD&&(this._removeDD(t),delete s._initDD),n&&t.classList.add("ui-draggable-disabled","ui-resizable-disabled"),!i))return this;if(!s._initDD){let i,e;const r=(h,r)=>{this.triggerEvent(h,h.target),i=this.cellWidth(),e=this.getCellHeight(!0),this._onStartMoving(t,h,r,s,i,e)},n=(h,r)=>{this._dragOrResize(t,h,r,s,i,e)},o=i=>{this.placeholder.remove(),delete this.placeholder.gridstackNode,delete s._moving,delete s._resizing,delete s._event,delete s._lastTried;const e=s.w!==s._orig.w,r=i.target;if(r.gridstackNode&&r.gridstackNode.grid===this){if(s.el=r,s._isAboutToRemove){const e=t.gridstackNode.grid;e._gsEventHandler[i.type]&&e._gsEventHandler[i.type](i,r),e.engine.nodes.push(s),e.removeWidget(t,!0,!0)}else h.removePositioningStyles(r),s._temporaryRemoved?(this._writePosAttr(r,s),this.engine.addNode(s)):this._writePosAttr(r,s),this.triggerEvent(i,r);this._extraDragRow=0,this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate(),"resizestop"===i.type&&(Number.isInteger(s.sizeToContent)&&(s.sizeToContent=s.h),this.resizeToContentCheck(e,s))}};M.draggable(t,{start:r,stop:o,drag:n}).resizable(t,{start:r,stop:o,resize:n}),s._initDD=!0}return M.draggable(t,e?"disable":"enable").resizable(t,r?"disable":"enable"),this}_onStartMoving(t,i,s,e,r,n){if(this.engine.cleanNodes().beginUpdate(e),this._writePosAttr(this.placeholder,e),this.el.appendChild(this.placeholder),this.placeholder.gridstackNode=e,e.grid?.el)this.dragTransform=h.getValuesFromTransformedElement(t);else if(this.placeholder&&this.placeholder.closest(".grid-stack")){const t=this.placeholder.closest(".grid-stack");this.dragTransform=h.getValuesFromTransformedElement(t)}else this.dragTransform={xScale:1,xOffset:0,yScale:1,yOffset:0};if(e.el=this.placeholder,e._lastUiPosition=s.position,e._prevYPix=s.position.top,e._moving="dragstart"===i.type,e._resizing="resizestart"===i.type,delete e._lastTried,"dropover"===i.type&&e._temporaryRemoved&&(this.engine.addNode(e),e._moving=!0),this.engine.cacheRects(r,n,this.opts.marginTop,this.opts.marginRight,this.opts.marginBottom,this.opts.marginLeft),"resizestart"===i.type){const i=this.getColumn()-e.x,s=(this.opts.maxRow||Number.MAX_SAFE_INTEGER)-e.y;M.resizable(t,"option","minWidth",r*Math.min(e.minW||1,i)).resizable(t,"option","minHeight",n*Math.min(e.minH||1,s)).resizable(t,"option","maxWidth",r*Math.min(e.maxW||Number.MAX_SAFE_INTEGER,i)).resizable(t,"option","maxWidthMoveLeft",r*Math.min(e.maxW||Number.MAX_SAFE_INTEGER,e.x+e.w)).resizable(t,"option","maxHeight",n*Math.min(e.maxH||Number.MAX_SAFE_INTEGER,s)).resizable(t,"option","maxHeightMoveUp",n*Math.min(e.maxH||Number.MAX_SAFE_INTEGER,e.y+e.h))}}_dragOrResize(t,i,s,e,r,n){const o={...e._orig};let a,d=this.opts.marginLeft,l=this.opts.marginRight,c=this.opts.marginTop,u=this.opts.marginBottom;const g=Math.round(.1*n),m=Math.round(.1*r);if(d=Math.min(d,m),l=Math.min(l,m),c=Math.min(c,g),u=Math.min(u,g),"drag"===i.type){if(e._temporaryRemoved)return;const i=s.position.top-e._prevYPix;e._prevYPix=s.position.top,!1!==this.opts.draggable.scroll&&h.updateScrollPosition(t,s.position,i);const a=s.position.top+(s.position.top>e._lastUiPosition.top?-u:c);o.x=Math.round((s.position.left+(s.position.left>e._lastUiPosition.left?-l:d))/r),o.y=Math.round(a/n);const g=this._extraDragRow;if(this.engine.collide(e,o)){const t=this.getRow();let i=Math.max(0,o.y+e.h-t);this.opts.maxRow&&t+i>this.opts.maxRow&&(i=Math.max(0,this.opts.maxRow-t)),this._extraDragRow=i}else this._extraDragRow=0;if(this._extraDragRow!==g&&this._updateContainerHeight(),e.x===o.x&&e.y===o.y)return}else if("resize"===i.type){if(o.x<0)return;if(h.updateScrollResize(i,t,n),o.w=Math.round((s.size.width-d)/r),o.h=Math.round((s.size.height-c)/n),e.w===o.w&&e.h===o.h)return;if(e._lastTried&&e._lastTried.w===o.w&&e._lastTried.h===o.h)return;const l=s.position.top+c;o.x=Math.round((s.position.left+d)/r),o.y=Math.round(l/n),a=!0}e._event=i,e._lastTried=o;const p={x:s.position.left+d,y:s.position.top+c,w:(s.size?s.size.width:e.w*r)-d-l,h:(s.size?s.size.height:e.h*n)-c-u};if(this.engine.moveNodeCheck(e,{...o,cellWidth:r,cellHeight:n,rect:p,resizing:a})){e._lastUiPosition=s.position,this.engine.cacheRects(r,n,c,l,u,d),delete e._skipDown,a&&e.subGrid&&e.subGrid.onResize(),this._extraDragRow=0,this._updateContainerHeight();const t=i.target;e._sidebarOrig||this._writePosAttr(t,e),this.triggerEvent(i,t)}}triggerEvent(t,i){let s=this;for(;s.parentGridNode;)s=s.parentGridNode.grid;s._gsEventHandler[t.type]&&s._gsEventHandler[t.type](t,i)}_leave(t,i){const s=(i=i||t).gridstackNode;if(!s)return;if(i.style.transform=i.style.transformOrigin=null,M.off(t,"drag"),s._temporaryRemoved)return;s._temporaryRemoved=!0,this.engine.removeNode(s),s.el=s._isExternal&&i?i:t;const e=s._sidebarOrig;s._isExternal&&this.engine.cleanupNode(s),s._sidebarOrig=e,!0===this.opts.removable&&_._itemRemoving(t,!0),t._gridstackNodeOrig?(t.gridstackNode=t._gridstackNodeOrig,delete t._gridstackNodeOrig):s._isExternal&&this.engine.restoreInitial()}}_.renderCB=(t,i)=>{t&&i?.content&&(t.textContent=i.content)},_.resizeToContentParent=".grid-stack-item-content",_.Utils=h,_.Engine=r,_.GDRev="12.4.1";const S=class{constructor(s){t(this,s),this.changedItem=i(this,"changedItem",7),this.removedItem=i(this,"removedItem",7),this.resizeDragEvent=i(this,"resizeDragEvent",7)}get el(){return s(this)}widget_items=[];changedItem;removedItem;resizeDragEvent;widgetItemsChanged(){}grid;gridContainerRef;componentDidLoad(){this.gridContainerRef&&(this.grid=_.init({margin:4,minRow:1,maxRow:100,float:!0,columnOpts:{columnMax:12,breakpoints:[{w:768,c:1,layout:"compact"}]}},this.gridContainerRef),this.layoutWidgets(),this.grid.on("added change",((t,i)=>{i?.forEach((t=>{const i=this.widget_items.find((i=>i.id===t.el.id));i&&(Object.assign(i,{x:t.x,y:t.y,w:t.w??4,h:t.h??3}),this.changedItem.emit(i))}))})),this.grid.on("resizestop dragstop",((t,i)=>{const s=i.gridstackNode,e={id:i.id,x:s.x,y:s.y,w:s.w??4,h:s.h??3};this.resizeChartComponents(i),this.resizeDragEvent.emit(e)})))}componentDidUpdate(){this.layoutWidgets()}disconnectedCallback(){this.grid?.destroy(!1)}layoutWidgets(){this.grid&&(this.grid.removeAll(!1),this.widget_items.forEach((t=>this.makeWidget(t))))}makeWidget(t){this.grid.makeWidget(`#${t.id}`,{id:t.id,x:t.x,y:t.y,w:t.w,h:t.h})}removeWidget(t){this.removedItem.emit(t)}resizeChartComponents(t){["at-chart-donut","at-chart-bar","at-chart-line"].forEach((i=>{t.querySelectorAll(i).forEach((t=>{"function"==typeof t.resize&&t.resize()}))}))}render(){return e("div",{key:"77a040c729ac619ddc32346010fbece5ea2ca1b5",class:"grid-stack",ref:t=>this.gridContainerRef=t},this.widget_items.map((t=>e("div",{class:"grid-stack-item",id:t.id,key:t.id},e("div",{class:"grid-stack-item-content"},e("div",{class:"absolute top-0 right-0"},e("at-menu",null,e("at-button",{slot:"menu-trigger",icon:"more_vert",type:"secondaryText"}),e("at-button",{label:"Delete",type:"secondaryText",onAtuiClick:()=>{this.removeWidget(t)}}))),e("slot",{name:t.id}))))))}static get watchers(){return{widget_items:[{widgetItemsChanged:0}]}}};S.style='.grid-stack{position:relative}.grid-stack-rtl{direction:ltr}.grid-stack-rtl>.grid-stack-item{direction:rtl}.grid-stack-placeholder>.placeholder-content{background-color:rgba(0,0,0,.1);margin:0;position:absolute;width:auto;z-index:0!important}.grid-stack>.grid-stack-item{position:absolute;padding:0;top:0;left:0;width:var(--gs-column-width);height:var(--gs-cell-height)}.grid-stack>.grid-stack-item>.grid-stack-item-content{margin:0;position:absolute;width:auto;overflow-x:hidden;overflow-y:auto}.grid-stack>.grid-stack-item.size-to-content:not(.size-to-content-max)>.grid-stack-item-content{overflow-y:hidden}.grid-stack>.grid-stack-item>.grid-stack-item-content,.grid-stack>.grid-stack-placeholder>.placeholder-content{top:var(--gs-item-margin-top);right:var(--gs-item-margin-right);bottom:var(--gs-item-margin-bottom);left:var(--gs-item-margin-left)}.grid-stack-item>.ui-resizable-handle{position:absolute;font-size:.1px;display:block;-ms-touch-action:none;touch-action:none}.grid-stack-item.ui-resizable-autohide>.ui-resizable-handle,.grid-stack-item.ui-resizable-disabled>.ui-resizable-handle{display:none}.grid-stack-item>.ui-resizable-ne,.grid-stack-item>.ui-resizable-nw,.grid-stack-item>.ui-resizable-se,.grid-stack-item>.ui-resizable-sw{background-image:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="%23666" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 20 20"><path d="m10 3 2 2H8l2-2v14l-2-2h4l-2 2"/></svg>\');background-repeat:no-repeat;background-position:center}.grid-stack-item>.ui-resizable-ne{transform:rotate(45deg)}.grid-stack-item>.ui-resizable-sw{transform:rotate(45deg)}.grid-stack-item>.ui-resizable-nw{transform:rotate(-45deg)}.grid-stack-item>.ui-resizable-se{transform:rotate(-45deg)}.grid-stack-item>.ui-resizable-nw{cursor:nw-resize;width:20px;height:20px;top:var(--gs-item-margin-top);left:var(--gs-item-margin-left)}.grid-stack-item>.ui-resizable-n{cursor:n-resize;height:10px;top:var(--gs-item-margin-top);left:25px;right:25px}.grid-stack-item>.ui-resizable-ne{cursor:ne-resize;width:20px;height:20px;top:var(--gs-item-margin-top);right:var(--gs-item-margin-right)}.grid-stack-item>.ui-resizable-e{cursor:e-resize;width:10px;top:15px;bottom:15px;right:var(--gs-item-margin-right)}.grid-stack-item>.ui-resizable-se{cursor:se-resize;width:20px;height:20px;bottom:var(--gs-item-margin-bottom);right:var(--gs-item-margin-right)}.grid-stack-item>.ui-resizable-s{cursor:s-resize;height:10px;left:25px;bottom:var(--gs-item-margin-bottom);right:25px}.grid-stack-item>.ui-resizable-sw{cursor:sw-resize;width:20px;height:20px;bottom:var(--gs-item-margin-bottom);left:var(--gs-item-margin-left)}.grid-stack-item>.ui-resizable-w{cursor:w-resize;width:10px;top:15px;bottom:15px;left:var(--gs-item-margin-left)}.grid-stack-item.ui-draggable-dragging>.ui-resizable-handle{display:none!important}.grid-stack-item.ui-draggable-dragging{will-change:left,top}.grid-stack-item.ui-resizable-resizing{will-change:width,height}.ui-draggable-dragging,.ui-resizable-resizing{z-index:10000}.ui-draggable-dragging>.grid-stack-item-content,.ui-resizable-resizing>.grid-stack-item-content{box-shadow:1px 4px 6px rgba(0,0,0,.2);opacity:.8}.grid-stack-animate,.grid-stack-animate .grid-stack-item{transition:left .3s,top .3s,height .3s,width .3s}.grid-stack-animate .grid-stack-item.grid-stack-placeholder,.grid-stack-animate .grid-stack-item.ui-draggable-dragging,.grid-stack-animate .grid-stack-item.ui-resizable-resizing{transition:left 0s,top 0s,height 0s,width 0s}.grid-stack>.grid-stack-item[gs-y="0"]{top:0}.grid-stack>.grid-stack-item[gs-x="0"]{left:0}';export{S as at_dashboard}