import{r as t,c as s,h as e,H as i,g as a}from"./p-C8uvvL0O.js";import{f as h}from"./p-DuLooPsr.js";const r=class{constructor(e){t(this,e);this.atuiSubmit=s(this,"atuiSubmit",7);this.atuiStop=s(this,"atuiStop",7);this.atuiNewThread=s(this,"atuiNewThread",7);this.atuiMessageCopy=s(this,"atuiMessageCopy",7);this.atuiMessageRetry=s(this,"atuiMessageRetry",7);this.atuiMessageEdit=s(this,"atuiMessageEdit",7);this.atuiMessageVote=s(this,"atuiMessageVote",7);this.messages=[];this.header_title="AI Assistant";this.placeholder="Type your message here...";this.loading=false;this.disabled=false;this.show_header=true;this.show_new_thread_button=true;this.max_message_length=2e3;this.enable_vote=true;this.enable_copy=true;this.enable_edit=false;this.currentInput="";this.inputInvalid=false;this.inputError="";this.isSendEnabled=true;this.translations={};this.handleSubmit=async t=>{if(!t||this.disabled||this.loading||!this.isSendEnabled){return}this.isSendEnabled=false;await this.addMessage("user",t);this.atuiSubmit.emit(t)};this.handleStop=()=>{this.atuiStop.emit()};this.handleNewThread=async()=>{await this.newThread()}}async componentWillLoad(){this.translations=await h(this.el)}handleInputSubmit(t){const s=t.detail.trim();if(s&&this.isSendEnabled&&!this.disabled&&!this.loading){this.handleSubmit(s)}}handleMessageCopy(t){this.atuiMessageCopy.emit(t.detail)}handleMessageRetry(t){this.atuiMessageRetry.emit(t.detail)}async handleMessageEdit(t){this.atuiMessageEdit.emit(t.detail);if(this.inputComponent){this.inputComponent.value=t.detail.content;await this.focusInput()}}handleMessageVote(t){t.stopPropagation();const s=this.messages.findIndex((s=>s.id===t.detail.messageId));if(s!==-1){const e=[...this.messages];e[s]=Object.assign(Object.assign({},e[s]),{vote_status:t.detail.score});this.messages=e}}async addMessage(t,s){const e={id:Date.now().toString(),role:t,content:s};this.messages=[...this.messages,e]}async appendToLastMessage(t){if(this.messages.length===0)return false;const s=this.messages[this.messages.length-1];if(s.role!=="assistant")return false;s.content+=t;this.messages=[...this.messages];return true}async newThread(){this.messages=[];this.currentInput="";this.isSendEnabled=true;this.atuiNewThread.emit();setTimeout((()=>this.focusInput()),100)}async setSendEnabled(t){this.isSendEnabled=t}async focusInput(){if(this.inputComponent){setTimeout((()=>{this.inputComponent.focus()}),0)}}renderHeader(){var t,s,i;if(!this.show_header)return null;const a=((i=(s=(t=this.translations)===null||t===void 0?void 0:t.ATUI)===null||s===void 0?void 0:s.PROMPT)===null||i===void 0?void 0:i.NEW_THREAD)||"New Thread";return e("atui-header",{size:"h3",header_title:this.header_title,subtitle:this.subtitle,border:true,"data-name":"prompt-container-header"},this.show_new_thread_button&&e("atui-button",{slot:"actions",size:"sm",type:"secondaryText",onClick:this.handleNewThread,disabled:this.loading,"data-name":"new-thread-button"},a))}renderFooter(){return e("div",{class:"p-4"},e("atui-prompt-input",{ref:t=>this.inputComponent=t,placeholder:this.placeholder,in_progress:this.loading,max_length:this.max_message_length,error_text:this.error_text,"data-name":"prompt-container-input",onAtuiSubmit:t=>this.handleSubmit(t.detail),onAtuiStop:()=>this.handleStop()}))}render(){return e(i,{key:"ebb9b82721b0812c9f21139df13808478a03e8ac",class:"flex h-full w-full flex-col overflow-hidden","data-name":"prompt-container"},this.renderHeader(),e("slot",{key:"2124122c3fdb640825e351355d5535f74ce0de4b",name:"prompt-container-header"}),e("div",{key:"fb818dffdebc5d911e97b115ba3110980816f434",class:"min-h-0 flex-1","data-name":"thread-wrapper"},e("atui-prompt-thread",{key:"424ef20d956e1e667ed3ee97c15b5e4f1ae53e7e",messages:this.messages,loading:this.loading,auto_scroll:true,enable_vote:this.enable_vote,enable_copy:this.enable_copy,enable_edit:this.enable_edit,"data-name":"container-thread"})),e("div",{key:"f4ad7650d32a04fef7a811209bfffca5ab6643e7",class:"flex flex-col gap-4"},this.renderFooter(),e("slot",{key:"0af32a02bdd958258e1250c3c58b6af2de545099",name:"prompt-container-footer"})))}get el(){return a(this)}};export{r as atui_prompt_container};
//# sourceMappingURL=p-f9b53f5f.entry.js.map