import{r as t,c as e,g as s,h as a,H as i}from"./p-EP34iaAr.js";import{f as n}from"./p-DuLooPsr.js";const h=class{constructor(s){t(this,s);this.atSubmit=e(this,"atSubmit",7);this.atStop=e(this,"atStop",7);this.atNewThread=e(this,"atNewThread",7);this.atMessageCopy=e(this,"atMessageCopy",7);this.atMessageRetry=e(this,"atMessageRetry",7);this.atMessageEdit=e(this,"atMessageEdit",7);this.atMessageVote=e(this,"atMessageVote",7)}get el(){return s(this)}messages=[];placeholder="Type your message here...";error_text;loading=false;disabled=false;show_new_thread_button=true;max_message_length=2e3;enable_vote=true;enable_copy=true;enable_edit=false;response_animation="words";currentInput="";inputInvalid=false;inputError="";isSendEnabled=true;translations={};atSubmit;atStop;atNewThread;atMessageCopy;atMessageRetry;atMessageEdit;atMessageVote;inputComponent;async componentWillLoad(){this.translations=await n(this.el)}handleInputSubmit(t){const e=t.detail.trim();if(e&&this.isSendEnabled&&!this.disabled&&!this.loading){this.handleSubmit(e)}}handleMessageCopy(t){this.atMessageCopy.emit(t.detail)}handleMessageRetry(t){this.atMessageRetry.emit(t.detail)}async handleMessageEdit(t){this.atMessageEdit.emit(t.detail);if(this.inputComponent){this.inputComponent.value=t.detail.content;await this.focusInput()}}handleMessageVote(t){const e=this.messages.findIndex((e=>e.id===t.detail.messageId));if(e!==-1){const s=[...this.messages];s[e]={...s[e],score:t.detail.score};this.messages=s;this.atMessageVote.emit(t.detail)}this.atMessageVote.emit(t.detail)}async addMessage(t,e){const s={id:Date.now().toString(),role:t,content:e};this.messages=[...this.messages,s]}async appendToLastMessage(t){if(this.messages.length===0)return false;const e=this.messages[this.messages.length-1];if(e.role!=="assistant")return false;e.content+=t;this.messages=[...this.messages];return true}async newThread(){this.messages=[];this.currentInput="";this.isSendEnabled=true;this.atNewThread.emit();setTimeout((()=>this.focusInput()),100)}async setSendEnabled(t){this.isSendEnabled=t}async focusInput(){if(this.inputComponent){setTimeout((()=>{this.inputComponent.focus()}),0)}}handleSubmit=async t=>{if(!t||this.disabled||this.loading||!this.isSendEnabled){return}this.isSendEnabled=false;await this.addMessage("user",t);this.atSubmit.emit(t)};handleStop=()=>{this.atStop.emit()};handleNewThread=async()=>{await this.newThread()};renderHeader(){if(!this.show_new_thread_button)return null;const t=this.translations?.ATUI?.PROMPT?.NEW_THREAD||"New Thread";return a("div",{class:"flex justify-end pb-16"},a("at-button",{slot:"actions",size:"md",type:"primaryOutline",onClick:this.handleNewThread,disabled:this.loading,"data-name":"new-thread-button"},t))}renderFooter(){return a("div",{class:"p-4"},a("at-prompt-input",{ref:t=>this.inputComponent=t,placeholder:this.placeholder,in_progress:this.loading,max_length:this.max_message_length,error_text:this.error_text,"data-name":"prompt-container-input",onAtSubmit:t=>this.handleSubmit(t.detail),onAtStop:()=>this.handleStop()}))}render(){return a(i,{key:"04d733d4c8d4b5397ce6735dd1aaf515e062745f",class:"flex h-full w-full flex-col overflow-hidden","data-name":"prompt-container"},this.renderHeader(),a("slot",{key:"c10a06bf1ce755cf444c257992fc584eadda26df",name:"prompt-container-header"}),a("div",{key:"9c4ff9c3ba308a849bd42bd22181f05827fbc6b6",class:"min-h-0 flex-1","data-name":"thread-wrapper"},a("at-prompt-thread",{key:"fb684b54cca25e7eabe8c2c1cdee5ace4663e2b2",messages:this.messages,loading:this.loading,auto_scroll:true,enable_vote:this.enable_vote,enable_copy:this.enable_copy,enable_edit:this.enable_edit,response_animation:this.response_animation,"data-name":"container-thread"})),a("div",{key:"b4f04be839d492b91880139641ee461ef5bb9c51",class:"flex flex-col gap-4"},this.renderFooter(),a("slot",{key:"337f94d0e843365764aaf65e0b9c5d3418e2169d",name:"prompt-container-footer"})))}};export{h as at_prompt_container};
//# sourceMappingURL=p-8c6ccf52.entry.js.map