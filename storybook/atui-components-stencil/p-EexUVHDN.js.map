{"version":3,"file":"p-EexUVHDN.js","sources":["src/utils/keyboard-navigation.ts"],"sourcesContent":["export const FOCUSABLE_SELECTOR =\n    'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n\nexport interface KeyboardNavigationOptions {\n    container: HTMLElement;\n    onEscape?: () => void;\n    onEnter?: (target: HTMLElement) => void;\n    onSpace?: (target: HTMLElement) => void;\n    focusOnOpen?: boolean;\n}\n\nexport function getFocusableElements(container: HTMLElement): HTMLElement[] {\n    return Array.from(\n        container.querySelectorAll(FOCUSABLE_SELECTOR),\n    ) as HTMLElement[];\n}\n\nexport function focusElementAtIndex(\n    elements: HTMLElement[],\n    index: number,\n): void {\n    if (elements.length === 0) return;\n\n    const clampedIndex = Math.max(0, Math.min(index, elements.length - 1));\n    elements[clampedIndex].focus();\n}\n\nexport function getCurrentFocusIndex(elements: HTMLElement[]): number {\n    return elements.indexOf(document.activeElement as HTMLElement);\n}\n\nexport function handleArrowNavigation(\n    event: KeyboardEvent,\n    container: HTMLElement,\n): void {\n    if (\n        event.key !== 'ArrowDown' &&\n        event.key !== 'ArrowUp' &&\n        event.key !== 'ArrowLeft' &&\n        event.key !== 'ArrowRight'\n    ) {\n        return;\n    }\n\n    event.preventDefault();\n\n    const focusableElements = getFocusableElements(container);\n    if (focusableElements.length === 0) return;\n\n    const currentIndex = getCurrentFocusIndex(focusableElements);\n    let nextIndex = 0;\n\n    if (event.key === 'ArrowDown' || event.key === 'ArrowRight') {\n        nextIndex =\n            currentIndex < 0 || currentIndex >= focusableElements.length - 1\n                ? 0\n                : currentIndex + 1;\n    } else if (event.key === 'ArrowUp' || event.key === 'ArrowLeft') {\n        nextIndex =\n            currentIndex <= 0 ? focusableElements.length - 1 : currentIndex - 1;\n    }\n\n    focusElementAtIndex(focusableElements, nextIndex);\n}\n\nexport function handleHomeEndNavigation(\n    event: KeyboardEvent,\n    container: HTMLElement,\n): void {\n    if (event.key !== 'Home' && event.key !== 'End') {\n        return;\n    }\n\n    event.preventDefault();\n\n    const focusableElements = getFocusableElements(container);\n    if (focusableElements.length === 0) return;\n\n    if (event.key === 'Home') {\n        focusElementAtIndex(focusableElements, 0);\n    } else {\n        focusElementAtIndex(focusableElements, focusableElements.length - 1);\n    }\n}\n\nexport function handleTabFocusTrap(\n    event: KeyboardEvent,\n    container: HTMLElement,\n): void {\n    if (event.key !== 'Tab') {\n        return;\n    }\n\n    const focusableElements = getFocusableElements(container);\n    if (focusableElements.length === 0) return;\n\n    const firstElement = focusableElements[0];\n    const lastElement = focusableElements[focusableElements.length - 1];\n\n    event.preventDefault();\n\n    if (event.shiftKey) {\n        if (document.activeElement === firstElement) {\n            lastElement.focus();\n        } else {\n            const currentIndex = getCurrentFocusIndex(focusableElements);\n            const nextIndex =\n                currentIndex > 0\n                    ? currentIndex - 1\n                    : focusableElements.length - 1;\n            focusElementAtIndex(focusableElements, nextIndex);\n        }\n    } else {\n        if (document.activeElement === lastElement) {\n            firstElement.focus();\n        } else {\n            const currentIndex = getCurrentFocusIndex(focusableElements);\n            const nextIndex =\n                currentIndex < focusableElements.length - 1\n                    ? currentIndex + 1\n                    : 0;\n            focusElementAtIndex(focusableElements, nextIndex);\n        }\n    }\n}\n\nexport function createMenuKeydownHandler(options: KeyboardNavigationOptions) {\n    return (event: KeyboardEvent) => {\n        const { container, onEscape, onEnter, onSpace } = options;\n\n        if (event.key === 'Escape' && onEscape) {\n            event.preventDefault();\n            onEscape();\n            return;\n        }\n\n        if (event.key === 'Enter' && onEnter) {\n            event.preventDefault();\n            onEnter(event.target as HTMLElement);\n            return;\n        }\n\n        if (event.key === ' ' && onSpace) {\n            event.preventDefault();\n            onSpace(event.target as HTMLElement);\n            return;\n        }\n\n        if (event.key === 'Tab') {\n            handleTabFocusTrap(event, container);\n            return;\n        }\n\n        handleArrowNavigation(event, container);\n        handleHomeEndNavigation(event, container);\n    };\n}\n\nexport function focusFirstElement(\n    container: HTMLElement,\n    delay: number = 50,\n): void {\n    setTimeout(() => {\n        const focusableElements = getFocusableElements(container);\n        if (focusableElements.length > 0) {\n            focusableElements[0].focus();\n        }\n    }, delay);\n}\n"],"names":[],"mappings":"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"}