import{r as t,c as s,g as e,h as i,F as a,H as o}from"./p-jvbUuQtg.js";import{c as n}from"./p-COG8_R0C.js";import{f as r}from"./p-DuLooPsr.js";import{PromptResponseScore as l}from"./index.esm.js";const h=n("rounded-lg py-4 text-base",{variants:{role:{user:"bg-surface-2 text-dark ml-auto inline-block p-8",assistant:"text-dark mr-auto",system:"text-dark mr-auto"},loading:{true:"animate-pulse",false:""}},defaultVariants:{role:"user",loading:!1}}),p=class{constructor(e){t(this,e),this.atCopy=s(this,"atCopy",7),this.atVote=s(this,"atVote",7),this.atRetry=s(this,"atRetry",7),this.atEdit=s(this,"atEdit",7)}role="user";content="";name;loading=!1;error=!1;error_message;score=l.NONE;enable_vote=!1;enable_copy=!1;enable_edit=!1;message_id;response_animation="words";atCopy;atVote;atRetry;atEdit;translations;copyFeedbackVisible=!1;animatedContent="";isAnimating=!1;errorEl;get el(){return e(this)}async componentWillLoad(){this.translations=await r(this.el),this.initializeContent()}watchContentChange(t){t&&"words"===this.response_animation&&"assistant"===this.role?this.startWordAnimation(t):this.animatedContent=t}initializeContent(){this.content&&"words"===this.response_animation&&"assistant"===this.role?this.startWordAnimation(this.content):this.animatedContent=this.content}startWordAnimation(t){if(this.isAnimating)return;this.isAnimating=!0,this.animatedContent="";const s=t.split(" ");let e=0;const i=()=>{if(e<s.length){0===e?this.animatedContent=s[e]:this.animatedContent+=" "+s[e],e++;const t=30*Math.random()+30;setTimeout(i,t)}else this.isAnimating=!1};setTimeout(i,30)}handleCopy=async()=>{try{await navigator.clipboard.writeText(this.content),this.copyFeedbackVisible=!0,this.atCopy.emit(this.content),setTimeout((()=>{this.copyFeedbackVisible=!1}),2e3)}catch(t){console.error("Failed to copy text:",t)}};handleRetry=()=>{this.atRetry.emit()};handleEdit=()=>{this.atEdit.emit(this.content)};handleVote=t=>{this.atVote.emit({messageId:this.message_id,score:this.score===t?l.NONE:t})};renderActions(){return this.loading?null:i("div",{class:"mt-2 flex items-center justify-end gap-2","data-name":"message-actions"},"user"===this.role&&this.enable_edit&&i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",icon:"edit",class:"text-xs",onClick:this.handleEdit,"data-name":"edit-button"}),i("span",null,this.translations?.ATUI?.PROMPT?.EDIT||"Edit")),"assistant"===this.role&&this.enable_vote&&i(a,null,i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",onClick:()=>this.handleVote(l.UP),"data-name":"vote-up-button"},this.score===l.UP?i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"0 -960 960 960",width:"15px",fill:"#000000"},i("path",{d:"M720-144H264v-480l288-288 32 22q18 13 26.5 33t3.5 41l-38 192h264q30 0 51 21t21 51v57q0 8-1.5 14.5T906-467L787-188q-9 20-27 32t-40 12Z"})):i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"http://www.w3.org/2000/svg",width:"15px",fill:"#adb5bd"},i("path",{d:"M720-144H264v-480l288-288 32 22q17 12 26 30.5t5 38.5l-1 5-38 192h264q30 0 51 21t21 51v57q0 8-1.5 14.5T906-467L786.93-187.8Q778-168 760-156t-40 12Zm-384-72h384l120-279v-57H488l49-243-201 201v378Zm0-378v378-378Z"}))),i("span",null,this.translations?.ATUI?.PROMPT?.HELPFUL||"Helpful")),i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",onClick:()=>this.handleVote(l.DOWN),"data-name":"vote-down-button"},this.score===l.DOWN?i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"http://www.w3.org/2000/svg",width:"15px",fill:"#000000"},i("path",{d:"M240-816h456v480L408-48l-32-22q-18-13-26.5-33t-3.5-41l38-192H120q-30 0-51-21t-21-51v-57q0-8 1.5-14.5T54-493l119-279q8-20 26.5-32t40.5-12Z"})):i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15px",viewBox:"http://www.w3.org/2000/svg",height:"15px",fill:"#adb5bd"},i("path",{d:"M240-816h456v480L408-48l-32-22q-17-12-26-30.5t-5-38.5l1-5 38-192H120q-30 0-51-21t-21-51v-57q0-8 1.5-14.5T54-493l119-279q8-20 26.5-32t40.5-12Zm384 72H240L120-465v57h352l-49 243 201-201v-378Zm0 378v-378 378Z"}))),i("span",null,this.translations?.ATUI?.PROMPT?.NOT_HELPFUL||"Not Helpful"))),"assistant"===this.role&&this.enable_copy&&i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",icon:this.copyFeedbackVisible?"check":"content_copy",type:"secondaryText",onClick:this.handleCopy,"data-name":"copy-button"}),i("span",null,this.copyFeedbackVisible?this.translations?.ATUI?.PROMPT?.COPIED||"Copied":this.translations?.ATUI?.PROMPT?.COPY||"Copy")),"assistant"===this.role&&this.error&&i("at-tooltip",{position:"top"},i("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",icon:"refresh",onClick:this.handleRetry,"data-name":"retry-button"}),i("span",null,this.translations?.ATUI?.PROMPT?.RETRY||"Retry")))}renderContent(){if(this.loading)return i("div",{class:"py-8","data-name":"loading-wrapper"},i("at-loading",{class:"flex items-center gap-4 py-8","data-name":"loading-content",variant:"typing",size:"sm"}));if(this.error)return i("div",{class:"space-y-2",ref:t=>this.errorEl=t,"data-name":"error-content"},i("p",{class:"text-destructive-foreground"},this.error_message||this.translations?.ATUI?.PROMPT?.ERROR_GENERATING_RESPONSE||"Error generating response"));const t="words"===this.response_animation&&"assistant"===this.role?this.animatedContent:this.content;return i("div",{class:"prose prose-sm preserve-newlines max-w-none "+("fade"===this.response_animation||"words"===this.response_animation?"at-prompt-fade-in":""),"data-name":"message-content"},i("slot",null),t)}render(){const t=h({role:this.role,loading:this.loading});return i(o,{key:"e8d2987e49c6a8e49593e34d4b8db12aa2757a14",class:"flex w-full gap-8","data-name":"message-container","data-role":this.role},i("div",{key:"d92a1c0465cce62d4560cc9ee13a8c1186aa7407",class:"flex flex-1 flex-col"},this.name&&i("span",{key:"ec1605220b7abc644bcad717d388cd9521ee0d49",class:"text-light self-start text-sm","data-name":"message-name"},this.name),i("div",{key:"7e17c2ffec642d11605c76794be35654f2379906",class:t},this.renderContent()),this.renderActions()))}static get watchers(){return{content:[{watchContentChange:0}]}}};p.style="@keyframes atPromptFadeIn{from{opacity:0}to{opacity:1}}@keyframes atPromptTypingCursorBlink{0%,50%{opacity:1}51%,100%{opacity:0}}.at-prompt-fade-in{animation:atPromptFadeIn 0.6s ease-out}";export{p as at_prompt_message}