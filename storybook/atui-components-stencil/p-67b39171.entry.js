import{r as t,c as s,a as e,h as a,F as i,H as o}from"./p-Cod2-jIY.js";import{c as n}from"./p-COG8_R0C.js";import{f as r}from"./p-DuLooPsr.js";import{PromptResponseScore as l}from"./index.esm.js";const h="@keyframes atPromptFadeIn{from{opacity:0}to{opacity:1}}@keyframes atPromptTypingCursorBlink{0%,50%{opacity:1}51%,100%{opacity:0}}.at-prompt-fade-in{animation:atPromptFadeIn 0.6s ease-out}";const d={variants:{role:{user:"bg-surface-2 text-dark ml-auto inline-block p-8",assistant:"text-dark mr-auto",system:"text-dark mr-auto"},loading:{true:"animate-pulse",false:""}},defaultVariants:{role:"user",loading:false}};const p=n("rounded-lg py-4 text-base",d);const c=class{constructor(e){t(this,e);this.atCopy=s(this,"atCopy",7);this.atVote=s(this,"atVote",7);this.atRetry=s(this,"atRetry",7);this.atEdit=s(this,"atEdit",7)}role="user";content="";name;loading=false;error=false;error_message;score=l.NONE;enable_vote=false;enable_copy=false;enable_edit=false;message_id;response_animation="words";atCopy;atVote;atRetry;atEdit;translations;copyFeedbackVisible=false;animatedContent="";isAnimating=false;errorEl;get el(){return e(this)}async componentWillLoad(){this.translations=await r(this.el);this.initializeContent()}watchContentChange(t){if(t&&this.response_animation==="words"&&this.role==="assistant"){this.startWordAnimation(t)}else{this.animatedContent=t}}initializeContent(){if(this.content&&this.response_animation==="words"&&this.role==="assistant"){this.startWordAnimation(this.content)}else{this.animatedContent=this.content}}startWordAnimation(t){if(this.isAnimating)return;this.isAnimating=true;this.animatedContent="";const s=t.split(" ");let e=0;const a=()=>{if(e<s.length){if(e===0){this.animatedContent=s[e]}else{this.animatedContent+=" "+s[e]}e++;const t=Math.random()*30+30;setTimeout(a,t)}else{this.isAnimating=false}};setTimeout(a,30)}handleCopy=async()=>{try{await navigator.clipboard.writeText(this.content);this.copyFeedbackVisible=true;this.atCopy.emit(this.content);setTimeout((()=>{this.copyFeedbackVisible=false}),2e3)}catch(t){console.error("Failed to copy text:",t)}};handleRetry=()=>{this.atRetry.emit()};handleEdit=()=>{this.atEdit.emit(this.content)};handleVote=t=>{const s=this.score===t?l.NONE:t;this.atVote.emit({messageId:this.message_id,score:s})};renderActions(){if(this.loading)return null;return a("div",{class:"mt-2 flex items-center justify-end gap-2","data-name":"message-actions"},this.role==="user"&&this.enable_edit&&a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",icon:"edit",class:"text-xs",onClick:this.handleEdit,"data-name":"edit-button"}),a("span",null,this.translations?.ATUI?.PROMPT?.EDIT||"Edit")),this.role==="assistant"&&this.enable_vote&&a(i,null,a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",onClick:()=>this.handleVote(l.UP),"data-name":"vote-up-button"},this.score===l.UP?a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"0 -960 960 960",width:"15px",fill:"#000000"},a("path",{d:"M720-144H264v-480l288-288 32 22q18 13 26.5 33t3.5 41l-38 192h264q30 0 51 21t21 51v57q0 8-1.5 14.5T906-467L787-188q-9 20-27 32t-40 12Z"})):a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"0 -960 960 960",width:"15px",fill:"#adb5bd"},a("path",{d:"M720-144H264v-480l288-288 32 22q17 12 26 30.5t5 38.5l-1 5-38 192h264q30 0 51 21t21 51v57q0 8-1.5 14.5T906-467L786.93-187.8Q778-168 760-156t-40 12Zm-384-72h384l120-279v-57H488l49-243-201 201v378Zm0-378v378-378Z"}))),a("span",null,this.translations?.ATUI?.PROMPT?.HELPFUL||"Helpful")),a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",onClick:()=>this.handleVote(l.DOWN),"data-name":"vote-down-button"},this.score===l.DOWN?a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"0 -960 960 960",width:"15px",fill:"#000000"},a("path",{d:"M240-816h456v480L408-48l-32-22q-18-13-26.5-33t-3.5-41l38-192H120q-30 0-51-21t-21-51v-57q0-8 1.5-14.5T54-493l119-279q8-20 26.5-32t40.5-12Z"})):a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15px",viewBox:"0 -960 960 960",height:"15px",fill:"#adb5bd"},a("path",{d:"M240-816h456v480L408-48l-32-22q-17-12-26-30.5t-5-38.5l1-5 38-192H120q-30 0-51-21t-21-51v-57q0-8 1.5-14.5T54-493l119-279q8-20 26.5-32t40.5-12Zm384 72H240L120-465v57h352l-49 243 201-201v-378Zm0 378v-378 378Z"}))),a("span",null,this.translations?.ATUI?.PROMPT?.NOT_HELPFUL||"Not Helpful"))),this.role==="assistant"&&this.enable_copy&&a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",icon:this.copyFeedbackVisible?"check":"content_copy",type:"secondaryText",onClick:this.handleCopy,"data-name":"copy-button"}),a("span",null,this.copyFeedbackVisible?this.translations?.ATUI?.PROMPT?.COPIED||"Copied":this.translations?.ATUI?.PROMPT?.COPY||"Copy")),this.role==="assistant"&&this.error&&a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",icon:"refresh",onClick:this.handleRetry,"data-name":"retry-button"}),a("span",null,this.translations?.ATUI?.PROMPT?.RETRY||"Retry")))}renderContent(){if(this.loading){return a("div",{class:"py-8","data-name":"loading-wrapper"},a("at-loading",{class:"flex items-center gap-4 py-8","data-name":"loading-content",variant:"typing",size:"sm"}))}if(this.error){return a("div",{class:"space-y-2",ref:t=>this.errorEl=t,"data-name":"error-content"},a("p",{class:"text-destructive-foreground"},this.error_message||this.translations?.ATUI?.PROMPT?.ERROR_GENERATING_RESPONSE||"Error generating response"))}const t=this.response_animation==="words"&&this.role==="assistant"?this.animatedContent:this.content;const s=this.response_animation==="fade"||this.response_animation==="words"?"at-prompt-fade-in":"";return a("div",{class:`prose prose-sm preserve-newlines max-w-none ${s}`,"data-name":"message-content"},a("slot",null),t)}render(){const t=p({role:this.role,loading:this.loading});return a(o,{key:"86f5a6d4f29c6de273fcd402fd639436de4f6cb1",class:"flex w-full gap-8","data-name":"message-container","data-role":this.role},a("div",{key:"0d1a5a9fd8583d88a368d900115ec5eb20e9c8e2",class:"flex flex-1 flex-col"},this.name&&a("span",{key:"ab5a758470afba91842a0d34edf81306cf4dee21",class:"text-light self-start text-sm","data-name":"message-name"},this.name),a("div",{key:"f29e5eaef7df42681d338e12f579c01aada1223d",class:t},this.renderContent()),this.renderActions()))}static get watchers(){return{content:["watchContentChange"]}}};c.style=h;export{c as at_prompt_message};
//# sourceMappingURL=p-67b39171.entry.js.map