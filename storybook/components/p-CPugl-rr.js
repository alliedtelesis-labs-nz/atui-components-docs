import{p as t,H as e,d as s,h as i,c as a,t as o}from"./p-CGooRokE.js";import{f as r}from"./p-DuLooPsr.js";import{c as n}from"./p-COG8_R0C.js";import{h as l,a as h}from"./p-CF3ljWUs.js";import{d as c}from"./p-DLlWJE6U.js";import{d}from"./p-BF1qhNk1.js";import{d as u}from"./p-COVJfV1p.js";import{d as p}from"./p-BqblBn6C.js";import{d as f}from"./p-BSx33cCi.js";import{d as m}from"./p-BsHDeWPp.js";import{d as b}from"./p-D3zsC1jI.js";const g={variants:{focused:{false:"ring-active-foreground/30",true:"pointer-events-none"},disabled:{false:"focus-within:ring-active-foreground/30 cursor-pointer bg-white",true:"bg-surface-1 !text-disabled pointer-events-none border-none"},readonly:{false:"focus-within:ring-active-foreground/30",true:"!bg-surface-1 !text-dark cursor-text border-none"},invalid:{false:"border-med focus-within:border-active-dark focus-within:ring-active-foreground/30",true:"border-error-base focus-within:border-error-base focus-within:ring-destructive-foreground/30"}},defaultVariants:{disabled:!1,readonly:!1,invalid:!1}},x=t(class extends e{constructor(t){super(),!1!==t&&this.__registerHost(),this.atuiChange=s(this,"atuiChange",7)}value;options;label;hint_text;info_text;placeholder;error_text;required;invalid;disabled;readonly;clearable;typeahead=!1;autoclose=!0;inputEl;searchText="";isOpen=!1;translations;hasMatchingElOptions=!1;parentWidth;filteredOptions=[];get el(){return this}menuId=`dropdown-${Math.random().toString(36).substring(2,11)}`;menuRef;optionEls=[];searchInputEl;watchValue(t){this.optionEls.forEach((e=>{e.is_active=t===e.value}))}watchSearchText(t){const e=t.trim().toLowerCase();if(this.options&&this.options.length>0)return this.filteredOptions=this.filterOptions(this.options),void(this.hasMatchingElOptions=this.filteredOptions.length>0);this.filterSlottedOptions(e),this.filterSlottedGroups(),this.hasMatchingElOptions=Array.from(this.optionEls).some((t=>"none"!==t.style.display))}watchFilterInputs(){this.filteredOptions=this.filterOptions(this.options||[])}atuiChange;componentWillLoad(){r(this.el).then((t=>{this.translations=t}))}componentDidLoad(){this.setupOptionElements(),this.options&&this.options.length>0&&(this.filteredOptions=this.options);const t=this.el.getBoundingClientRect();this.parentWidth=`${t.width}px`}setupOptionElements(){this.el.querySelectorAll("at-select-option").forEach((t=>{const e=t;e.is_active=this.value===e.value,e.addEventListener("atuiClick",(t=>{this.handleChange(t.detail)})),this.optionEls.push(e)}))}filterOptions(t){const e=this.searchText.trim().toLowerCase();return e?t.map((t=>{if(this.isGroup(t)){const s=t.children.filter((t=>t.value.toLowerCase().includes(e)));return s.length>0?{...t,children:s}:null}return t.value.toLowerCase().includes(e)?t:null})).filter(Boolean):t}filterSlottedOptions(t){this.optionEls.forEach((e=>{const s=!t||e.value.toLowerCase().includes(t);e.style.display=s?"":"none"}))}filterSlottedGroups(){this.el.querySelectorAll("at-select-group").forEach((t=>{const e=Array.from(t.querySelectorAll("at-select-option")).some((t=>"none"!==t.style.display));t.style.display=e?"":"none"}))}updateIsOpenState(t){this.isOpen=t.detail;const e=this.el.querySelector('[slot="menu-trigger"]'),s=e?.getBoundingClientRect();s&&s.width>0&&(this.parentWidth=`${s.width}px`),this.isOpen&&this.typeahead&&requestAnimationFrame((()=>{this.searchInputEl&&this.searchInputEl.focus()}))}async handleChange(t){this.autoclose&&await(this.menuRef?.closeMenu()),this.value=t,this.inputEl.focus(),this.atuiChange.emit(this.value)}async handleClear(){this.searchText=""}async handleKeyDownMenu(t){if("Enter"===t.key||" "===t.key)return void(t.target instanceof HTMLLIElement&&(t.preventDefault(),t.target.click()));const e=this.el.querySelector('ul[id="at-select"]');e&&(l(t,e),h(t,e))}handleSearchInput(t){this.searchText=t.target.value.toLowerCase()}isGroup(t){return!!(t.children&&t.children.length>0)}get hasMatchingOptions(){return this.filteredOptions.length>0}render(){return i(a,{key:"b07fd1c45510cdefd5473e98c43dbc9026da5dda",class:"group/select",onFocusout:async t=>{await this.handleClear();const e=t.relatedTarget;e&&this.el.contains(e)||setTimeout((async()=>{await(this.menuRef?.closeMenu())}),100)}},this.renderLabel(),i("at-menu",{key:"7965cd3ca2046de326f4febd1a3bf2b64335a54b",ref:t=>this.menuRef=t,trigger:"click",align:"start",width:this.parentWidth,role:"listbox",disabled:this.disabled||this.readonly,onAtuiMenuStateChange:t=>this.updateIsOpenState(t)},this.renderInput(),this.disabled&&this.readonly?null:this.renderOptions()),i("div",{key:"b30d1208fd4eb2c7a68e26d0d7380c10de9062c2"},this.error_text&&this.invalid&&i("span",{key:"7c5ba11cd01bf5d1af2bcc21824b8fc31ffb758f",class:"text-error","data-name":"select-error"},this.error_text)))}renderLabel(){return i("div",{class:"mb-4 flex flex-col"},i("slot",{name:"label"}),(this.label||this.required||this.info_text)&&i("at-form-label",{for:this.menuId,label:this.label,required:this.required&&!this.readonly,info_text:this.info_text}),this.hint_text&&i("span",{class:"text-light inline-block text-xs leading-tight","data-name":"select-hint"},this.hint_text))}renderInput(){const t=n("height-[36px] transition[background-color,color,box-shadow] placeholder-text-light group/select:focus-within:ring-2 w-full cursor-pointer rounded-md border border-solid p-8 outline-0 duration-300 ease-in-out select-none focus:ring-2",g)({invalid:this.invalid,disabled:this.disabled,readonly:this.readonly});return i("div",{class:"relative flex items-center gap-4",slot:"menu-trigger"},i("input",{class:t,role:"combobox",list:"at-select","aria-expanded":this.isOpen,"aria-controls":this.menuId,type:"text",readonly:!0,"aria-disabled":this.disabled,disabled:this.disabled,placeholder:this.placeholder,value:this.value,"data-name":"select-input",ref:t=>this.inputEl=t}),!this.readonly&&!this.disabled&&i("div",{class:"bg-surface1 absolute right-4 flex h-full cursor-pointer items-center rounded-md p-4 select-none",role:"presentation",tabindex:-1},i("span",{class:"material-icons h-16 w-16 text-[16px] leading-[16px]","data-name":"button-icon-right"},this.isOpen?"arrow_drop_up":"arrow_drop_down")))}renderOptions(){return i("ul",{class:"contents",id:"at-select",onKeyDown:async t=>{await this.handleKeyDownMenu(t)}},this.typeahead&&i("div",{class:"relative z-10 bg-white p-4"},i("input",{type:"text",class:`transition[background-color,color] bg-surface-1 ring-active-foreground/30 mb-4 h-[28px] w-full flex-shrink flex-grow basis-0 rounded-md p-8 outline-0 duration-300 ease-in-out focus:ring-2 ${this.clearable?"pr-24":""} `,placeholder:this.translations?.ATUI?.SEARCH||"Search",name:"",autoComplete:"off","aria-autocomplete":"list",value:this.searchText,onInput:t=>{t.stopPropagation(),this.handleSearchInput(t)},onClick:t=>t.stopPropagation(),ref:t=>this.searchInputEl=t}),this.clearable&&""!==this.searchText&&i("div",{class:"absolute top-4 right-4"},i("at-button",{class:"m-2",size:"sm",icon:"cancel",type:"secondaryText",onClick:async t=>{t.stopPropagation(),await this.handleClear()},"data-name":"select-clear"}))),this.filteredOptions?.map((t=>this.isGroup(t)?this.renderGroupedOption(t):this.renderOption(t))).filter(Boolean),i("slot",null),this.typeahead&&this.searchText&&!this.hasMatchingOptions&&!this.hasMatchingElOptions&&i("div",{class:"text-body text-light w-full bg-white px-16 py-8"},this.translations?.ATUI?.NO_RESULTS_FOUND||"No results found"))}renderOption(t){return i("at-select-option",{value:t.value,is_active:this.value===t.key,onAtuiClick:()=>this.handleChange(t.key)})}renderGroupedOption(t){return this.isGroup(t)&&t.children&&0!==t.children.length?i("at-select-group",{label:t.value},t.children.map((t=>i("at-select-option",{value:t.value,is_active:this.value===t.key,option_group:!0,onAtuiClick:()=>this.handleChange(t.key)})))):null}renderTitle(t){return i("li",{class:"text-light border-light border-b px-0 pt-8 pb-4 text-sm","data-name":"select-option-group-title"},t)}static get watchers(){return{value:[{watchValue:0}],searchText:[{watchSearchText:0}],options:[{watchFilterInputs:0}]}}},[772,"at-select",{value:[1025],options:[16],label:[1],hint_text:[1],info_text:[1],placeholder:[1],error_text:[1],required:[4],invalid:[4],disabled:[4],readonly:[4],clearable:[4],typeahead:[4],autoclose:[4],searchText:[32],isOpen:[32],translations:[32],hasMatchingElOptions:[32],parentWidth:[32],filteredOptions:[32]},void 0,{value:[{watchValue:0}],searchText:[{watchSearchText:0}],options:[{watchFilterInputs:0}]}]);function w(){"undefined"!=typeof customElements&&["at-select","at-button","at-form-label","at-loading","at-menu","at-select-group","at-select-option","at-tooltip"].forEach((t=>{switch(t){case"at-select":customElements.get(o(t))||customElements.define(o(t),x);break;case"at-button":customElements.get(o(t))||c();break;case"at-form-label":customElements.get(o(t))||d();break;case"at-loading":customElements.get(o(t))||u();break;case"at-menu":customElements.get(o(t))||p();break;case"at-select-group":customElements.get(o(t))||f();break;case"at-select-option":customElements.get(o(t))||m();break;case"at-tooltip":customElements.get(o(t))||b()}}))}export{x as A,w as d}