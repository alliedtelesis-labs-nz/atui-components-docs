import{p as t,H as e,d as s,h as a,c as i,t as n}from"./p-CGooRokE.js";import{f as o}from"./p-DuLooPsr.js";import{d as r}from"./p-fL1k4w5P.js";import{d as h}from"./p-kGnTu-GQ.js";import{d}from"./p-COVJfV1p.js";import{d as p}from"./p-DbNNy-wm.js";import{d as l}from"./p-DrYtKBaJ.js";import{d as m}from"./p-DdM4Jqfy.js";import{d as c}from"./p-B8-EiVSh.js";const u=t(class extends e{constructor(t){super(),!1!==t&&this.__registerHost(),this.atSubmit=s(this,"atSubmit",7),this.atStop=s(this,"atStop",7),this.atNewThread=s(this,"atNewThread",7),this.atMessageCopy=s(this,"atMessageCopy",7),this.atMessageRetry=s(this,"atMessageRetry",7),this.atMessageEdit=s(this,"atMessageEdit",7),this.atMessageVote=s(this,"atMessageVote",7)}get el(){return this}messages=[];placeholder="Type your message here...";error_text;loading=!1;disabled=!1;show_new_thread_button=!0;max_message_length=2e3;enable_vote=!0;enable_copy=!0;enable_edit=!1;response_animation="words";currentInput="";inputInvalid=!1;inputError="";isSendEnabled=!0;translations={};atSubmit;atStop;atNewThread;atMessageCopy;atMessageRetry;atMessageEdit;atMessageVote;inputComponent;async componentWillLoad(){this.translations=await o(this.el)}handleInputSubmit(t){const e=t.detail.trim();e&&this.isSendEnabled&&!this.disabled&&!this.loading&&this.handleSubmit(e)}handleMessageCopy(t){this.atMessageCopy.emit(t.detail)}handleMessageRetry(t){this.atMessageRetry.emit(t.detail)}async handleMessageEdit(t){this.atMessageEdit.emit(t.detail),this.inputComponent&&(this.inputComponent.value=t.detail.content,await this.focusInput())}handleMessageVote(t){const e=this.messages.findIndex((e=>e.id===t.detail.messageId));if(-1!==e){const s=[...this.messages];s[e]={...s[e],score:t.detail.score},this.messages=s,this.atMessageVote.emit(t.detail)}this.atMessageVote.emit(t.detail)}async addMessage(t,e){const s={id:""+Date.now(),role:t,content:e};this.messages=[...this.messages,s]}async appendToLastMessage(t){if(0===this.messages.length)return!1;const e=this.messages[this.messages.length-1];return"assistant"===e.role&&(e.content+=t,this.messages=[...this.messages],!0)}async newThread(){this.messages=[],this.currentInput="",this.isSendEnabled=!0,this.atNewThread.emit(),setTimeout((()=>this.focusInput()),100)}async setSendEnabled(t){this.isSendEnabled=t}async focusInput(){this.inputComponent&&setTimeout((()=>{this.inputComponent.focus()}),0)}handleSubmit=async t=>{t&&!this.disabled&&!this.loading&&this.isSendEnabled&&(this.isSendEnabled=!1,await this.addMessage("user",t),this.atSubmit.emit(t))};handleStop=()=>{this.atStop.emit()};handleNewThread=async()=>{await this.newThread()};renderHeader(){return this.show_new_thread_button?a("div",{class:"flex justify-end pb-16"},a("at-button",{slot:"actions",size:"md",type:"primaryOutline",onClick:this.handleNewThread,disabled:this.loading,"data-name":"new-thread-button"},this.translations?.ATUI?.PROMPT?.NEW_THREAD||"New Thread")):null}renderFooter(){return a("div",{class:"p-4"},a("at-prompt-input",{ref:t=>this.inputComponent=t,placeholder:this.placeholder,in_progress:this.loading,max_length:this.max_message_length,error_text:this.error_text,"data-name":"prompt-container-input",onAtSubmit:t=>this.handleSubmit(t.detail),onAtStop:()=>this.handleStop()}))}render(){return a(i,{key:"888cd7a1634ee219ba630dab7bbd83365e338668",class:"flex h-full w-full flex-col overflow-hidden","data-name":"prompt-container"},this.renderHeader(),a("slot",{key:"012212380641f603b9351fef70d5e3748c08d459",name:"prompt-container-header"}),a("div",{key:"5c000086b524d7c6ac83aa18c161af3c51e7daf0",class:"min-h-0 flex-1","data-name":"thread-wrapper"},a("at-prompt-thread",{key:"9e883bd9940a6b7c70de3e1e45302b8c286b3d6e",messages:this.messages,loading:this.loading,auto_scroll:!0,enable_vote:this.enable_vote,enable_copy:this.enable_copy,enable_edit:this.enable_edit,response_animation:this.response_animation,"data-name":"container-thread"})),a("div",{key:"94f2d7b5ccb00890da905046e390e57a8b70acd5",class:"flex flex-col gap-4"},this.renderFooter(),a("slot",{key:"74238c53f7e713e5d9fedb1499936432548d2fd4",name:"prompt-container-footer"})))}},[772,"at-prompt-container",{messages:[1040],placeholder:[1],error_text:[1],loading:[4],disabled:[4],show_new_thread_button:[4],max_message_length:[2],enable_vote:[4],enable_copy:[4],enable_edit:[4],response_animation:[1],currentInput:[32],inputInvalid:[32],inputError:[32],isSendEnabled:[32],translations:[32],addMessage:[64],appendToLastMessage:[64],newThread:[64],setSendEnabled:[64],focusInput:[64]},[[0,"atSubmit","handleInputSubmit"],[0,"atThreadMessageCopy","handleMessageCopy"],[0,"atThreadMessageRetry","handleMessageRetry"],[0,"atThreadMessageEdit","handleMessageEdit"],[0,"atThreadMessageVote","handleMessageVote"]]]),b=u,f=function(){"undefined"!=typeof customElements&&["at-prompt-container","at-button","at-form-label","at-loading","at-prompt-input","at-prompt-message","at-prompt-thread","at-tooltip"].forEach((t=>{switch(t){case"at-prompt-container":customElements.get(n(t))||customElements.define(n(t),u);break;case"at-button":customElements.get(n(t))||r();break;case"at-form-label":customElements.get(n(t))||h();break;case"at-loading":customElements.get(n(t))||d();break;case"at-prompt-input":customElements.get(n(t))||p();break;case"at-prompt-message":customElements.get(n(t))||l();break;case"at-prompt-thread":customElements.get(n(t))||m();break;case"at-tooltip":customElements.get(n(t))||c()}}))};export{b as AtPromptContainer,f as defineCustomElement}