{"file":"at-prompt-container.js","mappings":";;;;;;;;;;;MAyBaA,mBAAiB,iBAAAC,kBAAA,CAAA,MAAA,iBAAA,SAAAC,CAAA,CAAA;AAJ9B,IAAA,WAAA,GAAA;;;;;;;;;;AAOI;;AAEG;AACsB,QAAA,IAAQ,CAAA,QAAA,GAAoB,EAAE;AAEvD;;AAEG;AACK,QAAA,IAAY,CAAA,YAAA,GAAW,cAAc;AAO7C;;AAEG;AACK,QAAA,IAAW,CAAA,WAAA,GAAW,2BAA2B;AAQzD;;AAEG;AACK,QAAA,IAAO,CAAA,OAAA,GAAY,KAAK;AAEhC;;AAEG;AACK,QAAA,IAAQ,CAAA,QAAA,GAAY,KAAK;AAEjC;;AAEG;AACK,QAAA,IAAW,CAAA,WAAA,GAAY,IAAI;AAEnC;;AAEG;AACK,QAAA,IAAsB,CAAA,sBAAA,GAAY,IAAI;AAE9C;;AAEG;AACK,QAAA,IAAkB,CAAA,kBAAA,GAAW,IAAI;AAEzC;;AAEG;AACK,QAAA,IAAW,CAAA,WAAA,GAAY,IAAI;AAEnC;;AAEG;AACK,QAAA,IAAW,CAAA,WAAA,GAAY,IAAI;AAEnC;;AAEG;AACK,QAAA,IAAW,CAAA,WAAA,GAAY,KAAK;AAE3B,QAAA,IAAY,CAAA,YAAA,GAAW,EAAE;AACzB,QAAA,IAAY,CAAA,YAAA,GAAY,KAAK;AAC7B,QAAA,IAAU,CAAA,UAAA,GAAW,EAAE;AACvB,QAAA,IAAa,CAAA,aAAA,GAAY,IAAI;AAC7B,QAAA,IAAY,CAAA,YAAA,GAAQ,EAAE;AA0KvB,QAAA,IAAA,CAAA,YAAY,GAAG,OAAO,OAAe,KAAI;AAC7C,YAAA,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;gBAClE;;AAGJ,YAAA,IAAI,CAAC,aAAa,GAAG,KAAK;YAE1B,MAAM,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,OAAO,CAAC;AACtC,YAAA,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC;AAC/B,SAAC;AAEO,QAAA,IAAU,CAAA,UAAA,GAAG,MAAK;AACtB,YAAA,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;AACtB,SAAC;AAEO,QAAA,IAAe,CAAA,eAAA,GAAG,YAAW;AACjC,YAAA,MAAM,IAAI,CAAC,SAAS,EAAE;AAC1B,SAAC;AA8EJ;AAvNG,IAAA,MAAM,iBAAiB,GAAA;QACnB,IAAI,CAAC,YAAY,GAAG,MAAM,iBAAiB,CAAC,IAAI,CAAC,EAAE,CAAC;;AAIxD,IAAA,iBAAiB,CAAC,KAA0B,EAAA;QACxC,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE;AACnC,QAAA,IAAI,OAAO,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;AAClE,YAAA,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC;;;AAKlC,IAAA,iBAAiB,CACb,KAA0D,EAAA;QAE1D,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;;AAIzC,IAAA,kBAAkB,CAAC,KAAyC,EAAA;QACxD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;;IAI1C,MAAM,iBAAiB,CACnB,KAA0D,EAAA;QAE1D,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;AACrC,QAAA,IAAI,IAAI,CAAC,cAAc,EAAE;YACrB,IAAI,CAAC,cAAc,CAAC,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO;AAChD,YAAA,MAAM,IAAI,CAAC,UAAU,EAAE;;;AAK/B,IAAA,iBAAiB,CACb,KAAwD,EAAA;QAExD,KAAK,CAAC,eAAe,EAAE;QACvB,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CACxC,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,KAAK,KAAK,CAAC,MAAM,CAAC,SAAS,CAC7C;AACD,QAAA,IAAI,YAAY,KAAK,EAAE,EAAE;YACrB,MAAM,eAAe,GAAG,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC1C,YAAA,eAAe,CAAC,YAAY,CAAC,GACtB,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,eAAe,CAAC,YAAY,CAAC,CAChC,EAAA,EAAA,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,KAAK,GAC5B;AACD,YAAA,IAAI,CAAC,QAAQ,GAAG,eAAe;;QAGnC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;;AAGzC;;;;AAIG;AAEH,IAAA,MAAM,UAAU,CAAC,IAAiB,EAAE,OAAe,EAAA;AAC/C,QAAA,MAAM,OAAO,GAAkB;AAC3B,YAAA,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;YACzB,IAAI;YACJ,OAAO;SACV;QACD,IAAI,CAAC,QAAQ,GAAG,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC;;AAG/C;;;;AAIG;IAEH,MAAM,mBAAmB,CAAC,OAAe,EAAA;AACrC,QAAA,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC;AAAE,YAAA,OAAO,KAAK;AAE5C,QAAA,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;AAC3D,QAAA,IAAI,WAAW,CAAC,IAAI,KAAK,WAAW;AAAE,YAAA,OAAO,KAAK;AAElD,QAAA,WAAW,CAAC,OAAO,IAAI,OAAO;QAC9B,IAAI,CAAC,QAAQ,GAAG,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;AAClC,QAAA,OAAO,IAAI;;AAGf;;AAEG;AAEH,IAAA,MAAM,SAAS,GAAA;AACX,QAAA,IAAI,CAAC,QAAQ,GAAG,EAAE;AAClB,QAAA,IAAI,CAAC,YAAY,GAAG,EAAE;AACtB,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI;AACzB,QAAA,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE;QACvB,UAAU,CAAC,MAAM,IAAI,CAAC,UAAU,EAAE,EAAE,GAAG,CAAC;;AAG5C;;;AAGG;IAEH,MAAM,cAAc,CAAC,OAAgB,EAAA;AACjC,QAAA,IAAI,CAAC,aAAa,GAAG,OAAO;;AAGhC;;AAEG;AAEH,IAAA,MAAM,UAAU,GAAA;AACZ,QAAA,IAAI,IAAI,CAAC,cAAc,EAAE;YACrB,UAAU,CAAC,MAAK;AACZ,gBAAA,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE;aAC9B,EAAE,CAAC,CAAC;;;IAuBL,YAAY,GAAA;;QAChB,IAAI,CAAC,IAAI,CAAC,WAAW;AAAE,YAAA,OAAO,IAAI;AAElC,QAAA,MAAM,aAAa,GACf,CAAA,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,MAAA,IAAI,CAAC,YAAY,MAAA,IAAA,IAAA,EAAA,KAAA,MAAA,GAAA,MAAA,GAAA,EAAA,CAAE,IAAI,MAAE,IAAA,IAAA,EAAA,KAAA,MAAA,GAAA,MAAA,GAAA,EAAA,CAAA,MAAM,0CAAE,UAAU,KAAI,YAAY;AAE/D,QAAA,QACI,CAAA,CAAA,WAAA,EAAA,EACI,IAAI,EAAC,IAAI,EACT,YAAY,EAAE,IAAI,CAAC,YAAY,EAC/B,QAAQ,EAAE,IAAI,CAAC,QAAQ,EACvB,MAAM,EAAE,IAAI,EAAA,WAAA,EACF,yBAAyB,EAAA,EAElC,IAAI,CAAC,sBAAsB,KACxB,CAAA,CAAA,WAAA,EAAA,EACI,IAAI,EAAC,SAAS,EACd,IAAI,EAAC,IAAI,EACT,IAAI,EAAC,eAAe,EACpB,OAAO,EAAE,IAAI,CAAC,eAAe,EAC7B,QAAQ,EAAE,IAAI,CAAC,OAAO,EAAA,WAAA,EACZ,mBAAmB,EAAA,EAE5B,aAAa,CACN,CACf,CACO;;IAIZ,YAAY,GAAA;AAChB,QAAA,QACI,CAAA,CAAA,KAAA,EAAA,EAAK,KAAK,EAAC,KAAK,EAAA,EACZ,CAAA,CAAA,iBAAA,EAAA,EACI,GAAG,EAAE,CAAC,EAAE,MAAM,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC,EACvC,WAAW,EAAE,IAAI,CAAC,WAAW,EAC7B,WAAW,EAAE,IAAI,CAAC,OAAO,EACzB,UAAU,EAAE,IAAI,CAAC,kBAAkB,EACnC,UAAU,EAAE,IAAI,CAAC,UAAU,EACjB,WAAA,EAAA,wBAAwB,EAClC,UAAU,EAAE,CAAC,KAAK,KAAK,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,CAAC,EACtD,QAAQ,EAAE,MAAM,IAAI,CAAC,UAAU,EAAE,EACnC,CAAA,CACA;;IAId,MAAM,GAAA;AACF,QAAA,QACI,EAAC,IAAI,EAAA,EAAA,GAAA,EAAA,0CAAA,EACD,KAAK,EAAC,6CAA6C,eACzC,kBAAkB,EAAA,EAE3B,IAAI,CAAC,YAAY,EAAE,EACpB,CAAM,CAAA,MAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAA,IAAI,EAAC,yBAAyB,EAAG,CAAA,EACvC,CAAA,CAAA,KAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EACI,KAAK,EAAC,gBAAgB,EAAA,WAAA,EACZ,gBAAgB,EAAA,EAE1B,CAAA,CAAA,kBAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EACI,QAAQ,EAAE,IAAI,CAAC,QAAQ,EACvB,OAAO,EAAE,IAAI,CAAC,OAAO,EACrB,WAAW,EAAE,IAAI,EACjB,WAAW,EAAE,IAAI,CAAC,WAAW,EAC7B,WAAW,EAAE,IAAI,CAAC,WAAW,EAC7B,WAAW,EAAE,IAAI,CAAC,WAAW,EACnB,WAAA,EAAA,kBAAkB,GAC9B,CACA,EACN,CAAK,CAAA,KAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAA,KAAK,EAAC,qBAAqB,EAAA,EAC3B,IAAI,CAAC,YAAY,EAAE,EACpB,CAAA,CAAA,MAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAM,IAAI,EAAC,yBAAyB,GAAG,CACrC,CACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":["AtPromptContainer","__stencil_proxyCustomElement","HTMLElement"],"sources":["src/components/prompt-components/at-prompt-container/at-prompt-container.tsx"],"sourcesContent":["import {\n    Component,\n    Host,\n    h,\n    Prop,\n    Event,\n    EventEmitter,\n    State,\n    Listen,\n    Method,\n    Element,\n} from '@stencil/core';\nimport type { PromptMessage, MessageRole } from '../../../types/prompt';\nimport { fetchTranslations } from '../../../utils/translation';\n\n/**\n * @category Prompt\n * @description A complete conversational interface container that combines a message thread, input field, and header. Provides a full-featured chat experience with message management, threading, and customizable UI elements.\n * @slot prompt-container-header - Custom content displayed above the message thread\n * @slot prompt-container-footer - Custom content displayed below the message input\n */\n@Component({\n    tag: 'at-prompt-container',\n    shadow: false,\n})\nexport class AtPromptContainer {\n    @Element() el: HTMLElement;\n\n    /**\n     * Array of messages to display in the conversation thread\n     */\n    @Prop({ mutable: true }) messages: PromptMessage[] = [];\n\n    /**\n     * Title displayed in the header section\n     */\n    @Prop() header_title: string = 'AI Assistant';\n\n    /**\n     * Subtitle displayed below the title in the header\n     */\n    @Prop() subtitle: string;\n\n    /**\n     * Placeholder text for the input field\n     */\n    @Prop() placeholder: string = 'Type your message here...';\n\n    /**\n     * Error text displayed when invalid is set via max length\n     */\n    @Prop()\n    error_text: string;\n\n    /**\n     * Shows loading state and disables input\n     */\n    @Prop() loading: boolean = false;\n\n    /**\n     * Disables all interactions with the container\n     */\n    @Prop() disabled: boolean = false;\n\n    /**\n     * Controls visibility of the header section\n     */\n    @Prop() show_header: boolean = true;\n\n    /**\n     * Controls visibility of the \"New Thread\" button in the header\n     */\n    @Prop() show_new_thread_button: boolean = true;\n\n    /**\n     * Maximum character length for input messages\n     */\n    @Prop() max_message_length: number = 2000;\n\n    /**\n     * Display voting actions for assistant messages\n     */\n    @Prop() enable_vote: boolean = true;\n\n    /**\n     * Display copy action for assistant messages\n     */\n    @Prop() enable_copy: boolean = true;\n\n    /**\n     * Display edit action for user messages\n     */\n    @Prop() enable_edit: boolean = false;\n\n    @State() currentInput: string = '';\n    @State() inputInvalid: boolean = false;\n    @State() inputError: string = '';\n    @State() isSendEnabled: boolean = true;\n    @State() translations: any = {};\n\n    /**\n     * Emits when a message should be sent\n     */\n    @Event()\n    atSubmit: EventEmitter<string>;\n\n    /**\n     * Emits when the stop button is clicked\n     */\n    @Event()\n    atStop: EventEmitter<void>;\n\n    /**\n     * Emitted when the \"New Thread\" button is clicked\n     */\n    @Event() atNewThread: EventEmitter<void>;\n\n    /**\n     * Emitted when a message copy action is requested\n     */\n    @Event() atMessageCopy: EventEmitter<{\n        messageId: string;\n        content: string;\n    }>;\n\n    /**\n     * Emitted when a message retry action is requested\n     */\n    @Event() atMessageRetry: EventEmitter<{ messageId: string }>;\n\n    /**\n     * Emitted when a message edit action is requested\n     */\n    @Event() atMessageEdit: EventEmitter<{\n        messageId: string;\n        content: string;\n    }>;\n\n    /**\n     * Emitted when a message vote action is requested\n     */\n    @Event() atMessageVote: EventEmitter<{\n        messageId: string;\n        score: number;\n    }>;\n\n    private inputComponent: HTMLAtPromptInputElement;\n\n    async componentWillLoad() {\n        this.translations = await fetchTranslations(this.el);\n    }\n\n    @Listen('atSubmit')\n    handleInputSubmit(event: CustomEvent<string>) {\n        const content = event.detail.trim();\n        if (content && this.isSendEnabled && !this.disabled && !this.loading) {\n            this.handleSubmit(content);\n        }\n    }\n\n    @Listen('atMessageCopy')\n    handleMessageCopy(\n        event: CustomEvent<{ messageId: string; content: string }>,\n    ) {\n        this.atMessageCopy.emit(event.detail);\n    }\n\n    @Listen('atMessageRetry')\n    handleMessageRetry(event: CustomEvent<{ messageId: string }>) {\n        this.atMessageRetry.emit(event.detail);\n    }\n\n    @Listen('atMessageEdit')\n    async handleMessageEdit(\n        event: CustomEvent<{ messageId: string; content: string }>,\n    ) {\n        this.atMessageEdit.emit(event.detail);\n        if (this.inputComponent) {\n            this.inputComponent.value = event.detail.content;\n            await this.focusInput();\n        }\n    }\n\n    @Listen('atMessageVote')\n    handleMessageVote(\n        event: CustomEvent<{ messageId: string; score: number }>,\n    ) {\n        event.stopPropagation();\n        const messageIndex = this.messages.findIndex(\n            (msg) => msg.id === event.detail.messageId,\n        );\n        if (messageIndex !== -1) {\n            const updatedMessages = [...this.messages];\n            updatedMessages[messageIndex] = {\n                ...updatedMessages[messageIndex],\n                score: event.detail.score,\n            };\n            this.messages = updatedMessages;\n        }\n\n        this.atMessageVote.emit(event.detail);\n    }\n\n    /**\n     * Programmatically add a message to the conversation thread\n     * @param role - The message role\n     * @param content - The message content\n     */\n    @Method()\n    async addMessage(role: MessageRole, content: string): Promise<void> {\n        const message: PromptMessage = {\n            id: Date.now().toString(),\n            role,\n            content,\n        };\n        this.messages = [...this.messages, message];\n    }\n\n    /**\n     * Append content to the last message in the thread (useful for streaming responses)\n     * @param content - The content to append\n     * @returns Promise<boolean> - Returns true if successful, false if no messages exist or last message is not from assistant\n     */\n    @Method()\n    async appendToLastMessage(content: string): Promise<boolean> {\n        if (this.messages.length === 0) return false;\n\n        const lastMessage = this.messages[this.messages.length - 1];\n        if (lastMessage.role !== 'assistant') return false;\n\n        lastMessage.content += content;\n        this.messages = [...this.messages];\n        return true;\n    }\n\n    /**\n     * Start a new conversation thread by clearing all messages and resetting state\n     */\n    @Method()\n    async newThread(): Promise<void> {\n        this.messages = [];\n        this.currentInput = '';\n        this.isSendEnabled = true;\n        this.atNewThread.emit();\n        setTimeout(() => this.focusInput(), 100);\n    }\n\n    /**\n     * Control the send button state programmatically\n     * @param enabled - Whether the send functionality should be enabled\n     */\n    @Method()\n    async setSendEnabled(enabled: boolean): Promise<void> {\n        this.isSendEnabled = enabled;\n    }\n\n    /**\n     * Programmatically focus the input field\n     */\n    @Method()\n    async focusInput(): Promise<void> {\n        if (this.inputComponent) {\n            setTimeout(() => {\n                this.inputComponent.focus();\n            }, 0);\n        }\n    }\n\n    private handleSubmit = async (content: string) => {\n        if (!content || this.disabled || this.loading || !this.isSendEnabled) {\n            return;\n        }\n\n        this.isSendEnabled = false;\n\n        await this.addMessage('user', content);\n        this.atSubmit.emit(content);\n    };\n\n    private handleStop = () => {\n        this.atStop.emit();\n    };\n\n    private handleNewThread = async () => {\n        await this.newThread();\n    };\n\n    private renderHeader() {\n        if (!this.show_header) return null;\n\n        const newThreadText =\n            this.translations?.ATUI?.PROMPT?.NEW_THREAD || 'New Thread';\n\n        return (\n            <at-header\n                size=\"h3\"\n                header_title={this.header_title}\n                subtitle={this.subtitle}\n                border={true}\n                data-name=\"prompt-container-header\"\n            >\n                {this.show_new_thread_button && (\n                    <at-button\n                        slot=\"actions\"\n                        size=\"sm\"\n                        type=\"secondaryText\"\n                        onClick={this.handleNewThread}\n                        disabled={this.loading}\n                        data-name=\"new-thread-button\"\n                    >\n                        {newThreadText}\n                    </at-button>\n                )}\n            </at-header>\n        );\n    }\n\n    private renderFooter() {\n        return (\n            <div class=\"p-4\">\n                <at-prompt-input\n                    ref={(el) => (this.inputComponent = el)}\n                    placeholder={this.placeholder}\n                    in_progress={this.loading}\n                    max_length={this.max_message_length}\n                    error_text={this.error_text}\n                    data-name=\"prompt-container-input\"\n                    onAtSubmit={(event) => this.handleSubmit(event.detail)}\n                    onAtStop={() => this.handleStop()}\n                />\n            </div>\n        );\n    }\n\n    render() {\n        return (\n            <Host\n                class=\"flex h-full w-full flex-col overflow-hidden\"\n                data-name=\"prompt-container\"\n            >\n                {this.renderHeader()}\n                <slot name=\"prompt-container-header\" />\n                <div\n                    class=\"min-h-0 flex-1\"\n                    data-name=\"thread-wrapper\"\n                >\n                    <at-prompt-thread\n                        messages={this.messages}\n                        loading={this.loading}\n                        auto_scroll={true}\n                        enable_vote={this.enable_vote}\n                        enable_copy={this.enable_copy}\n                        enable_edit={this.enable_edit}\n                        data-name=\"container-thread\"\n                    />\n                </div>\n                <div class=\"flex flex-col gap-4\">\n                    {this.renderFooter()}\n                    <slot name=\"prompt-container-footer\" />\n                </div>\n            </Host>\n        );\n    }\n}\n"],"version":3}