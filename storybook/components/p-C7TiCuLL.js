import{p as t,H as s,d as e,h as a,F as i,c as o,t as n}from"./p-CtWJ4BTZ.js";import{c as r}from"./p-COG8_R0C.js";import{f as l}from"./p-DuLooPsr.js";import{d as h}from"./p-DqJr9-9r.js";import{d as p}from"./p-CNTmSmCI.js";import{d}from"./p-C8GUnuah.js";var c;!function(t){t[t.NONE=0]="NONE",t[t.UP=1]="UP",t[t.DOWN=-1]="DOWN"}(c||(c={}));const m=r("rounded-lg py-4 text-base",{variants:{role:{user:"bg-surface-2 text-dark ml-auto inline-block p-8",assistant:"text-dark mr-auto",system:"text-dark mr-auto"},loading:{true:"animate-pulse",false:""}},defaultVariants:{role:"user",loading:!1}}),g=t(class extends s{constructor(t){super(),!1!==t&&this.__registerHost(),this.atCopy=e(this,"atCopy",7),this.atVote=e(this,"atVote",7),this.atRetry=e(this,"atRetry",7),this.atEdit=e(this,"atEdit",7)}role="user";content="";name;loading=!1;error=!1;error_message;score=c.NONE;enable_vote=!1;enable_copy=!1;enable_edit=!1;message_id;response_animation="words";atCopy;atVote;atRetry;atEdit;translations;copyFeedbackVisible=!1;animatedContent="";isAnimating=!1;errorEl;get el(){return this}async componentWillLoad(){this.translations=await l(this.el),this.initializeContent()}watchContentChange(t){t&&"words"===this.response_animation&&"assistant"===this.role?this.startWordAnimation(t):this.animatedContent=t}initializeContent(){this.content&&"words"===this.response_animation&&"assistant"===this.role?this.startWordAnimation(this.content):this.animatedContent=this.content}startWordAnimation(t){if(this.isAnimating)return;this.isAnimating=!0,this.animatedContent="";const s=t.split(" ");let e=0;const a=()=>{if(e<s.length){0===e?this.animatedContent=s[e]:this.animatedContent+=" "+s[e],e++;const t=30*Math.random()+30;setTimeout(a,t)}else this.isAnimating=!1};setTimeout(a,30)}handleCopy=async()=>{try{await navigator.clipboard.writeText(this.content),this.copyFeedbackVisible=!0,this.atCopy.emit(this.content),setTimeout((()=>{this.copyFeedbackVisible=!1}),2e3)}catch(t){console.error("Failed to copy text:",t)}};handleRetry=()=>{this.atRetry.emit()};handleEdit=()=>{this.atEdit.emit(this.content)};handleVote=t=>{this.atVote.emit({messageId:this.message_id,score:this.score===t?c.NONE:t})};renderActions(){return this.loading?null:a("div",{class:"mt-2 flex items-center justify-end gap-2","data-name":"message-actions"},"user"===this.role&&this.enable_edit&&a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",icon:"edit",class:"text-xs",onClick:this.handleEdit,"data-name":"edit-button"}),a("span",null,this.translations?.ATUI?.PROMPT?.EDIT||"Edit")),"assistant"===this.role&&this.enable_vote&&a(i,null,a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",onClick:()=>this.handleVote(c.UP),"data-name":"vote-up-button"},this.score===c.UP?a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"0 -960 960 960",width:"15px",fill:"#000000"},a("path",{d:"M720-144H264v-480l288-288 32 22q18 13 26.5 33t3.5 41l-38 192h264q30 0 51 21t21 51v57q0 8-1.5 14.5T906-467L787-188q-9 20-27 32t-40 12Z"})):a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"http://www.w3.org/2000/svg",width:"15px",fill:"#adb5bd"},a("path",{d:"M720-144H264v-480l288-288 32 22q17 12 26 30.5t5 38.5l-1 5-38 192h264q30 0 51 21t21 51v57q0 8-1.5 14.5T906-467L786.93-187.8Q778-168 760-156t-40 12Zm-384-72h384l120-279v-57H488l49-243-201 201v378Zm0-378v378-378Z"}))),a("span",null,this.translations?.ATUI?.PROMPT?.HELPFUL||"Helpful")),a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",onClick:()=>this.handleVote(c.DOWN),"data-name":"vote-down-button"},this.score===c.DOWN?a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"15px",viewBox:"http://www.w3.org/2000/svg",width:"15px",fill:"#000000"},a("path",{d:"M240-816h456v480L408-48l-32-22q-18-13-26.5-33t-3.5-41l38-192H120q-30 0-51-21t-21-51v-57q0-8 1.5-14.5T54-493l119-279q8-20 26.5-32t40.5-12Z"})):a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15px",viewBox:"http://www.w3.org/2000/svg",height:"15px",fill:"#adb5bd"},a("path",{d:"M240-816h456v480L408-48l-32-22q-17-12-26-30.5t-5-38.5l1-5 38-192H120q-30 0-51-21t-21-51v-57q0-8 1.5-14.5T54-493l119-279q8-20 26.5-32t40.5-12Zm384 72H240L120-465v57h352l-49 243 201-201v-378Zm0 378v-378 378Z"}))),a("span",null,this.translations?.ATUI?.PROMPT?.NOT_HELPFUL||"Not Helpful"))),"assistant"===this.role&&this.enable_copy&&a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",icon:this.copyFeedbackVisible?"check":"content_copy",type:"secondaryText",onClick:this.handleCopy,"data-name":"copy-button"}),a("span",null,this.copyFeedbackVisible?this.translations?.ATUI?.PROMPT?.COPIED||"Copied":this.translations?.ATUI?.PROMPT?.COPY||"Copy")),"assistant"===this.role&&this.error&&a("at-tooltip",{position:"top"},a("at-button",{slot:"tooltip-trigger",size:"sm",type:"secondaryText",icon:"refresh",onClick:this.handleRetry,"data-name":"retry-button"}),a("span",null,this.translations?.ATUI?.PROMPT?.RETRY||"Retry")))}renderContent(){if(this.loading)return a("div",{class:"py-8","data-name":"loading-wrapper"},a("at-loading",{class:"flex items-center gap-4 py-8","data-name":"loading-content",variant:"typing",size:"sm"}));if(this.error)return a("div",{class:"space-y-2",ref:t=>this.errorEl=t,"data-name":"error-content"},a("p",{class:"text-destructive-foreground"},this.error_message||this.translations?.ATUI?.PROMPT?.ERROR_GENERATING_RESPONSE||"Error generating response"));const t="words"===this.response_animation&&"assistant"===this.role?this.animatedContent:this.content;return a("div",{class:"prose prose-sm preserve-newlines max-w-none "+("fade"===this.response_animation||"words"===this.response_animation?"at-prompt-fade-in":""),"data-name":"message-content"},a("slot",null),t)}render(){const t=m({role:this.role,loading:this.loading});return a(o,{key:"e8d2987e49c6a8e49593e34d4b8db12aa2757a14",class:"flex w-full gap-8","data-name":"message-container","data-role":this.role},a("div",{key:"d92a1c0465cce62d4560cc9ee13a8c1186aa7407",class:"flex flex-1 flex-col"},this.name&&a("span",{key:"ec1605220b7abc644bcad717d388cd9521ee0d49",class:"text-light self-start text-sm","data-name":"message-name"},this.name),a("div",{key:"7e17c2ffec642d11605c76794be35654f2379906",class:t},this.renderContent()),this.renderActions()))}static get watchers(){return{content:[{watchContentChange:0}]}}static get style(){return"@keyframes atPromptFadeIn{from{opacity:0}to{opacity:1}}@keyframes atPromptTypingCursorBlink{0%,50%{opacity:1}51%,100%{opacity:0}}.at-prompt-fade-in{animation:atPromptFadeIn 0.6s ease-out}"}},[772,"at-prompt-message",{role:[1],content:[1],name:[1],loading:[4],error:[4],error_message:[1],score:[2],enable_vote:[4],enable_copy:[4],enable_edit:[4],message_id:[1],response_animation:[1],translations:[32],copyFeedbackVisible:[32],animatedContent:[32],isAnimating:[32]},void 0,{content:[{watchContentChange:0}]}]);function u(){"undefined"!=typeof customElements&&["at-prompt-message","at-button","at-loading","at-tooltip"].forEach((t=>{switch(t){case"at-prompt-message":customElements.get(n(t))||customElements.define(n(t),g);break;case"at-button":customElements.get(n(t))||h();break;case"at-loading":customElements.get(n(t))||p();break;case"at-tooltip":customElements.get(n(t))||d()}}))}export{g as A,c as P,u as d}