import{p as e,H as s,d as t,h as a,c as o,t as n}from"./p-CGooRokE.js";import{d as i}from"./p-DLlWJE6U.js";import{d as r}from"./p-COVJfV1p.js";import{d as l,P as d}from"./p-wbpKBT-8.js";import{d as m}from"./p-D3zsC1jI.js";const c=e(class extends s{constructor(e){super(),!1!==e&&this.__registerHost(),this.atMessageCopy=t(this,"atMessageCopy",7),this.atMessageRetry=t(this,"atMessageRetry",7),this.atMessageEdit=t(this,"atMessageEdit",7),this.atMessageVote=t(this,"atMessageVote",7)}messages=[];loading=!1;auto_scroll=!0;chatbot_title="Assistant";enable_vote=!0;enable_copy=!0;enable_edit=!1;response_animation="words";atMessageCopy;atMessageRetry;atMessageEdit;atMessageVote;scrollContainer;componentDidUpdate(){this.auto_scroll&&this.scrollContainer&&this.scrollToBottom()}async scrollToBottom(){return new Promise((e=>{requestAnimationFrame((()=>{this.scrollContainer&&this.scrollContainer.scrollTo({top:this.scrollContainer.scrollHeight,behavior:"smooth"}),e()}))}))}async scrollLastMessageToTop(){return new Promise((e=>{requestAnimationFrame((()=>{if(!this.scrollContainer)return void e();const s=this.scrollContainer.querySelectorAll('[data-role="user"]');s.length?(s[s.length-1].scrollIntoView({behavior:"smooth",block:"start"}),e()):e()}))}))}handleVote(e){const s=this.messages.findIndex((s=>s.id===e.detail.messageId));if(-1!==s){const t=[...this.messages];t[s]={...t[s],score:e.detail.score},this.messages=t,this.atMessageVote.emit(e.detail)}}handleMessageCopy(e){const s=this.getMessageIndexFromEvent(e);-1!==s&&this.atMessageCopy.emit({messageId:this.messages[s].id,content:e.detail})}handleMessageRetry(e){const s=this.getMessageIndexFromEvent(e);-1!==s&&this.atMessageRetry.emit({messageId:this.messages[s].id})}handleMessageEdit(e){const s=this.getMessageIndexFromEvent(e);-1!==s&&this.atMessageEdit.emit({messageId:this.messages[s].id,content:e.detail})}getMessageIndexFromEvent(e){const s=e.target.closest("[data-message-index]");return s?parseInt(s.dataset.messageIndex||"-1",10):-1}renderLoadingIndicator(){return this.loading?a("div",{class:"flex flex-col gap-16","data-name":"loading-container"},a("at-prompt-message",{role:"assistant",content:"Typing...",name:this.chatbot_title,loading:!0,"data-name":"loading-message"})):null}renderMessage(e,s){return a("at-prompt-message",{role:e.role,content:e.content,name:"user"===e.role?e.name:e.name||this.chatbot_title,loading:e.loading,error:e.error,error_message:e.error_message,score:e.score||d.NONE,message_id:e.id,enable_vote:this.enable_vote,enable_copy:this.enable_copy,enable_edit:this.enable_edit,response_animation:"assistant"===e.role?this.response_animation:"fade","data-name":`message-${s}`,"data-message-index":s})}renderMessages(){return this.messages.map(((e,s)=>this.renderMessage(e,s)))}render(){return a(o,{key:"6fd2e1a6342a53e35101ab2afd581c249f18f0cf",class:"block h-full","data-name":"thread-container"},a("div",{key:"872fe409888306e9c0a9e56aead55d9f84c993d6",class:"flex h-full flex-col gap-16 overflow-y-auto scroll-smooth",ref:e=>this.scrollContainer=e,"data-name":"scroll-container"},this.messages&&this.messages.length>0?a("div",{"data-name":"thread-messages-container",class:"flex flex-col gap-16"},this.renderMessages(),this.renderLoadingIndicator()):a("slot",{name:"thread-empty-state"}),a("slot",{key:"249b18c06b7ebdf1512ee021d76f08f26d5781c5",name:"thread-messages"})))}},[772,"at-prompt-thread",{messages:[1040],loading:[4],auto_scroll:[4],chatbot_title:[1],enable_vote:[4],enable_copy:[4],enable_edit:[4],response_animation:[1],scrollToBottom:[64],scrollLastMessageToTop:[64]},[[0,"atVote","handleVote"],[0,"atCopy","handleMessageCopy"],[0,"atRetry","handleMessageRetry"],[0,"atEdit","handleMessageEdit"]]]);function h(){"undefined"!=typeof customElements&&["at-prompt-thread","at-button","at-loading","at-prompt-message","at-tooltip"].forEach((e=>{switch(e){case"at-prompt-thread":customElements.get(n(e))||customElements.define(n(e),c);break;case"at-button":customElements.get(n(e))||i();break;case"at-loading":customElements.get(n(e))||r();break;case"at-prompt-message":customElements.get(n(e))||l();break;case"at-tooltip":customElements.get(n(e))||m()}}))}export{c as A,h as d}