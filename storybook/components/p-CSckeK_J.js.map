{"file":"p-CSckeK_J.js","mappings":"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","names":["__stencil_proxyCustomElement","HTMLElement"],"sources":["src/components/prompt-components/at-prompt-thread/at-prompt-thread.tsx"],"sourcesContent":["import {\n    Component,\n    Host,\n    h,\n    Prop,\n    Event,\n    EventEmitter,\n    Listen,\n    Method,\n} from '@stencil/core';\nimport {\n    PromptResponseAnimation,\n    PromptResponseScore,\n    PromptMessage,\n} from '../../../types';\n\n/**\n * @category Prompt\n * @description A message thread component for displaying user and chatbot messages in a conversation format. Supports auto-scrolling, empty states, loading indicators, and message interaction events.\n * @slot thread-empty-state - Content is placed within the empty state wrapper. Used for placing custom empty state content.\n * @slot thread-messages - Content is placed within the messages wrapper. Used for placing custom messages content.\n */\n@Component({\n    tag: 'at-prompt-thread',\n    shadow: false,\n})\nexport class AtPromptThread {\n    /**\n     * Array of messages to display in the conversation thread\n     */\n    @Prop({ mutable: true }) messages: PromptMessage[] = [];\n\n    /**\n     * Shows a loading indicator for incoming messages\n     */\n    @Prop() loading: boolean = false;\n\n    /**\n     * Automatically scroll to the bottom when new messages are added\n     */\n    @Prop() auto_scroll: boolean = true;\n\n    /**\n     * Display name for chatbot/assistant messages\n     */\n    @Prop() chatbot_title: string = 'Assistant';\n\n    /**\n     * Display voting actions for assistant messages\n     */\n    @Prop() enable_vote: boolean = true;\n\n    /**\n     * Display copy action for assistant messages\n     */\n    @Prop() enable_copy: boolean = true;\n\n    /**\n     * Display edit action for user messages\n     */\n    @Prop() enable_edit: boolean = false;\n\n    /**\n     * Enable streaming text animations for system/assistant messages\n     * - 'none': No animation (default)\n     * - 'fade': Fade in the entire message\n     * - 'words': Animate words appearing sequentially like ChatGPT\n     */\n    @Prop() response_animation: PromptResponseAnimation = 'words';\n\n    /**\n     * Emitted when a message copy action is requested\n     */\n    @Event({ bubbles: true }) atMessageCopy: EventEmitter<{\n        messageId: string;\n        content: string;\n    }>;\n\n    /**\n     * Emitted when a message retry action is requested\n     */\n    @Event({ bubbles: true }) atMessageRetry: EventEmitter<{\n        messageId: string;\n    }>;\n\n    /**\n     * Emitted when a message edit action is requested\n     */\n    @Event({ bubbles: true }) atMessageEdit: EventEmitter<{\n        messageId: string;\n        content: string;\n    }>;\n\n    /**\n     * Emitted when a message vote action is requested\n     */\n    @Event({ bubbles: true }) atMessageVote: EventEmitter<{\n        messageId: string;\n        score: number;\n    }>;\n\n    /**\n     * @slot messages - Custom message content (alternative to using the messages prop)\n     */\n\n    private scrollContainer: HTMLElement;\n\n    componentDidUpdate() {\n        if (this.auto_scroll && this.scrollContainer) {\n            this.scrollToBottom();\n        }\n    }\n\n    /**\n     * Scrolls the thread to the bottom with smooth animation\n     */\n    @Method()\n    async scrollToBottom(): Promise<void> {\n        return new Promise<void>((resolve) => {\n            requestAnimationFrame(() => {\n                if (this.scrollContainer) {\n                    this.scrollContainer.scrollTo({\n                        top: this.scrollContainer.scrollHeight,\n                        behavior: 'smooth',\n                    });\n                }\n                resolve();\n            });\n        });\n    }\n\n    /**\n     * Scrolls the last user message to the top of the viewport\n     */\n    @Method()\n    async scrollLastMessageToTop(): Promise<void> {\n        return new Promise<void>((resolve) => {\n            requestAnimationFrame(() => {\n                if (!this.scrollContainer) {\n                    resolve();\n                    return;\n                }\n\n                const userMessages =\n                    this.scrollContainer.querySelectorAll('[data-role=\"user\"]');\n                if (!userMessages.length) {\n                    resolve();\n                    return;\n                }\n\n                const lastUserMessage = userMessages[\n                    userMessages.length - 1\n                ] as HTMLElement;\n                lastUserMessage.scrollIntoView({\n                    behavior: 'smooth',\n                    block: 'start',\n                });\n                resolve();\n            });\n        });\n    }\n\n    @Listen('atVote')\n    handleVote(event: CustomEvent<{ messageId: string; score: number }>) {\n        const messageIndex = this.messages.findIndex(\n            (msg) => msg.id === event.detail.messageId,\n        );\n        if (messageIndex !== -1) {\n            const updatedMessages = [...this.messages];\n            updatedMessages[messageIndex] = {\n                ...updatedMessages[messageIndex],\n                score: event.detail.score,\n            };\n            this.messages = updatedMessages;\n\n            this.atMessageVote.emit(event.detail);\n        }\n    }\n\n    @Listen('atCopy')\n    handleMessageCopy(event: CustomEvent<string>) {\n        const messageIndex = this.getMessageIndexFromEvent(event);\n        if (messageIndex !== -1) {\n            this.atMessageCopy.emit({\n                messageId: this.messages[messageIndex].id,\n                content: event.detail,\n            });\n        }\n    }\n\n    @Listen('atRetry')\n    handleMessageRetry(event: CustomEvent<void>) {\n        const messageIndex = this.getMessageIndexFromEvent(event);\n        if (messageIndex !== -1) {\n            this.atMessageRetry.emit({\n                messageId: this.messages[messageIndex].id,\n            });\n        }\n    }\n\n    @Listen('atEdit')\n    handleMessageEdit(event: CustomEvent<string>) {\n        const messageIndex = this.getMessageIndexFromEvent(event);\n        if (messageIndex !== -1) {\n            this.atMessageEdit.emit({\n                messageId: this.messages[messageIndex].id,\n                content: event.detail,\n            });\n        }\n    }\n\n    private getMessageIndexFromEvent(event: CustomEvent): number {\n        const target = event.target as HTMLElement;\n        const messageContainer = target.closest(\n            '[data-message-index]',\n        ) as HTMLElement;\n        return messageContainer\n            ? parseInt(messageContainer.dataset.messageIndex || '-1', 10)\n            : -1;\n    }\n\n    private renderLoadingIndicator() {\n        if (!this.loading) return null;\n\n        return (\n            <div\n                class=\"flex flex-col gap-16\"\n                data-name=\"loading-container\"\n            >\n                <at-prompt-message\n                    role={'assistant'}\n                    content=\"Typing...\"\n                    name={this.chatbot_title}\n                    loading={true}\n                    data-name=\"loading-message\"\n                />\n            </div>\n        );\n    }\n\n    private renderMessage(message: PromptMessage, index: number) {\n        const role = message.role;\n        const name =\n            message.role === 'user'\n                ? message.name\n                : message.name || this.chatbot_title;\n\n        const animate =\n            message.role === 'assistant' ? this.response_animation : 'fade';\n\n        return (\n            <at-prompt-message\n                role={role}\n                content={message.content}\n                name={name}\n                loading={message.loading}\n                error={message.error}\n                error_message={message.error_message}\n                score={message.score || PromptResponseScore.NONE}\n                message_id={message.id}\n                enable_vote={this.enable_vote}\n                enable_copy={this.enable_copy}\n                enable_edit={this.enable_edit}\n                response_animation={animate}\n                data-name={`message-${index}`}\n                data-message-index={index}\n            />\n        );\n    }\n\n    private renderMessages() {\n        return this.messages.map((message, index) =>\n            this.renderMessage(message, index),\n        );\n    }\n\n    render() {\n        const hasMessages = this.messages && this.messages.length > 0;\n\n        return (\n            <Host\n                class=\"block h-full\"\n                data-name=\"thread-container\"\n            >\n                <div\n                    class=\"flex h-full flex-col gap-16 overflow-y-auto scroll-smooth\"\n                    ref={(el) => (this.scrollContainer = el)}\n                    data-name=\"scroll-container\"\n                >\n                    {!hasMessages ? (\n                        <slot name=\"thread-empty-state\" />\n                    ) : (\n                        <div\n                            data-name=\"thread-messages-container\"\n                            class=\"flex flex-col gap-16\"\n                        >\n                            {this.renderMessages()}\n                            {this.renderLoadingIndicator()}\n                        </div>\n                    )}\n                    <slot name=\"thread-messages\" />\n                </div>\n            </Host>\n        );\n    }\n}\n"],"version":3}