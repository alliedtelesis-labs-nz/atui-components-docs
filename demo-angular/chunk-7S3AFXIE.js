import{a as h}from"./chunk-5H2OG7DN.js";import{a as d,b as a,c as r,d as o,e as n}from"./chunk-QTJ2C22X.js";import{h as i}from"./chunk-B7O3QC5Z.js";var m=class{constructor(e){d(this,e),this.atuiSubmit=n(this,"atuiSubmit",7),this.atuiStop=n(this,"atuiStop",7),this.atuiNewThread=n(this,"atuiNewThread",7),this.atuiMessageCopy=n(this,"atuiMessageCopy",7),this.atuiMessageRetry=n(this,"atuiMessageRetry",7),this.atuiMessageEdit=n(this,"atuiMessageEdit",7),this.atuiMessageVote=n(this,"atuiMessageVote",7),this.messages=[],this.header_title="AI Assistant",this.placeholder="Type your message here...",this.loading=!1,this.disabled=!1,this.show_header=!0,this.show_new_thread_button=!0,this.max_message_length=2e3,this.enable_vote=!0,this.enable_copy=!0,this.enable_edit=!1,this.currentInput="",this.inputInvalid=!1,this.inputError="",this.isSendEnabled=!0,this.translations={},this.handleSubmit=t=>i(this,null,function*(){!t||this.disabled||this.loading||!this.isSendEnabled||(this.isSendEnabled=!1,yield this.addMessage("user",t),this.atuiSubmit.emit(t))}),this.handleStop=()=>{this.atuiStop.emit()},this.handleNewThread=()=>i(this,null,function*(){yield this.newThread()})}componentWillLoad(){return i(this,null,function*(){this.translations=yield h(this.el)})}handleInputSubmit(e){let t=e.detail.trim();t&&this.isSendEnabled&&!this.disabled&&!this.loading&&this.handleSubmit(t)}handleMessageCopy(e){this.atuiMessageCopy.emit(e.detail)}handleMessageRetry(e){this.atuiMessageRetry.emit(e.detail)}handleMessageEdit(e){return i(this,null,function*(){this.atuiMessageEdit.emit(e.detail),this.inputComponent&&(this.inputComponent.value=e.detail.content,yield this.focusInput())})}handleMessageVote(e){e.stopPropagation();let t=this.messages.findIndex(s=>s.id===e.detail.messageId);if(t!==-1){let s=[...this.messages];s[t]=Object.assign(Object.assign({},s[t]),{vote_status:e.detail.score}),this.messages=s}}addMessage(e,t){return i(this,null,function*(){let s={id:Date.now().toString(),role:e,content:t};this.messages=[...this.messages,s]})}appendToLastMessage(e){return i(this,null,function*(){if(this.messages.length===0)return!1;let t=this.messages[this.messages.length-1];return t.role!=="assistant"?!1:(t.content+=e,this.messages=[...this.messages],!0)})}newThread(){return i(this,null,function*(){this.messages=[],this.currentInput="",this.isSendEnabled=!0,this.atuiNewThread.emit(),setTimeout(()=>this.focusInput(),100)})}setSendEnabled(e){return i(this,null,function*(){this.isSendEnabled=e})}focusInput(){return i(this,null,function*(){this.inputComponent&&setTimeout(()=>{this.inputComponent.focus()},0)})}renderHeader(){var e,t,s;if(!this.show_header)return null;let l=((s=(t=(e=this.translations)===null||e===void 0?void 0:e.ATUI)===null||t===void 0?void 0:t.PROMPT)===null||s===void 0?void 0:s.NEW_THREAD)||"New Thread";return a("atui-header",{size:"h3",header_title:this.header_title,subtitle:this.subtitle,border:!0,"data-name":"prompt-container-header"},this.show_new_thread_button&&a("atui-button",{slot:"actions",size:"sm",type:"secondaryText",onClick:this.handleNewThread,disabled:this.loading,"data-name":"new-thread-button"},l))}renderFooter(){return a("div",{class:"p-4"},a("atui-prompt-input",{ref:e=>this.inputComponent=e,placeholder:this.placeholder,in_progress:this.loading,max_length:this.max_message_length,error_text:this.error_text,"data-name":"prompt-container-input",onAtuiSubmit:e=>this.handleSubmit(e.detail),onAtuiStop:()=>this.handleStop()}))}render(){return a(r,{key:"917e270cd63941ff59a50f8e1ff8c88763811ea0",class:"flex h-full w-full flex-col overflow-hidden","data-name":"prompt-container"},this.renderHeader(),a("slot",{key:"981c3c350f1ec08bf17b559ce4ffb691639d8971",name:"prompt-container-header"}),a("div",{key:"12e18d43113545c8a1f5de896d5cfe036ae3256a",class:"min-h-0 flex-1","data-name":"thread-wrapper"},a("atui-prompt-thread",{key:"2f22ce7bda58e229b1d3b177d703d977aa563a57",messages:this.messages,loading:this.loading,auto_scroll:!0,enable_vote:this.enable_vote,enable_copy:this.enable_copy,enable_edit:this.enable_edit,"data-name":"container-thread"})),a("div",{key:"581fcdc1e8f3fbec2383a12d6365439a83b94340",class:"flex flex-col gap-4"},this.renderFooter(),a("slot",{key:"31852c347b013a39f8560b3bc596e03411d80dd9",name:"prompt-container-footer"})))}get el(){return o(this)}};export{m as atui_prompt_container};
