import{a as o}from"./chunk-AHX5VE5O.js";import{a as n}from"./chunk-H66LYRGA.js";import{a as r,b as a,c as l,d as h,e as c}from"./chunk-CP7M2NO3.js";import{i}from"./chunk-7EPSDV5K.js";var u=n("height-[36px] transition[background-color,color,box-shadow] placeholder-text-light group/select:focus-within:ring-2 w-full rounded-md border border-solid p-8 outline-0 duration-300 ease-in-out focus:ring-2",{variants:{focused:{false:"ring-active-foreground/30",true:"pointer-events-none"},disabled:{false:"bg-white focus-within:ring-active-foreground/30",true:"pointer-events-none border-none bg-surface-1 !text-disabled"},readonly:{false:"focus-within:ring-active-foreground/30",true:"cursor-text border-none !bg-surface-1 !text-dark"},invalid:{false:"border-med focus-within:border-active-dark focus-within:ring-active-foreground/30",true:"border-error-base focus-within:border-error-base focus-within:ring-destructive-foreground/30"},typeahead:{false:"cursor-pointer caret-transparent",true:"cursor-text"}},defaultVariants:{disabled:!1,readonly:!1,invalid:!1,typeahead:!1}}),p=n("transition[background-color,color,box-shadow] flex w-full cursor-pointer items-center truncate p-8 text-body font-normal duration-300 ease-in-out focus:outline-0 focus:ring-2 focus:ring-inset focus:ring-active-foreground/40",{variants:{active:{true:"bg-active-light text-active",false:"bg-white hover:bg-disabled-light"}}}),v=class{constructor(e){r(this,e),this.atuiChange=c(this,"atuiChange",7),this.typeahead=!1,this.autoclose=!0,this.searchText="",this.isOpen=!1,this.hasMatchingOptions=!1,this.menuId=`dropdown-${Math.random().toString(36).substring(2,11)}`,this.optionEls=[]}componentWillLoad(){return i(this,null,function*(){this.translations=yield o(this.el)})}componentDidLoad(){this.el.querySelectorAll('li[data-name="select-option"]').forEach(t=>{this.optionEls.push(t)});let e=this.el.getBoundingClientRect();this.parentWidth=`${e.width}px`}updateIsOpenState(e){this.isOpen=e.detail}handleChange(e){return i(this,null,function*(){var t;this.autoclose||(yield(t=this.menuRef)===null||t===void 0?void 0:t.closeMenu()),this.value=e,this.inputEl.value="",this.searchText="",this.atuiChange.emit(this.value),this.inputEl.focus()})}handleClear(){return i(this,null,function*(){var e;yield(e=this.menuRef)===null||e===void 0?void 0:e.closeMenu(),this.searchText="",this.value="",this.inputEl.value="",this.atuiChange.emit(this.value),this.inputEl.focus()})}focusOption(e){let t=this.optionEls.indexOf(this.el.ownerDocument.activeElement);this.optionEls[(t+e+this.optionEls.length)%this.optionEls.length].focus()}handleSearchChange(e){var t;this.searchText=e.target.value.toLowerCase();let s=this.searchText.trim().toLowerCase();this.hasMatchingOptions=s?(t=this.options)===null||t===void 0?void 0:t.some(d=>d.value.toLowerCase().includes(s)):!1}handleKeyDownInput(e){return i(this,null,function*(){switch(e.key){case"Enter":case"Space":yield this.menuRef.toggleMenu();break;case"Escape":yield this.menuRef.closeMenu();break;default:this.handleSearchChange(e),yield this.menuRef.openMenu();break}})}handleKeyDownMenu(e){return i(this,null,function*(){switch(e.key){case"Escape":yield this.menuRef.closeMenu;break;case"Enter":case" ":e.target instanceof HTMLLIElement&&e.target.click();break;case"ArrowUp":case"ArrowLeft":e.preventDefault(),this.focusOption(-1);break;case"ArrowDown":case"ArrowRight":e.preventDefault(),this.focusOption(1);break}})}render(){return a(l,{key:"2fd089fa843e8c6df8474d58f758d6222b2d79dd",class:"group/select",onFocusout:e=>i(this,null,function*(){this.el.contains(e.relatedTarget)||(yield this.menuRef.closeMenu())})},this.renderlabel(),a("atui-menu",{key:"12c4c552386244d09e553441a94d3ce5c854950a",ref:e=>this.menuRef=e,trigger:"click",align:"start",width:this.parentWidth,role:"listbox",disabled:this.disabled||this.readonly,onMenuStateChange:e=>this.updateIsOpenState(e)},this.renderInput(),!this.disabled||!this.readonly?this.renderOptions():null),a("div",{key:"87b923e65f362509de51daae509f8335301e0f02"},this.error_text&&this.invalid&&a("span",{key:"17f0ff916d34d10159a2dbd5dea16ac7112b53a3",class:"text-error","data-name":"select-error"},this.error_text)))}renderlabel(){return a("div",{class:"mb-4 flex flex-col"},a("slot",{name:"label"}),(this.label||this.required||this.info_text)&&a("atui-form-label",{for:this.menuId,label:this.label,required:this.required&&!this.readonly,info_text:this.info_text}),this.hint_text&&a("span",{class:"inline-block text-xs leading-tight text-light","data-name":"select-hint"},this.hint_text))}renderInput(){let e=u({invalid:this.invalid,disabled:this.disabled,readonly:this.readonly,typeahead:this.typeahead});return a("div",{class:"relative flex items-center gap-4",slot:"menu-trigger"},a("input",{class:e,role:"combobox",list:"atui-select",autoComplete:"off","aria-autocomplete":this.typeahead?"list":void 0,"aria-expanded":this.isOpen,"aria-controls":this.menuId,type:"text",readonly:this.readonly,disabled:this.disabled,placeholder:this.placeholder,value:this.value,onKeyDown:t=>i(this,null,function*(){yield this.handleKeyDownInput(t)}),onBlur:()=>this.searchText="","data-name":"select-input",ref:t=>this.inputEl=t}),a("div",{class:"absolute right-4 flex h-full items-center bg-transparent"},this.clearable&&!this.readonly&&!this.disabled&&a("div",{class:`transition-all duration-300 ease-in-out ${this.value||this.searchText?"scale-100 opacity-100":"pointer-events-none scale-90 opacity-0"}`},a("atui-button",{size:"sm",icon:"cancel",type:"secondaryText",onClick:t=>{t.stopPropagation(),this.handleClear()},"data-name":"select-clear"})),!this.readonly&&!this.disabled&&a("atui-button",{size:"sm",class:"!i>text-light h-[18pz] w-[18px]",icon:this.isOpen?"arrow_drop_up":"arrow_drop_down",type:"secondaryText",onClick:()=>i(this,null,function*(){console.log("arrow"),yield this.menuRef.toggleMenu}),"data-name":"select-toggle"})))}renderOptions(){var e;return a("ul",{slot:"menu-content",class:"contents",id:"atui-select",onKeyDown:t=>i(this,null,function*(){yield this.handleKeyDownMenu(t)})},(e=this.options)===null||e===void 0?void 0:e.filter(t=>t.value.toLowerCase().includes(this.searchText)).map(t=>this.renderOption(t)),this.typeahead&&!this.hasMatchingOptions&&a("div",{class:"w-full bg-white px-16 py-8 text-body text-light"},this.translations.ATUI.NO_RESULTS_FOUND))}renderOption(e){let t=p({active:this.value===e.value});return a("li",{role:"option",value:e.value,"data-name":"select-option","aria-selected":this.value===e.value,tabIndex:0,class:t,onClick:()=>this.handleChange(e.value)},a("i",{role:"presentation",class:`material-icons h-16 w-16 text-sm ease-in-out ${this.value===e.value?"visible":"hidden"}`},"check"),e.value)}get el(){return h(this)}};export{v as atui_select};
