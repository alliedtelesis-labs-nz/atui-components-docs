import{a as d}from"./chunk-AHX5VE5O.js";import{c as l,e as h,f as n,h as c,i as r}from"./chunk-JLSND24P.js";import{d as o}from"./chunk-RPJ3H7NX.js";import{a as m,b as t,c as _,d as g,e as f}from"./chunk-CP7M2NO3.js";import{i as u}from"./chunk-7EPSDV5K.js";var p=function(e){return e.SECONDS="s",e.MINUTES="min",e.HOURS="hr",e.DAYS="d",e.WEEKS="w",e.MONTHS="m",e.YEARS="yr",e}(p||{}),b=function(e){return e.SECONDS="SECONDS",e.MINUTES="MINUTES",e.HOURS="HOURS",e.DAYS="DAYS",e.WEEKS="WEEKS",e.MONTHS="MONTHS",e.YEARS="YEARS",e}(b||{}),C=class{constructor(e){m(this,e),this.atuiChange=f(this,"atuiChange",7),this.selected_time_range={selected:{unit:n.HOURS,value:1}},this.range_limit=7,this.enable_relative_time=!0,this.custom_error_message=null,this.show_all_time=!1,this.enable_range_limit=!0,this.units=[n.MINUTES,n.HOURS,n.DAYS,n.WEEKS,n.MONTHS,n.YEARS],this.minSeconds=300}componentWillLoad(){return u(this,null,function*(){this.translations=yield d(this.el),this.today=new Date})}componentWillRender(){this.lowerLimit=this.enable_range_limit?o().subtract(this.range_limit,"day").toDate():r.floorDateByTimeUnit(h,c.HOURS),this.defaultFromDate=o(this.today).subtract(1,"hours").toDate()}getLongUnitDisplay(e){if(!(e.custom||!e.selected))return b[e.selected.unit]}getRelativeDate(e){if(!(e.custom||!e.selected))return r.getRelativeDateRange(e.selected)}getCustomStartAndEndDate(e){if(!e.custom)return;let{from:i,to:a}=e.custom,s=o(i).toDate(),S=o(a).toDate();return{fromDate:s,toDate:S}}getShortUnitDisplay(e){return p[e.unit]}onChangeCustomTime(e){this.selected_time_range={selected:l.CUSTOM,custom:e},this.atuiChange.emit(Object.assign({},this.selected_time_range))}onChangeRelativeTime(e){this.selected_time_range={selected:e},this.atuiChange.emit(Object.assign({},this.selected_time_range))}get buttonGroupOptions(){var e,i;let a=[];return this.selected_time_range.selected===l.ALL?a.push({value:t("div",{class:"flex items-center gap-4 font-normal text-dark"},t("span",{class:"font-medium"},this.translations.ATUI.TIME.ALL_TIME_LABEL))}):this.selected_time_range.custom?a.push({value:[t("div",{class:"flex items-center gap-4 font-normal text-dark"},t("span",null,(e=this.getCustomStartAndEndDate(this.selected_time_range))===null||e===void 0?void 0:e.fromDate.toLocaleString()),t("span",{class:"icon-md material-icons text-light"},"arrow_forward"),t("span",null,this.selected_time_range.custom.lockEndDateToNow?"NOW":(i=this.getCustomStartAndEndDate(this.selected_time_range))===null||i===void 0?void 0:i.toDate.toLocaleString()))]}):a.push({value:t("div",{class:"flex items-center gap-4 font-normal text-dark"},t("span",{class:"font-medium"},this.translations.ATUI.TIME.LAST," ",this.selected_time_range.selected.value," ",this.translations.ATUI.TIME[this.getLongUnitDisplay(this.selected_time_range)]," ",":"),t("span",null,this.getRelativeDate(this.selected_time_range).startDate.toLocaleString()),t("span",{class:"icon-md material-icons text-light"},"arrow_forward"),t("span",null,"NOW"))}),a.push({value:t("div",{class:"flex items-center"},t("span",{class:"icon-md material-icons text-light"},"date_range"))}),a}get predefinedTimeRanges(){let e=[];return this.presets.forEach(i=>{e.push({value:t("span",null,i.value,this.getShortUnitDisplay(i))})}),e.push({value:t("div",{class:"flex items-center"},t("span",{class:"material-icons text-body text-light"},"date_range"))}),e}render(){var e,i,a;return t(_,{key:"d07e8b17309291a2685b7103746266bba72a1958",class:"relative flex justify-center gap-8"},this.enable_relative_time&&t("atui-button-group",{key:"2eba6a88504a0ddd6216f3a6d401d529eff1557b",options:this.buttonGroupOptions,onAtuiIndexChange:s=>s.detail===0&&this.relativeTimeMenuEl.focus()||s.detail===1&&this.absoluteTimeMenuEl.focus()}),!this.enable_relative_time&&t("atui-button-group",{key:"69767eea4bba11607c037f8bb169696261a14e05",options:this.predefinedTimeRanges,onAtuiIndexChange:s=>{s.detail<this.presets.length?this.onChangeRelativeTime(this.presets[s.detail]):s.detail===this.predefinedTimeRanges.length-1&&this.absoluteTimeMenuEl.focus()}}),t("div",{key:"00027710277d9cafbcc10ef468f345dd697335bb",ref:s=>this.relativeTimeMenuEl=s,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:s=>s.stopPropagation()},t("atui-time-with-unit",{key:"01e0f91b6e86a89b7059914668beeb10fdbac4f2",units:this.units,common_options:this.presets,min_date:this.lowerLimit,min_seconds:this.minSeconds,initial_selected_time:this.selected_time_range.selected===l.CUSTOM?l.ALL:this.selected_time_range.selected,custom_error_message:this.custom_error_message,show_all_time:this.show_all_time,onAtuiSubmit:s=>this.onChangeRelativeTime(s.detail),onAtuiCancel:()=>{this.relativeTimeMenuEl.focus(),this.relativeTimeMenuEl.blur()}})),t("div",{key:"8643e058491ac5038835c96f97eb2fbbc73a7e58",ref:s=>this.absoluteTimeMenuEl=s,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:s=>s.stopPropagation()},t("atui-custom-time-range",{key:"9f55b8a5d1c9700518eb7d060dbe720aaf200020",min_date:this.lowerLimit,default_to_date:this.today,default_from_date:this.defaultFromDate,from_date_value:(e=this.getCustomStartAndEndDate(this.selected_time_range))===null||e===void 0?void 0:e.fromDate,to_date_value:(i=this.getCustomStartAndEndDate(this.selected_time_range))===null||i===void 0?void 0:i.toDate,lock_end_date_to_now:(a=this.selected_time_range.custom)===null||a===void 0?void 0:a.lockEndDateToNow,onAtuiSubmit:s=>this.onChangeCustomTime(s.detail),onAtuiCancel:()=>{this.absoluteTimeMenuEl.focus(),this.absoluteTimeMenuEl.blur()}})))}get el(){return g(this)}};export{C as atui_time_range};
