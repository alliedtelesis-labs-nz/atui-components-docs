import"./chunk-2AZWQFM2.js";import{a as d}from"./chunk-5H2OG7DN.js";import{e as l,g as u,h as n,j as h,k as r}from"./chunk-YJK24DUB.js";import{a as o}from"./chunk-OOEOF6TG.js";import{a as m,b as t,c as _,d as g,e as f}from"./chunk-EUD2XOUW.js";import{h as c}from"./chunk-B7O3QC5Z.js";var p=function(e){return e.SECONDS="s",e.MINUTES="min",e.HOURS="hr",e.DAYS="d",e.WEEKS="w",e.MONTHS="m",e.YEARS="yr",e}(p||{}),S=function(e){return e.SECONDS="SECONDS",e.MINUTES="MINUTES",e.HOURS="HOURS",e.DAYS="DAYS",e.WEEKS="WEEKS",e.MONTHS="MONTHS",e.YEARS="YEARS",e}(S||{}),w=class{constructor(e){m(this,e),this.atuiChange=f(this,"atuiChange",7),this.selected_time_range={selected:{unit:n.HOURS,value:1}},this.range_limit=7,this.enable_relative_time=!0,this.custom_error_message=null,this.show_all_time=!1,this.enable_range_limit=!0,this.units=[n.MINUTES,n.HOURS,n.DAYS,n.WEEKS,n.MONTHS,n.YEARS],this.minSeconds=300}componentWillLoad(){return c(this,null,function*(){this.translations=yield d(this.el),this.today=new Date})}componentWillRender(){this.lowerLimit=this.enable_range_limit?o().subtract(this.range_limit,"day").toDate():r.floorDateByTimeUnit(u,h.HOURS),this.defaultFromDate=o(this.today).subtract(1,"hours").toDate()}getLongUnitDisplay(e){if(!(e.custom||!e.selected))return S[e.selected.unit]}getRelativeDate(e){if(!(e.custom||!e.selected))return r.getRelativeDateRange(e.selected)}getCustomStartAndEndDate(e){if(!e.custom)return;let{from:s,to:a}=e.custom,i=o(s).toDate(),b=o(a).toDate();return{fromDate:i,toDate:b}}getShortUnitDisplay(e){return p[e.unit]}onChangeCustomTime(e){this.selected_time_range={selected:l.CUSTOM,custom:e},this.atuiChange.emit(Object.assign({},this.selected_time_range))}onChangeRelativeTime(e){this.selected_time_range={selected:e},this.atuiChange.emit(Object.assign({},this.selected_time_range))}get buttonGroupOptions(){var e,s;let a=[];return this.selected_time_range.selected===l.ALL?a.push({value:t("div",{class:"flex items-center gap-4 font-normal text-dark"},t("span",{class:"font-medium"},this.translations.ATUI.TIME.ALL_TIME_LABEL))}):this.selected_time_range.custom?a.push({value:[t("div",{class:"flex items-center gap-4 font-normal text-dark"},t("span",null,(e=this.getCustomStartAndEndDate(this.selected_time_range))===null||e===void 0?void 0:e.fromDate.toLocaleString()),t("span",{class:"icon-md material-icons text-light"},"arrow_forward"),t("span",null,this.selected_time_range.custom.lockEndDateToNow?"NOW":(s=this.getCustomStartAndEndDate(this.selected_time_range))===null||s===void 0?void 0:s.toDate.toLocaleString()))]}):a.push({value:t("div",{class:"flex items-center gap-4 font-normal text-dark"},t("span",{class:"font-medium"},this.translations.ATUI.TIME.LAST," ",this.selected_time_range.selected.value," ",this.translations.ATUI.TIME[this.getLongUnitDisplay(this.selected_time_range)]," ",":"),t("span",null,this.getRelativeDate(this.selected_time_range).startDate.toLocaleString()),t("span",{class:"icon-md material-icons text-light"},"arrow_forward"),t("span",null,"NOW"))}),a.push({value:t("div",{class:"flex items-center"},t("span",{class:"icon-md material-icons text-light"},"date_range"))}),a}get predefinedTimeRanges(){let e=[];return this.presets.forEach(s=>{e.push({value:t("span",null,s.value,this.getShortUnitDisplay(s))})}),e.push({value:t("div",{class:"flex items-center"},t("span",{class:"material-icons text-body text-light"},"date_range"))}),e}render(){var e,s,a;return t(_,{key:"76db95cfb7ceff52ce16ec1db94eee77c7c26d6e",class:"relative flex justify-center gap-8"},this.enable_relative_time&&t("atui-button-group",{key:"ad2c79667f6cf58e66d24b69d332b374727ec99d",options:this.buttonGroupOptions,onAtuiIndexChange:i=>i.detail===0&&this.relativeTimeMenuEl.focus()||i.detail===1&&this.absoluteTimeMenuEl.focus()}),!this.enable_relative_time&&t("atui-button-group",{key:"a634bf94e71bbd3dd1e6b80708203573e2c36fab",options:this.predefinedTimeRanges,onAtuiIndexChange:i=>{i.detail<this.presets.length?this.onChangeRelativeTime(this.presets[i.detail]):i.detail===this.predefinedTimeRanges.length-1&&this.absoluteTimeMenuEl.focus()}}),t("div",{key:"7aa694ec1203dab14724d4fd42575777a1ce5617",ref:i=>this.relativeTimeMenuEl=i,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:i=>i.stopPropagation()},t("atui-time-with-unit",{key:"f438e5384a6e3080a38c6a8f363303f91bd2cf27",units:this.units,common_options:this.presets,min_date:this.lowerLimit,min_seconds:this.minSeconds,initial_selected_time:this.selected_time_range.selected===l.CUSTOM?l.ALL:this.selected_time_range.selected,custom_error_message:this.custom_error_message,show_all_time:this.show_all_time,onAtuiSubmit:i=>this.onChangeRelativeTime(i.detail),onAtuiCancel:()=>{this.relativeTimeMenuEl.focus(),this.relativeTimeMenuEl.blur()}})),t("div",{key:"d0220996a4cc8e24f19e5adc88c9f91d460e20d5",ref:i=>this.absoluteTimeMenuEl=i,class:"absolute top-[42px] z-10 h-0 overflow-hidden bg-white focus-within:h-fit focus-within:overflow-visible focus:h-fit",tabindex:0,onChange:i=>i.stopPropagation()},t("atui-custom-time-range",{key:"9bcef8a9bfb3b6e0b26a5483ffccfc3e472402b4",min_date:this.lowerLimit,default_to_date:this.today,default_from_date:this.defaultFromDate,from_date_value:(e=this.getCustomStartAndEndDate(this.selected_time_range))===null||e===void 0?void 0:e.fromDate,to_date_value:(s=this.getCustomStartAndEndDate(this.selected_time_range))===null||s===void 0?void 0:s.toDate,lock_end_date_to_now:(a=this.selected_time_range.custom)===null||a===void 0?void 0:a.lockEndDateToNow,onAtuiSubmit:i=>this.onChangeCustomTime(i.detail),onAtuiCancel:()=>{this.absoluteTimeMenuEl.focus(),this.absoluteTimeMenuEl.blur()}})))}get el(){return g(this)}};export{w as atui_time_range};
