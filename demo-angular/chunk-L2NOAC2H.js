import{a as d,b as c}from"./chunk-BHUG342K.js";import{a as h}from"./chunk-5H2OG7DN.js";import{a as o}from"./chunk-Y2EDR7QV.js";import{a as u,b as t,c as p,d as f,e as g}from"./chunk-PUBHN3D6.js";import{h as r}from"./chunk-B7O3QC5Z.js";var b=o("min-h-36 placeholder-text-light transition[background-color,color,box-shadow] relative flex min-h-[36px] w-full flex-shrink flex-grow basis-0 gap-4 rounded-md border border-solid py-4 pl-8 pr-24 outline-none duration-300 ease-in-out focus-within:outline-0 focus-within:ring-2",{variants:{disabled:{false:"bg-white focus-within:ring-active-foreground/30",true:"pointer-events-none border-none bg-surface-1 !text-disabled"},readonly:{false:"focus-within:ring-active-foreground/30",true:"cursor-text border-none !bg-surface-1 !text-dark"},invalid:{false:"border-med focus-within:border-active-dark focus-within:ring-active-foreground/30",true:"border-error-base focus-within:border-error-base focus-within:ring-destructive-foreground/30"},typeahead:{false:"cursor-pointer caret-transparent",true:null}},defaultVariants:{disabled:!1,readonly:!1,invalid:!1,typeahead:!1}}),v=o("transition[background-color,color,box-shadow] flex w-full cursor-pointer items-center truncate p-8 text-body font-normal duration-300 ease-in-out focus:outline-0 focus:ring-2 focus:ring-inset focus:ring-active-foreground/40",{variants:{active:{true:"bg-active-light text-active",false:"bg-white hover:bg-disabled-light"}}}),_=class{constructor(e){u(this,e),this.atuiChange=g(this,"atuiChange",7),this.label="",this.hint_text="",this.error_text="",this.info_text="",this.placeholder="",this.value=[],this.searchText="",this.isOpen=!1,this.hasMatchingOptions=!1,this.parentWidth="",this.menuId=`dropdown-${Math.random().toString(36).substring(2,11)}`}componentWillLoad(){return r(this,null,function*(){this.translations=yield h(this.el)})}componentDidLoad(){let e=this.el.getBoundingClientRect();this.parentWidth=`${e.width}px`}updateIsOpenState(e){this.isOpen=e.detail,this.isOpen&&this.typeahead&&requestAnimationFrame(()=>{this.searchInputEl&&this.searchInputEl.focus()})}handleChange(e){this.value=this.value.includes(e)?this.value.filter(i=>i!==e):[...this.value,e],this.atuiChange.emit(this.value)}handleClear(){this.searchText=""}handleKeyDownMenu(e){return r(this,null,function*(){if(e.key==="Enter"||e.key===" "){e.target instanceof HTMLLIElement&&(e.preventDefault(),e.target.click());return}let i=this.el.querySelector(`ul[id="${this.menuId}"]`);i&&(d(e,i),c(e,i))})}handleSearchInput(e){var i;let s=e.target;this.searchText=s.value.toLowerCase();let n=this.searchText.trim().toLowerCase();this.hasMatchingOptions=n?(i=this.options)===null||i===void 0?void 0:i.some(l=>l.value.toLowerCase().includes(n)):!0}render(){return t(p,{key:"b9d6c8937df024d066b5b00d860ebbc85189c90a",class:"group/select",onFocusout:e=>r(this,null,function*(){let i=e.relatedTarget;(!i||!this.el.contains(i))&&(this.handleClear(),setTimeout(()=>r(this,null,function*(){var s;yield(s=this.menuRef)===null||s===void 0?void 0:s.closeMenu()}),100))})},this.renderLabel(),t("atui-menu",{key:"2e367c9a6469d24a57524773f3c64f25200699cc",ref:e=>this.menuRef=e,trigger:"click",align:"start",width:this.parentWidth,role:"listbox",autoclose:!1,disabled:this.disabled||this.readonly,onAtuiMenuStateChange:e=>this.updateIsOpenState(e)},this.renderInput(),!this.disabled||!this.readonly?this.renderOptions():null),t("div",{key:"31aa97991a974932d240cd9941ed4724a2aecffc"},this.error_text&&this.invalid&&t("span",{key:"1381282422010f0c610315a8d5966a1cb3a40f15","data-name":"multi-select-error",class:"text-error"},this.error_text)))}renderLabel(){return t("div",{class:"mb-4 flex flex-col"},t("slot",{name:"label"}),(this.label||this.required||this.info_text)&&t("atui-form-label",{for:this.menuId,label:this.label,required:this.required&&!this.readonly,info_text:this.info_text}),this.hint_text&&t("span",{class:"text-xs leading-tight text-med","data-name":"multi-select-hint"},this.hint_text))}renderInput(){let e=b({invalid:this.invalid,disabled:this.disabled,readonly:this.readonly,typeahead:this.typeahead});return t("div",{class:e,slot:"menu-trigger",tabindex:0},t("div",null,t("atui-chip-list",{size:"sm",class:"w-full focus-within:ring-0",readonly:this.readonly,disabled:this.disabled,show_clear_all:this.clearable,onAtuiRemoveChip:i=>{this.value=this.value.filter(s=>!i.detail.includes(s)),this.atuiChange.emit(this.value)},chips:this.value,"data-name":"multi-select-chips-inside"},this.value.length===0&&t("div",{class:"pointer-events-none select-none text-body text-disabled"},this.placeholder))),!this.readonly&&!this.disabled&&t("div",{class:"absolute right-4 flex items-center"},t("div",{class:"user-select-none pointer-events-none flex h-full items-center bg-transparent p-4 text-foreground",role:"presentation",tabindex:-1},t("span",{class:"material-icons h-16 w-16 text-[16px] leading-[16px]","data-name":"button-icon-right"},this.isOpen?"arrow_drop_up":"arrow_drop_down"))))}renderOptions(){var e,i,s,n,l;return t("ul",{id:this.menuId,role:"listbox",class:"contents",slot:"menu-content",onKeyDown:a=>r(this,null,function*(){yield this.handleKeyDownMenu(a)})},this.typeahead&&t("div",{class:"relative z-10 bg-white p-4"},t("input",{"data-name":"multi-select-input",type:"text",class:`transition[background-color,color] mb-4 h-[28px] w-full flex-shrink flex-grow basis-0 rounded-md bg-surface-1 p-8 outline-0 ring-active-foreground/30 duration-300 ease-in-out focus:ring-2 ${this.clearable?"pr-24":""} `,placeholder:((i=(e=this.translations)===null||e===void 0?void 0:e.ATUI)===null||i===void 0?void 0:i.SEARCH)||"Search",name:"",value:this.searchText,onInput:a=>{a.stopPropagation(),this.handleSearchInput(a)},onClick:a=>a.stopPropagation(),ref:a=>this.searchInputEl=a}),this.clearable&&this.searchText!==""&&t("div",{class:"absolute right-4 top-4"},t("atui-button",{size:"sm",icon:"cancel",type:"secondaryText",onClick:a=>{a.stopPropagation(),this.searchText="",this.searchInputEl.value=""},"data-name":"multi-select-search-clear"}))),(s=this.options)===null||s===void 0?void 0:s.filter(a=>!this.searchText||a.value.toLowerCase().includes(this.searchText)).map(a=>this.renderOption(a)),this.typeahead&&this.searchText&&!this.hasMatchingOptions&&t("div",{"data-name":"no-results-found",class:"w-full bg-white px-16 py-8 text-body text-light"},((l=(n=this.translations)===null||n===void 0?void 0:n.ATUI)===null||l===void 0?void 0:l.NO_RESULTS_FOUND)||"No results found"))}renderOption(e){let i=v({active:this.value.includes(e.value)});return t("li",{role:"option","data-name":"multi-select-option","aria-selected":this.value.includes(e.value),tabIndex:0,class:i,onClick:()=>this.handleChange(e.value)},e.value)}get el(){return f(this)}};export{_ as atui_multi_select};
