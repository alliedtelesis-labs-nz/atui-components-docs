import{a as c,b as h}from"./chunk-BHUG342K.js";import{a as d}from"./chunk-5H2OG7DN.js";import{a as l}from"./chunk-Y2EDR7QV.js";import{a as u,b as i,c as p,d as f,e as g}from"./chunk-OYGHDCNF.js";import{h as n}from"./chunk-B7O3QC5Z.js";var b=l("height-[36px] transition[background-color,color,box-shadow] placeholder-text-light group/select:focus-within:ring-2 w-full cursor-pointer rounded-md border border-solid p-8 outline-0 duration-300 ease-in-out select-none focus:ring-2",{variants:{focused:{false:"ring-active-foreground/30",true:"pointer-events-none"},disabled:{false:"focus-within:ring-active-foreground/30 cursor-pointer bg-white",true:"bg-surface-1 !text-disabled pointer-events-none border-none"},readonly:{false:"focus-within:ring-active-foreground/30",true:"!bg-surface-1 !text-dark cursor-text border-none"},invalid:{false:"border-med focus-within:border-active-dark focus-within:ring-active-foreground/30",true:"border-error-base focus-within:border-error-base focus-within:ring-destructive-foreground/30"}},defaultVariants:{disabled:!1,readonly:!1,invalid:!1}}),v=l("transition[background-color,color,box-shadow] text-body focus:ring-active-foreground/40 flex w-full cursor-pointer items-center truncate p-8 font-normal duration-300 ease-in-out focus:ring-2 focus:outline-0 focus:ring-inset",{variants:{active:{true:"bg-active-light text-active",false:"hover:bg-disabled-light bg-white"}}}),_=class{constructor(e){u(this,e),this.atuiChange=g(this,"atuiChange",7),this.typeahead=!1,this.autoclose=!0,this.searchText="",this.isOpen=!1,this.hasMatchingOptions=!1,this.menuId=`dropdown-${Math.random().toString(36).substring(2,11)}`,this.optionEls=[]}componentWillLoad(){return n(this,null,function*(){this.translations=yield d(this.el)})}componentDidLoad(){this.el.querySelectorAll('li[data-name="select-option"]').forEach(t=>{this.optionEls.push(t)});let e=this.el.getBoundingClientRect();this.parentWidth=`${e.width}px`}updateIsOpenState(e){this.isOpen=e.detail,this.isOpen&&this.typeahead&&requestAnimationFrame(()=>{this.searchInputEl&&this.searchInputEl.focus()})}handleChange(e){return n(this,null,function*(){var t;this.autoclose&&(yield(t=this.menuRef)===null||t===void 0?void 0:t.closeMenu()),this.value=e,this.inputEl.focus(),this.atuiChange.emit(this.value)})}handleClear(){return n(this,null,function*(){this.searchText=""})}handleKeyDownMenu(e){return n(this,null,function*(){if(e.key==="Enter"||e.key===" "){e.target instanceof HTMLLIElement&&(e.preventDefault(),e.target.click());return}let t=this.el.querySelector('ul[id="atui-select"]');t&&(c(e,t),h(e,t))})}handleSearchInput(e){var t;let s=e.target;this.searchText=s.value.toLowerCase();let r=this.searchText.trim().toLowerCase();this.hasMatchingOptions=r?(t=this.options)===null||t===void 0?void 0:t.some(o=>o.value.toLowerCase().includes(r)):!0}render(){return i(p,{key:"0ee1e70949339d9efee11f0d96a6533ce9b7244c",class:"group/select",onFocusout:e=>n(this,null,function*(){yield this.handleClear();let t=e.relatedTarget;(!t||!this.el.contains(t))&&setTimeout(()=>n(this,null,function*(){var s;yield(s=this.menuRef)===null||s===void 0?void 0:s.closeMenu()}),100)})},this.renderLabel(),i("atui-menu",{key:"71be687e805e467c0ad4b00f9d41671230f1846c",ref:e=>this.menuRef=e,trigger:"click",align:"start",width:this.parentWidth,role:"listbox",disabled:this.disabled||this.readonly,onAtuiMenuStateChange:e=>this.updateIsOpenState(e)},this.renderInput(),!this.disabled||!this.readonly?this.renderOptions():null),i("div",{key:"f4f3063c1caf7f1494b5610516178ce35b1963be"},this.error_text&&this.invalid&&i("span",{key:"2c08596c95c852bab3883a32b50f73dacd997a51",class:"text-error","data-name":"select-error"},this.error_text)))}renderLabel(){return i("div",{class:"mb-4 flex flex-col"},i("slot",{name:"label"}),(this.label||this.required||this.info_text)&&i("atui-form-label",{for:this.menuId,label:this.label,required:this.required&&!this.readonly,info_text:this.info_text}),this.hint_text&&i("span",{class:"text-light inline-block text-xs leading-tight","data-name":"select-hint"},this.hint_text))}renderInput(){let e=b({invalid:this.invalid,disabled:this.disabled,readonly:this.readonly});return i("div",{class:"relative flex items-center gap-4",slot:"menu-trigger"},i("input",{class:e,role:"combobox",list:"atui-select","aria-expanded":this.isOpen,"aria-controls":this.menuId,type:"text",readonly:!0,"aria-disabled":this.disabled,disabled:this.disabled,placeholder:this.placeholder,value:this.value,"data-name":"select-input",ref:t=>this.inputEl=t}),!this.readonly&&!this.disabled&&i("div",{class:"bg-surface1 absolute right-4 flex h-full cursor-pointer items-center rounded-md p-4 select-none",role:"presentation",tabindex:-1},i("span",{class:"material-icons h-16 w-16 text-[16px] leading-[16px]","data-name":"button-icon-right"},this.isOpen?"arrow_drop_up":"arrow_drop_down")))}renderOptions(){var e,t,s,r,o;return i("ul",{class:"contents",id:"atui-select",onKeyDown:a=>n(this,null,function*(){yield this.handleKeyDownMenu(a)})},this.typeahead&&i("div",{class:"relative z-10 bg-white p-4"},i("input",{type:"text",class:`transition[background-color,color] bg-surface-1 ring-active-foreground/30 mb-4 h-[28px] w-full flex-shrink flex-grow basis-0 rounded-md p-8 outline-0 duration-300 ease-in-out focus:ring-2 ${this.clearable?"pr-24":""} `,placeholder:((t=(e=this.translations)===null||e===void 0?void 0:e.ATUI)===null||t===void 0?void 0:t.SEARCH)||"Search",name:"",autoComplete:"off","aria-autocomplete":"list",value:this.searchText,onInput:a=>{a.stopPropagation(),this.handleSearchInput(a)},onClick:a=>a.stopPropagation(),ref:a=>this.searchInputEl=a}),this.clearable&&this.searchText!==""&&i("div",{class:"absolute top-4 right-4"},i("atui-button",{size:"sm",icon:"cancel",type:"secondaryText",onClick:a=>n(this,null,function*(){a.stopPropagation(),yield this.handleClear()}),"data-name":"select-clear"}))),(s=this.options)===null||s===void 0?void 0:s.filter(a=>!this.searchText||a.value.toLowerCase().includes(this.searchText)).map(a=>this.renderOption(a)),this.typeahead&&this.searchText&&!this.hasMatchingOptions&&i("div",{class:"text-body text-light w-full bg-white px-16 py-8"},((o=(r=this.translations)===null||r===void 0?void 0:r.ATUI)===null||o===void 0?void 0:o.NO_RESULTS_FOUND)||"No results found"))}renderOption(e){let t=v({active:this.value===e.value}),s=this.value===e.value;return i("li",{role:"option",value:e.value,"data-name":"select-option","aria-selected":s?"true":"false",tabIndex:0,class:t,onClick:()=>this.handleChange(e.value)},e.value)}get el(){return f(this)}};export{_ as atui_select};
