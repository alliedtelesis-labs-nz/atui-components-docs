import{a as c}from"./chunk-AHX5VE5O.js";import{a as d,b as a,c as n,d as o}from"./chunk-CP7M2NO3.js";import{i as r}from"./chunk-7EPSDV5K.js";var g=class{constructor(e){d(this,e),this.page_size=10,this.use_custom_pagination=!1,this.tableCreated=!1,this.activeFilters={},this.selectedFilters=[],this.menuSelectedIds=[],this.searchValue=""}handleSelectedFiltersChange(e){this.menuSelectedIds=e.map(t=>t.id)}componentWillLoad(){return r(this,null,function*(){this.translations=yield c(this.el)})}componentDidLoad(){return r(this,null,function*(){yield this.initGrid()})}componentDidUpdate(){return r(this,null,function*(){yield this.initGrid()})}initGrid(){return r(this,null,function*(){var e;this.col_defs&&!this.tableCreated&&this.tableEl&&(this.agGrid=yield this.tableEl.createGrid(),this.tableCreated=!0,this.setupExternalFilters(),!((e=this.table_data)===null||e===void 0)&&e.items&&this.agGrid.setGridOption("rowData",this.table_data.items))})}setupExternalFilters(){this.agGrid&&(this.agGrid.setGridOption("isExternalFilterPresent",()=>{let e=Object.keys(this.activeFilters).length>0;return console.log("isExternalFilterPresent called, hasFilters:",e),e}),this.agGrid.setGridOption("doesExternalFilterPass",e=>{if(!e.data)return!0;let t=this.activeFilters.__search__;if(t){let s=t.toLowerCase();if(!Object.values(e.data).some(l=>l&&String(l).toLowerCase().includes(s)))return!1}return Object.entries(this.activeFilters).every(([s,i])=>{if(s==="__search__"||!i)return!0;let l=e.data[s];return l&&String(l).toLowerCase().includes(String(i).toLowerCase())})}))}handleColumnChange(e){let{id:t,checked:h}=e.detail,s=this.col_defs.map(i=>i.field===t?Object.assign(Object.assign({},i),{hide:!h}):i);this.col_defs=s}handleFilterChange(e){e.detail&&(Array.isArray(e.detail)&&typeof e.detail[0]=="string"?this.handleMenuFilterChange(e.detail):Array.isArray(e.detail)&&typeof e.detail[0]=="object"&&this.handleFilterListChange(e.detail)),this.updateActiveFilters()}handleMenuFilterChange(e){this.selectedFilters=e.map(t=>({id:t,value:""})),this.menuSelectedIds=e}handleFilterListChange(e){e.length===1&&e[0].id===""?(this.selectedFilters=[],this.menuSelectedIds=[]):(this.selectedFilters=e,this.menuSelectedIds=e.filter(t=>t.value&&t.value.trim()!=="").map(t=>t.id))}updateActiveFilters(){this.activeFilters={},this.selectedFilters.forEach(e=>{e.value&&(this.activeFilters[e.id]=e.value)}),this.searchValue&&(this.activeFilters.__search__=this.searchValue),this.agGrid?(this.setupExternalFilters(),this.agGrid.onFilterChanged()):console.log("agGrid not available, cannot apply filter")}handleSearchChange(e){this.searchValue=e.detail||"",this.updateActiveFilters()}render(){return a(n,{key:"7a1130a2edb0a79ff95974c63f585a50052935d9"},a("atui-table-actions",{key:"dd23e58d8a8be2b27b519c9f0f9ecbcb538770b6",ag_grid:this.agGrid},a("div",{key:"23528c8c7e40507f9163135c7bef2102a355f127",class:"flex items-center gap-8",slot:"search"},!this.hide_dropdown_filters&&this.col_defs&&a("atui-table-filter-menu",{key:"67cffcf664a867e9a5398bb4c93aab566fbd547a",slot:"filter-menu",col_defs:this.col_defs,selected:this.menuSelectedIds,onAtuiChange:e=>this.handleFilterChange(e)}),a("atui-search",{key:"662cc2131202b96197e0b1be7f7b1ca5f36ccea2",class:"w-input-md",label:this.search_label,hint_text:this.search_hint,info_text:this.search_info_tooltip,placeholder:this.translations.ATUI.TABLE.SEARCH_BY_KEYWORD,onAtuiChange:e=>this.handleSearchChange(e)})),!this.hide_dropdown_filters&&this.col_defs&&a("atui-table-filters",{key:"074baef61b7f52a71a7059a83e8416dcd598c086",slot:"filters",col_defs:this.col_defs,selected:this.selectedFilters,onAtuiChange:e=>this.handleFilterChange(e)}),!this.hide_export_menu&&a("atui-table-export-menu",{key:"1b574ada495d711d850737dcc39bf9009c4f3250",slot:"export-menu"}),!this.hide_column_manager&&this.col_defs&&a("atui-column-manager",{key:"37e60f8493d33acbc0e380956bd5a4cfa0962228",slot:"column-manager",col_defs:this.col_defs,onAtuiChange:e=>this.handleColumnChange(e)}),a("div",{key:"08c996a95d10308a490a97315499ec737434e363",slot:"actions"},a("slot",{key:"d6de402f44aa412b40d30660c0c979f5ef62382e",name:"actions"}))),a("slot",{key:"e9dd2648aa4dbbd53cdeda0b7781ec681af8d134",name:"multi-select-actions"}),a("atui-table",{key:"4687e9fc0d8e0774c573e60df13a750d7a3572d5",ref:e=>this.tableEl=e,table_data:this.table_data,col_defs:this.col_defs,page_size:this.page_size,use_custom_pagination:this.use_custom_pagination,disable_auto_init:!0}))}get el(){return o(this)}static get watchers(){return{selectedFilters:["handleSelectedFiltersChange"]}}};export{g as atui_search_table};
